<!doctype html public "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1250">
<title>Sekvence (SQL)</title>
<link rel='stylesheet' style='text/css' href='../function.css'>
</head>

<body bgcolor="#FFFFFF" text="#000000"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
	<td style="background-image: url(../images/bghead.jpg);
		background-position: right;
		background-repeat: no-repeat;">
	<table width="100%" border="0" cellpadding="0" cellspacing="0"
		style="background-image:none">
	<tr>
		<td style="background-image:none" height="46"
			width="15%"><img src="../images/title-cz.gif"
			width="255" height="33"
			alt="602SQL-Úplná dokumentace"
			title="602SQL - Úplná dokumentace"
			border="0"></td>
		<td width="33%" align="right"><a href="../xml/html/top.html"><img class="floatno"
			src="../images/index.gif"
			width="15" height="16"
			alt="Index" title="Zpìt na obsah"
			border="0" vspace="2"></a> &nbsp;
			 </td>
	</tr>
	</table>
	</td>
</tr>
</table><table class="navigace" border="0" width="100%"  bgcolor="#FFFFBF"><tr> <td
width="20" align="center"><img class="floatno" src="../images/prev.gif"
width="15" height="13" alt="&lt;&shy;" title="Pøedcházející téma"
border="0"></td><td width="25%"><a
href="HE_SQL2_TRIGGERY.htm">Triggery</a></td> <td width="25%"
align="right"><img class="floatno" src="../images/up.gif" width="13"
height="15" alt="Nahoru" title="O jednu úroveò vıš" border="0"
align="middle"></td><td width="25%"><a href="HE_SQL2_JAZYKSQL.htm">Jazyk SQL a jeho implementace</a></td>
<td width="25%" align="right"><a
href="HE_SQL2_KURZORY.htm">Kurzory v SQL</a></td><td width="20"
align="center"><img class="floatno" src="../images/next.gif" width="15"
height="13" alt="&shy;&gt;" title="Následující téma" border="0"></td>
</tr></table>




<h1><a name="he_sql2_sekvence"></a>Sekvence (SQL)</h1>

<p>Sekvence je objektem aplikace slouícím ke generování posloupnosti celoèíselnıch hodnot (v rozsahu 64 bitù), zejména unikátních klíèù.</p>

<p>Sekvence není svázána s ádnou konkrétní tabulkou, take se dá pouít k vytváøení klíèù, které budou unikátní nejen v rámci tabulky, ale i v rámci skupiny tabulek. </p>

<p>Sekvence se dají vytváøet, modifikovat a rušit buï z vıvojového prostøedí 602SQL nebo pomocí SQL pøíkazù <a href="HE_SQL2_CREATESEQUENCE.htm">CREATE SEQUENCE</a>, <a href="HE_SQL2_ALTERSEQUENCE.htm">ALTER SEQUENCE</a> a <a href="HE_SQL2_DROPSEQUENCE.htm">DROP SEQUENCE</a>. Sekvence jsou v rámci aplikace oznaèeny svım jménem. Popis syntaxe sekvence naleznete <a href="HE_SQL2_SEQPOPIS.htm">zde</a>.</p>

<h2>Vlastnosti sekvencí</h2>

<p>V definici sekvence lze stanovit minimální a maximální hodnotu a krok, s nim se hodnoty generují. Je-li krok zápornı, èísla se generují sestupnì. Dále lze stanovit poèáteèní hodnotu sekvence a pøíznak, e se po dosaení limitní hodnoty má generování cyklicky opakovat. Je-li krajní hodnota dosaena a není-li nastaven pøíznak cyklického opakování, pak pøi generování další hodnoty nastane chybovı <a href="../xml/html/handlingcategories.html">sqlstate</a> W0219 (SEQUENCE_EXHAUSTED).</p>

<p>Pokud klient alokuje novou hodnotu ze sekvence a poté odvolá transakci, alokovaná hodnota se do sekvence nevrací a nebude tedy vyuita.</p>

<p>V globální <a href="../xml/html/sysvars.html">systémové promìnné</a> @@IDENTITY lze nalézt poslední hodnotu, kterou klient získat z nìkteré sekvence nebo z generátoru unikátních klíèù v tabulce (implicitní hodnota UNIQUE).</p>

<h2>Získání hodnoty ze sekvence - zpùsob kompatibilní s Oracle</h2>

<p>Na hodnoty generované pomocí sekvence se v SQL pøíkazech odkazuje pomocí <a href="HE_SQL2_VYRAZY.htm">vırazù</a>:</p>

<pre><code>  jméno_sekvence.CURRVAL  
  jméno_sekvence.NEXTVAL</code></pre>

<p>NEXTVAL oznaèuje novou hodnotu v sekvenci, CURRVAL oznaèuje hodnotu naposled vrácenou pomocí NEXTVAL. Volání CURRVAL se nesmí pouít pøed NEXTVAL, jinak v opaèném pøípadì nastane chybovı <a href="../xml/html/handlingcategories.html">sqlstate</a> W0220 (NO_CURRENT_VAL). </p>

<p>Kadı klient si udruje vlastní hodnotu CURRVAL, rùzní klienti mají tedy v jednom okamiku rùzné hodnoty CURRVAL.</p>

<h2>Získání hodnoty ze sekvence - zpùsob kompatibilní se standardem SQL 2003</h2>

<p>Na hodnoty generované pomocí sekvence se v SQL pøíkazech odkazuje pomocí <a href="HE_SQL2_VYRAZY.htm">vırazu</a>:</p>

<pre><code>NEXT VALUE FOR jméno_sekvence</code></pre>

<p>Pokud se tento vıraz vyhodnotí vícekrát v rámci jednoho elementárního pøíkazu (napø. jednoho pøíkazu INSERT), vrátí opakovanì <em>stejnou</em> hodnotu. V pøíkazech iterujících po záznamech (UPDATE, INSERT ... SELECT) vracejí stejnou hodnotu všechna volání tıkající se zpracování jednoho záznamu. </p>

<h2>Získání hodnoty ze sekvence do klientské promìnné</h2>

<p>Z klientského programu lze novou hodnotu generovanou v sekvenci SEQ získat do globální celoèíselné promìnné VAL pøíkazem:

<pre><code>  SET :&gt;val=SEQ.NEXTVAL</code></pre></p>

<h2>Sekvence v Klientském vıvojovém prostøedí</h2>

<p>Sekvenci lze alternativnì vytvoøit èi modifikovat pomocí <a href="../xml/html/des_sequence.html">interaktivního návrháøe</a> pøístupného z <a href="../xml/html/controlpanel.html">Øídicího panelu</a> vıvojového prostøedí 602SQL.</p>
<p>V <a href="../xml/html/output.html">oknì <strong>Output</strong></a> vıvojového prostøedí 602SQL lze pomocí záloky <strong>Zdroj</strong> zobrazit popis zvolené sekvence. V komentáøi pøed touto definicí je pøíští hodnota, která bude ze sekvence získána. Pokud je pro sekvenci definována vyrovnávací pamì, pak to nemusí bıt hodnota, kterou vrátí pøíští volání NEXTVAL, protoe nìkteré dosud nepouité hodnoty mohou bıt ve vyrovnávací pamìti.</p>
<p>Pøi <a href="../xml/html/aplexp.html">exportu aplikace</a> s daty je souèástí definice sekvence pøíští hodnota, pøi exportu bez dat nikoliv (pøíští hodnota bude rovna poèáteèní hodnotì).</p>
<br/><br/>

<p><b>Odlišnosti od normy</b>

<ul>
	<li>Sekvence nejsou souèástí standardu SQL 92 ani SQL 3, objevují se a ve standardu SQL 2003. Pøed zavedením tohoto standardu sekvence existovaly v databázích Oracle a v 602SQL byly pùvodnì implementovány v (témìø) shodné podobì. V souèasné verzi 602SQL jsou plnì podporovány obì varianty sekvencí, protoe kadá má svoje vıhody a nevıhody.</li>
</ul>



<p class="subs">Seznam subsekcí:
<ul class="subs">

<li><a href="HE_SQL2_SEQPOPIS.htm">Popis sekvence</a>

<li><a href="HE_SQL2_CREATESEQUENCE.htm">Pøíkaz CREATE SEQUENCE</a>

<li><a href="HE_SQL2_ALTERSEQUENCE.htm">Pøíkaz ALTER SEQUENCE</a>

<li><a href="HE_SQL2_DROPSEQUENCE.htm">Pøíkaz DROP SEQUENCE</a>

</ul>
<table class="navigace" border="0" width="100%"  bgcolor="#FFFFBF"><tr> <td
width="20" align="center"><img class="floatno" src="../images/prev.gif"
width="15" height="13" alt="&lt;&shy;" title="Pøedcházející téma"
border="0"></td><td width="25%"><a
href="HE_SQL2_TRIGGERY.htm">Triggery</a></td> <td width="25%"
align="right"><img class="floatno" src="../images/up.gif" width="13"
height="15" alt="Nahoru" title="O jednu úroveò vıš" border="0"
align="middle"></td><td width="25%"><a href="HE_SQL2_JAZYKSQL.htm">Jazyk SQL a jeho implementace</a></td>
<td width="25%" align="right"><a
href="HE_SQL2_KURZORY.htm">Kurzory v SQL</a></td><td width="20"
align="center"><img class="floatno" src="../images/next.gif" width="15"
height="13" alt="&shy;&gt;" title="Následující téma" border="0"></td>
</tr></table>
</body>
</html>

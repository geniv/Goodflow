<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1250"><title>3. Manipulace dat v SQL</title>
                             

	
	<link rel="STYLESHEET" type="text/css" href="kap3_soubory/main.css">
	<style type="text/css"><!--:hover { font-weight: bold;         color: red }
--></style></head><body alink="Blue" background="kap3_soubory/pozadi.jpg" vlink="Blue">
<a name="k"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap2.html"><img src="kap3_soubory/prev.gif" alt="2. Definice dat v SQL"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap4.html"><img src="kap3_soubory/next.gif" alt="4. Systémový katalog"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/index.html"><img src="kap3_soubory/toc.gif" alt="Obsah"></a>
<hr color="Blue" size="1">
<h1>3. Manipulace dat v SQL</h1>
<dt><a href="#k1">3.1 Jednoduché dotazy v SQL</a></dt>
<dt><a href="#k2">3.2 Aritmetika a agregaèní funkce</a></dt>
<dt class="ODRAZ"><a href="#k21">3.2.1 Konstrukt GROUP BY</a></dt>
<dt class="ODRAZ"><a href="#k22">3.2.2 Sémantika agregaèních funkcí</a></dt>
<dt><a href="#k3">3.3 Manipulace s množinami v SQL</a></dt>
<dt><a href="#k4">3.4 Kvantifikace v SQL</a></dt>
<dt><a href="#k5">3.5 Používání prázdných hodnot</a></dt>
<dt><a href="#k6">3.6 Práce s kolekcemi v SQL</a></dt>
<dt><a href="#k7">3.7 Práce s øetìzci znaku v SQL</a></dt>
<dt><a href="#k8">3.8 Sémantika pøíkazu SELECT</a></dt>
<dt><a href="#k9">3.9 Aktualizace v SQL</a></dt>
<br>
<p>Jazyk DML (<i>D</i>ata <i>M</i>odification <i>L</i>anguage) obsahuje klíèová slova pro manipulaci s atributy, množinami entit a vazbami entit.</p>
<center><h3>Pøehled klíèových slov DML</h3></center>
<table align="center" border="0" cellpadding="5" cellspacing="0">
<tbody><tr>
<td>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>aktualizace</i></caption>
<tbody><tr bgcolor="Lime">
    <td><center><b>SQL</b></center></td>
    <td><center><b>Význam</b></center></td>
  </tr>
  <tr>
    <td>DELETE</td>
    <td>zruš položky</td>
  </tr>
  <tr>
    <td>FROM</td>
    <td>z</td>
  </tr>
  <tr>
    <td>INSERT</td>
    <td>vložit položky</td>
  </tr>
  <tr>
    <td>INTO</td>
    <td>dovnitø do</td>
  </tr>
  <tr>
    <td>SELECT *</td>
    <td>vybrat všechny</td>
  </tr>
  <tr>
    <td>SET</td>
    <td>nastavit</td>
  </tr>
  <tr>
    <td>UPDATE</td>
    <td>aktualizovat položky</td>
  </tr>
  <tr>
    <td>VALUES</td>
    <td>hodnoty</td>
  </tr>
  <tr>
    <td>WHERE</td>
    <td>kde</td>
  </tr>
</tbody></table>
</td>
<td>
<table align="center" border="0" cellpadding="1" cellspacing="0">
<tbody><tr>
  <td>  </td>
</tr>
</tbody></table>
</td>
<td>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>projekce</i></caption>
<tbody><tr bgcolor="Lime">
    <th>SQL</th>
    <th>Význam</th>
  </tr>
  <tr>
    <td>*</td>
    <td>všechno</td></tr>
  <tr>
    <td>AND</td>
    <td>a souèasnì</td>
  </tr>
  <tr>
    <td>BY</td>
    <td>podle</td>
  </tr>
  <tr>
    <td>DESC</td>
    <td>sestupnì</td>
  </tr>
  <tr>
    <td>FROM</td>
    <td>z</td>
  </tr>
  <tr>
    <td>INTO</td>
    <td>dovnitø do</td>
  </tr>
  <tr>
    <td>NOT</td>
    <td>není pravda, že</td>
  </tr>
  <tr>
    <td>OR</td>
    <td>nebo</td>
  </tr>
  <tr>
    <td>ORDER</td>
    <td>seøaï</td>
  </tr>
  <tr>
    <td>SELECT</td>
    <td>vyber</td>
  </tr>
</tbody></table>
</td>
<td>
<table align="center" border="0" cellpadding="1" cellspacing="0">
<tbody><tr>
  <td>  </td>
</tr>
</tbody></table>
</td>
<td>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>selekce</i></caption>
<tbody><tr bgcolor="Lime">
    <th>SQL</th>
    <th>Význam</th>
  </tr>
  <tr>
    <td>_</td>
    <td>jeden znak</td></tr>
  <tr>
    <td>%</td>
    <td>skupina znakù</td>
  </tr>
  <tr>
    <td>IN</td>
    <td>je uvnitø</td>
  </tr>
  <tr>
    <td>IS</td>
    <td>je</td>
  </tr>
  <tr>
    <td>LIKE</td>
    <td>vypadá jako</td>
  </tr>
  <tr>
    <td>NOT</td>
    <td>ne</td>
  </tr>
  <tr>
    <td>PERCENT</td>
    <td>procent</td>
  </tr>
  <tr>
    <td>TOP</td>
    <td>horních</td>
  </tr>
  <tr>
    <td>WHERE</td>
    <td>kde platí</td>
  </tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p class="BEZ"><i><b>Projekce -</b> V databázových systémech ovlivòuje
konkrétní formulace projekce výsledek. Projekci mùžeme realizovat
takovým pøíkazem SELECT, který propustí informace o všech øádcích
tabulky, zatímco informace o sloupcích je zmìnìna projekcí. Projekcí
tedy rozumíme zpùsob zobrazení </i></p>
<p class="BEZ"><i>napø. </i></p><pre><i>SELECT jmeno, adresa FROM Ctenar</i></pre><i>  zde je projekcí dán výstup, kde se vypíší jen sloupce JMENO a ADRESA z tabulky CTENAR se všemi pøíslušejícími øádky.</i><p></p>
<p class="BEZ"><i><b>Selekce (restrikce) -</b> Jsou to podmínky a omezení pomocí nichž docílíme požadovaného výsledku. </i></p>
<p>Databáze v SQL je kolekce tabulek a pohledù. Mùže být definována jedním nebo více schématy.</p>
<p>Základním konstruktem SQL pro výbìr dat je SELECT- FROM-WHERE blok
(nebo též struènìji SELECT blok), který se skládá ze tøí složek
uvozených pøíslušnými vyhrazenými slovy:</p>
<ul type="circle">
<li> Klauzule SELECT koresponduje s operací projekce (pøípadnì spojení
nebo kartézským souèinem) z relaèní algebry. Obsahuje seznam jmen
atributù vytváøejících (nepojmenované) schéma relace - pro výsledek
dotazu reprezentovaného daným SELECT blokem. </li><li> Klauzule FROM obsahuje seznam jmen relací, nad kterými je dotaz definován. 
</li><li> Klauzule WHERE obsahuje obecnì podmínku, která definuje, co
musí splòovat vyhledávaná data. Kdybychom chtìli formálnì vyjádøit
sémantiku SELECT-FROM-WHERE bloku, lze (v pøípadì, že neuvažujeme
prázdné hodnoty) použít napø. relaèní algebru. </li></ul>
<p>Má-li dotaz tvar</p>
<pre>SELECT a1,a2,...,a3 
FROM r1,r2,...,rk 
WHERE &#216; </pre>
<p>pak ekvivalentní dotaz v relaèní algebøe by byl dán výrazem </p>
<pre>(r1 x r2 x...xrk)(&#216;)[a1,a2...,aj] </pre>
<p>Poznamenejme, že zde samozøejmì neøešíme, jak má vypadat podmínka (v
relaèní operaci
selekce byl dovolen pouze Booleovský výraz jednoduchých podmínek) a ke
kterým relacím odkazují atributy A1 , A2, ... , Aj podmínky lze chápat
jako TRUE. V relaèním SØBD ovšem dotaz není vyhodnocován tímto znaènì
neefektivním zpùsobem. Ten nám zde slouží pouze pro objasnìní sémantiky
dotazu. </p>
<p>Na rozdíl od teoretického RMD pøíkaz daný SELECT-FROM-WHERE blokem
neeliminuje z výsledku duplicitní n-tice, tzn. že výsledkem vlastnì
není relace, ale kolekce n-tic. Mùžeme také øíci, že jde o tabulku
obsahující nìjaké (eventuálnì nìkteré stejné nebo také žádné) øádky.
Tuto implicitní volbu lze vyjádøit explicitnì pomocí ALL. Chceme-li
získat skuteènì relaci, musí
se tento požadavek zadat explicitnì slovem DISTINCT. Dùvod pro toto
øešení je celkem zøejmý. Jde o implementaèní potíže, které jsou
zpùsobeny režií pøi odstraòování duplicitních n-tic kolekce. </p>
<p>V úplné formì bychom mohli zapsat syntaxi dotazu v SQL následovnì: </p>
<pre>SELECT [DISTINCT |ALL] {*|jméno-atrl[jméno-atr2]...}
FROM jméno-rell [,jméno-rel2]... 
[WHERE podmínka] 
[GROUP BY jméno-atrl [,jméno-atr2]... ] 
[HAVING podmínka]
[ORDER BY jméno-atr [ASC|DESC][,...]]</pre>
<p>kde za ORDER BY je seznam atributù, podle kterých chceme uspoøádat
výsledek dotazu. Uspoøádání výsledku je zavedeno z ryze praktických
dùvodù a pøekraèuje rámec RMD. </p>

<h2><a name="k1"></a>3.1 Jednoduché dotazy v SQL </h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<br>
<p>Pro následující pøíklady použijeme databázi KNIHOVNA s následujícími tabulkami :</p>
<br>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>CTENAR</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   
</tr>
<tr>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
</tbody></table>

</td>
<td>

<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr>
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr>
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr>
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>

</td>
</tr>

<tr>
<td>

<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>KNIHA</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">NAZEV</th> 
	<th colspan="1">AUTOR</th>   
	<th colspan="1">ROK</th>   
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
</tr>
</tbody></table>

</td>
<td>

<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>
<tr>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<i></i><p><i>V následujících tabulkách je barevnì vyznaèen výsledek (žlutì) a mezivýsledek (svìtle modøe).</i>
</p><p>Nejjednodušším pøíkladem jsou dotazy, kdy chybí nepovinné klauzule WHERE, ORDER BY, GROUP BY , HAVING, atd. </p>
<p>Požadujeme-li do odpovìdi celou relaci nebo její podmnožinu danou selekcí. užívá se za SELECT znak *. </p>
<b>D1.</b> Vypiš vše z tabulky CTENAR<p> </p>
<pre>SELECT * FROM Ctenar</pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>CTENAR</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   
</tr>
<tr bgcolor="Yellow">
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Yellow">
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr bgcolor="Yellow">
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Yellow">
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Yellow">
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Yellow">
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Yellow">
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Yellow">
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
</tbody></table>
<br>
<b>D2.</b> Vypiš tabulku jmen ètenáøù spolu s adresou. (projekce=výbìr sloupcù)<p> </p> 
<pre>SELECT jmeno, adresa FROM Ctenar</pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>CTENAR</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   	
</tr>
<tr>
	<td>100</td>
    <td bgcolor="Yellow">Tomica</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>101</td>
    <td bgcolor="Yellow">Begovská</td>
    <td bgcolor="Yellow">Karviná</td>
</tr>
<tr>
	<td>102</td>
    <td bgcolor="Yellow">Piš</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>103</td>
    <td bgcolor="Yellow">Rojíèek</td>
    <td bgcolor="Yellow">Bohumín</td>
</tr>
<tr>
	<td>104</td>
    <td bgcolor="Yellow">Macura</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>105</td>
    <td bgcolor="Yellow">Káòa</td>
    <td bgcolor="Yellow">Bohumín</td>
</tr>
<tr>
	<td>106</td>
    <td bgcolor="Yellow">Èernek</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>107</td>
    <td bgcolor="Yellow">Piš</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
</tbody></table>
<p>Protože se mùžou vyskytnout dva ètenáøi téhož jména na stejné
adrese, je vhodné odstranit takové duplicity pomocí zadání klauzule
DISTINCT </p>
<p class="BEZ"><i>Poznámka -</i> Výsledek SQL dotazu není množina jako
v relaèní algebøe, ale jsou možné i duplicitní øádky ve výsledné
tabulce. Pokud je potøebujeme odstranit použijeme klauzule DISTINCT.</p>
<pre>SELECT DISTINCT jmeno, adresa FROM Ctenar</pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>CTENAR</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   	
</tr>
<tr>
	<td>100</td>
    <td bgcolor="Yellow">Tomica</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>101</td>
    <td bgcolor="Yellow">Begovská</td>
    <td bgcolor="Yellow">Karviná</td>
</tr>
<tr>
	<td>102</td>
    <td bgcolor="Yellow">Piš</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>103</td>
    <td bgcolor="Yellow">Rojíèek</td>
    <td bgcolor="Yellow">Bohumín</td>
</tr>
<tr>
	<td>104</td>
    <td bgcolor="Yellow">Macura</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>105</td>
    <td bgcolor="Yellow">Káòa</td>
    <td bgcolor="Yellow">Bohumín</td>
</tr>
<tr>
	<td>106</td>
    <td bgcolor="Yellow">Èernek</td>
    <td bgcolor="Yellow">Orlová</td>
</tr>
<tr>
	<td>107</td>
	<td>Piš</td>
    <td>Orlová</td>
</tr>
</tbody></table>
<p>V nìkterých SØBD (napø. INFORMIX) se lze setkat v této souvislosti
kromì DISTINCT i s vyhrazeným slovem UNIQUE. Standard neumožòuje
použití obou možností. </p>
<p>Chceme-li mít výslednou tabulku na výstupu uspoøádanou napø. podle jména ètenáøe, zapíšeme </p>
<pre>SELECT DISTINCT jmeno,adresa FROM Ctenar
ORDER BY jmeno ASC </pre>
<p>Výstup je shodný s pøedchozí úlohou s tím rozdílem, že nyní je
setøídìn podle jména vzestupnì což je dáno klauzulí ASC, místo které
mùže být klauzule DESC pro sestupné seøazení.</p>
<b>D3.</b> Vypiš vše z tabulky EXEMPLAR. <p> </p>
<pre>SELECT * FROM Exemplar</pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr bgcolor="Yellow">
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr bgcolor="Yellow">
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr bgcolor="Yellow">
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr bgcolor="Yellow">
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr bgcolor="Yellow">
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
<br>
<b>D4.</b>Vypiš z relace EXEMPLAR n-tice týkající se nákupu po 20.3.1985. (selekce=výbìr øádkù) <p></p>
<pre>SELECT * FROM Exemplar 
  WHERE d_nakup&gt;'3/20/85' </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr bgcolor="Yellow">
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr>
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr>
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr bgcolor="Yellow">
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
<p>Zatím byla ve výrazu za WHERE použita pouze jednoduchá podmínka.
Obecnì lze zadat libovolný Booleovský výraz používající operátory =,
&lt;&gt; nebo != (není rovno), &lt;, &gt;, &lt;=, &gt;= . dále pak AND,
OR, NOT (stejnì jako v podmínce v definici selekce). Pro zjednodušeni
intervalových podmínek zahrnuje SQL také porovnávací operátor BETWEEN.
Výraz </p>
<pre>d_nakup &gt; `3/20/88' AND d_nakup &lt; `3/25/88'</pre>
<p>lze pak zapsat jako </p>
<pre>d_nakup BETWEEN `3/20/88' AND `3/25/88' </pre>
<p>Booleovský výraz kombinuje jednak jednoduché podmínky, jednak i další typy podmínek. o kterých se zmíníme pozdìji.</p>
<p>Zajímavìjší dotazy se týkají pøípadù, kdy jsou data do výsledku kombinována z více relací. </p>
<b>D5.</b>Ukázka práce se dvìma tabulkami najednou bez selekcí.<p> </p>
<center><b class="RED">!!! Pokud je za klíèovým slovem FROM uvedeno více tabulek (2 a víc) výsledkem je kartézský souèin. !!!</b></center><br>
<pre>SELECT * FROM Kniha, Rezervace</pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>Kartézský souèin tabulek KNIHA a REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">NAZEV</th> 
	<th colspan="1">AUTOR</th>   
	<th colspan="1">ROK</th>   
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>	
</tbody><tbody bgcolor="Yellow">
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>    
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody>
</table>
<br>
<b>D6.</b>Vypiš všechny údaje o autorech, kteøí mají rezervovanou libovolnou knihu.<p> </p>
<pre>SELECT * FROM Kniha, Rezervace
  WHERE Kniha.isbn = Rezervace.isbn </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>Kartézský souèin tabulek KNIHA a REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">NAZEV</th> 
	<th colspan="1">AUTOR</th>   
	<th colspan="1">ROK</th>   
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>	
<tr>
</tr><tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr bgcolor="Yellow">
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr bgcolor="Yellow">
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>    
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr bgcolor="Yellow">
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr bgcolor="Yellow">
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr bgcolor="Yellow">
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr bgcolor="Yellow">
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr bgcolor="Yellow">
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr bgcolor="Yellow">
    <td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
<p class="BEZ"><i>Poznámka -</i> Zde dochází ke spojení tabulek pomocí tzv. podmínky spojení Kniha.isbn = Rezervace.isbn .</p>
<b>D7.</b> Najdi autory, jejichž nìkteré tituly jsou rezervovány do 6.2.2000.<p> </p>
<pre>SELECT DISTINCT autor FROM Kniha, Rezervace 
  WHERE Kniha.isbn = Rezervace.isbn AND d_rez &lt; ' 2/6/2000' </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>Kartézský souèin tabulek KNIHA a REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">NAZEV</th> 
	<th colspan="1">AUTOR</th>   
	<th colspan="1">ROK</th>   
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>	
<tr>
</tr><tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>2</td>
    <td>Tuèòák</td>
    <td bgcolor="Yellow">Macura</td>
    <td>1977</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>    
    <td>2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>3</td>
    <td>Fazole</td>
    <td bgcolor="Yellow">Káòa</td>
    <td>1978</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>7</td>
    <td>Policie</td>
    <td bgcolor="Yellow">Kunèický</td>
    <td>1980</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr bgcolor="Aqua">
	<td>8</td>
    <td>Šef</td>
    <td bgcolor="Yellow">Heòo</td>
    <td>1972</td>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr bgcolor="Aqua">
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
<p class="BEZ"><i>Poznámka -</i> Zde je k podmínce spojení pøidána selekce daná podmínkou d_rez &lt; ' 2/6/2000'.</p>
<p class="BEZ"><i>Modrou barvou jsou zvýraznìné záznamy vyhovující
podmínce Kniha.isbn = Rezervace.isbn a žlutou je vyznaèen výsledek,
který je dosažen koneènou podmínkou d_rez &lt; ' 2/6/2000' s ohledem na
klíèové slovo DISTINCT (pokud výsledek obsahuje jméno autora, které se
opakuje, DISTINCT zajistí pouze jeden výskyt tohoto jména ve výsledné
tabulce).</i></p>
<p>Pomocí teèkové notace znázoròujeme vztah jména atributu k relaci,
je-li to nutné. Vìtšinou není vždy zøejmé, kdy je možné jméno relace
vynechat, a proto lze doporuèit jeho použití vždy. Zvyšuje to též
srozumitelnost dotazu. </p>
<p>Mají-li se ve výsledku objevit všechny atributy napø. obou relací,
vyznaèuje se tento fakt opìt pomocí " * ", avšak také v teèkové notaci.
Napø. spojení relací Kniha a Exemplar bychom za slovem SELECT znaèili
jako Kniha.*, Exemplar .*.</p>
<p>Ve výsledné relaci se bude ale sloupec <i>isbn</i> dvakrát opakovat, a to se stejnými hodnotami. </p>
<p>Jednoduchá podmínka Kniha.isbn = Exemplar .isbn za WHERE znamená
vlastnì
spojení pøes rovnost. Odstranìní jednoho ze dvou stejných sloupcù jeho
explicitním vynecháním za SELECT získáme užiteènìjší výsledek
odpovídající pøirozenému spojení. Kdybychom vynechali v D7 klauzuli
WHERE, obdrželi bychom kartézský souèin relací Kniha a Exemplar . </p>
<p>Èasto je užiteèné spojení dvou relací navzájem. </p>
<b>D8.</b> Najdi dvojice ètenáøù, kteøí mají stejnou adresu.<p> </p>
<pre>SELECT Prvni.cislo, Druhy.cislo FROM Ctenar Prvni, Ctenar Druhy
  WHERE Prvni.adresa = Druhy.adresa AND Prvni.cislo &lt; Druhy.cislo </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>Kartézský souèin dvou tabulek Ctenar s aliasy Prvni a Druhy</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   	
</tr>
<tr bgcolor="Aqua">
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td bgcolor="Yellow">102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td bgcolor="Yellow">104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">100</td>
    <td>Tomica</td>
    <td>Orlová</td>
    <td bgcolor="Yellow">106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">100</td>
    <td>Tomica</td>
    <td>Orlová</td>
	<td bgcolor="Yellow">107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr bgcolor="Aqua">
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td bgcolor="Yellow">104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">102</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td bgcolor="Yellow">106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">102</td>
    <td>Piš</td>
    <td>Orlová</td>
	<td bgcolor="Yellow">107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td bgcolor="Yellow">105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr bgcolor="Aqua">
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">104</td>
    <td>Macura</td>
    <td>Orlová</td>
    <td bgcolor="Yellow">106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">104</td>
    <td>Macura</td>
    <td>Orlová</td>
	<td bgcolor="Yellow">107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr bgcolor="Aqua">
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
    <td bgcolor="Yellow">106</td>
    <td>Èernek</td>
    <td>Orlová</td>
	<td bgcolor="Yellow">107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr bgcolor="Aqua">
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr bgcolor="Aqua">
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
    <td>106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr bgcolor="Aqua">
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
	<td>107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
</tbody></table>
<p class="BEZ"><i>Poznámka -</i> Obdoba pøedchozího pøíkladu s ukázkou
práce s pomocnými názvy tzv. aliasy. V našem pøípadì bylo jejich
použití nutné, protože musíme spojit tabulku CTENAR sama se sebou.
Aliasy se definují za napø. název tabulky, který mají nahradit. Jako
podmínka spojení je zde Prvni.adresa = Druhy.adresa a selekce je dána
výrazem Prvni.cislo &lt; Druhy.cislo.</p> 
<p class="BEZ"><i>Modrou barvou jsou zvýraznìné celé záznamy vyhovující
podmínce Prvni.adresa = Druhy.adresa a žlutou je vyznaèen výsledek,
který je dosažen koneènou podmínkou Prvni.cislo &lt; Druhy.cislo.</i></p>
<p>Oznaèení Prvni, Druhy znamená pouze lokální pøejmenování (lépe
"alias") relace CTENAR, která lze použít pøi vytváøení podmínky za
WHERE. Pøejmenování by v dotazu D8 staèilo pouze jedno. (Nerovností
mezi èísly ètenáøù zabezpeèíme, že se nám dvojice ètenáøù se stejnou
adresou nebudou opakovat, a že se neobjeví dvojice obsahující dvakrát
téhož ètenáøe.) </p>
<p>Z hlediska relaèního kalkulu nejde o nic jiného než o definice
n-ticových promìnných Prvni a Druhy. n-ticové promìnné jsou vlastnì v
bìžných dotazech definovány implicitnì jménem relace za FROM. </p>
<p>Závìrem odstavce zdùraznìme jeden dùležitý prvek v koncepci SQL,
kterým se liší od RMD. Tím, že byly zavedeny prázdné hodnoty, je nutné
zmìnit sémantiku vyhodnocení logických podmínek. Øeèeno z hlediska
logiky, je nutné pøejít od dvouhodnotové logiky k tøíhodnotové. Vedle
TRUE, FALSE je použito hodnoty NEDEF (nedefinováno). Všechny možnosti
pro podmínky A, B jsou shrnuty v tabulce 1. </p>
<table align="center" border="1" cellpadding="10" cellspacing="1">
<caption align="top"><i>Tabulka 1</i></caption>
<tbody><tr bgcolor="Lime">
    <th colspan="1">A</th>
	<th colspan="1">B</th> 
	<th colspan="1">A and B</th>   
	<th colspan="1">A or B</th>
	<th colspan="1">not A</th>
</tr>
<tr>
    <td>TRUE</td>
    <td>TRUE</td>
    <td>TRUE</td>
    <td>TRUE</td>
    <td>FALSE</td>
</tr>
<tr>
    <td>TRUE</td>
    <td>FALSE</td>
    <td>FALSE</td>
    <td>TRUE</td>
    <td>FALSE</td>
</tr>
<tr>
    <td>TRUE</td>
    <td>NEDEF</td>
    <td>NEDEF</td>
    <td>TRUE</td>
    <td>FALSE</td>
</tr>
<tr>
    <td>FALSE</td>
    <td>TRUE</td>
    <td>FALSE</td>
    <td>TRUE</td>
    <td>TRUE</td>
</tr>
<tr>
    <td>FALSE</td>
    <td>FALSE</td>
    <td>FALSE</td>
    <td>FALSE</td>
    <td>TRUE</td>
</tr>
<tr>
    <td>FALSE</td>
    <td>NEDEF</td>
    <td>FALSE</td>
    <td>NEDEF</td>
    <td>TRUE</td>
</tr>
<tr>
    <td>NEDEF</td>
    <td>TRUE</td>
    <td>NEDEF</td>
    <td>TRUE</td>
    <td>NEDEF</td>
</tr>
<tr>
    <td>NEDEF</td>
    <td>FALSE</td>
    <td>FALSE</td>
    <td>NEDEF</td>
    <td>NEDEF</td>
</tr>
<tr>
    <td>NEDEF</td>
    <td>NEDEF</td>
    <td>NEDEF</td>
    <td>NEDEF</td>
    <td>NEDEF</td>
</tr>
</tbody></table>
<h2><a name="k2"></a>3.2 Aritmetika a agregaèní funkce </h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<dt><a href="#k21">3.2.1 Konstrukt GROUP BY</a></dt>
<dt><a href="#k22">3.2.2 Sémantika agregaèních funkcí</a></dt>
<br>
<table align="center" border="0" cellpadding="5" cellspacing="0">
<tbody><tr><td>              
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>aritmetika</i></caption>
<tbody><tr bgcolor="Lime">
    <td><center><b>SQL</b></center></td>
    <td><center><b>Význam</b></center></td>
  </tr>
  <tr>
    <td>+,-,*,/</td>
    <td>+,-,*,/</td>
  </tr>
  <tr>
    <td>POWER(èíslo,mocnitel)</td>
    <td>mocnina</td>
  </tr>
  <tr>
    <td>ROUND(èíslo,poè_des_míst)</td>
    <td>zaokrouhlení</td>
  </tr>
  <tr>
    <td>ABS()</td>
    <td>absolutní hodnota</td>
  </tr>
  <tr>
    <td>SQRT()</td>
    <td>druhá odmocnina</td>
  </tr>
  <tr>
    <td>GREATEST(seznam hodnot)</td>
    <td>maximum</td>
  </tr>
  <tr>
    <td>LEAST(seznam hodnot)</td>
    <td>minimum</td>
  </tr>
  <tr>
    <td>MOD()</td>
    <td>zbytek po dìlení</td>
  </tr>
</tbody></table>
</td>
<td></td>
<td>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>agregace</i></caption>
<tbody><tr bgcolor="Lime">
    <td><center><b>SQL</b></center></td>
    <td><center><b>Význam</b></center></td>
  </tr>
  <tr>
    <td>AVG()</td>
    <td>prùmìr platných hodnot</td>
  </tr>
  <tr>
    <td>COUNT(*)</td>
    <td>poèet øádkù</td>
  </tr>
  <tr>
    <td>COUNT()</td>
    <td>poèet platných hodnot</td>
  </tr>
  <tr>
    <td>DISTINCT</td>
    <td>pouze odlišné hodnoty</td>
  </tr>
  <tr>
    <td>GROUP BY</td>
    <td>seskupit podle klíèe</td>
  </tr>
  <tr>
    <td>HAVING</td>
    <td>mající</td>
  </tr>
  <tr>
    <td>MAX()</td>
    <td>maximum platných hodnot</td>
  </tr>
  <tr>
    <td>MIN()</td>
    <td>minimum platných hodnot</td>
  </tr>
  <tr>
    <td>SUM()</td>
    <td>souèet platných hodnot</td>
  </tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p>Jednoduché rozšíøení základní verze relaèního jazyka lze provést
zavedením aritmetických operací. To umožní provádìt jednoduché výpoèty
na hodnotách vstupujících do výsledné relace. Využijí se k tomu hodnoty
atributù relací daných za FROM a typovì stejné konstanty. Aritmetický
výraz za SELECT lze využít napø. v následujícím dotazu. </p>
<b>D9.</b> Najdi všechny exempláøe knihy Tuèòák od Macury tzn. knihy s <i>isbn</i> = 2 a jejich cenu v DM ( souèasný kurz je 1 DM = 18 Kè ). <p> </p>
<pre>SELECT isbn,id,cena/18 FROM Exemplar
  WHERE isbn = 2 </pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">cena/18</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>200</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>2</td>
    <td>255</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>3</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
	<td>560</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>5</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>125</td>
</tr>
</tbody></table>
</td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">cena/18</th>   
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>2</td>
    <td>14</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>3</td>
    <td>5</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>5</td>
    <td>19</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p>Dále lze sílu jazyka ovlivnit pomocí vestavìných agregaèních
funkcí.V SQL jsou k dispozici funkce COUNT, SUM, MAX, MIN a AVG.
Použití tìchto funkcí se vztahuje k hodnotám dotazem specifikovaného
sloupce relace. Podle standardu ANSI, pro COUNT daného atributu musí
být povinnì specifikováno DISTINCT, naopak COUNT(*), tj. aplikace COUNT
na celou relaci, poèítá prvky vèetnì jejich duplicit. Funkce SUM a AVG
poèítají (není-li specifikováno DISTINCT) i s duplicitními hodnotami.
Požadavek zahrnutí duplicitních hodnot do výpoètu lze zadat i
explicitním vyjádøením ALL. Podle standardu mají agregaèní funkce
(kromì COUNT) ignorovat prázdné hodnoty. </p>
<p class="BEZ"><i>Pro zápis dotazu s agregací platí jednoduché pravidlo:</i></p>
<pre>SELECT popis projekce FROM tabulka 
  WHERE podmínka selekce
  GROUP BY klíè agregace 
  ORDER BY klíè tøídìní;</pre>
<p>Jde vlastnì o povinný popis projekce a datového zdroje, pak
následuje nepovinný popis selekce, nepovinný klíè k agregaci a
nepovinné setøídìní podle obecnì jiného klíèe. Pro pochopení dotazu s
agregací je tøeba si uvìdomit poøadí krokù, které se provádìjí po
obdržení dotazu. Nejprve je proveden výbìr tabulky, pak následuje
selekce, která vìtšinou výraznì zmenší poèet øádkù. Následná agregace
se zabývá pouze vybranými øádky po restrikci a podle klíèe nebo bez nìj
sestaví agregáty s využitím agregaèních funkcí. Ty jsou setøídìny, a
teprve potom dojde na projekci jednotlivých sloupcù.</p>
<p class="BEZ"><i>Tomu odpovídá schéma:</i></p>
<pre>TABULKA =&gt; SELEKCE =&gt; AGREGACE =&gt; TØÍDÌNÍ =&gt; PROJEKCE </pre>
<b>D10.</b> Jak velký je celkový poèet ètenáøù. <p> </p>
<pre> SELECT COUNT(*) FROM Ctenar </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">COUNT (*)</th>
</tr>
<tr bgcolor="Yellow">
	<td align="center">8</td>
</tr>
</tbody></table>
<p>Výsledkem je zøejmì nepojmenovaná unární relace s jedním prvkem a s nepojmenovaným sloupcem.</p>
<p class="BEZ"><i>Poznámka:</i> V SØBD 1NFORMIX je sloupec pojmenován COUNT(*). </p>
<b>D11.</b> Najdi celkový poèet ètenáøù, kteøí mají rezervovanou nìjakou knihu. <p> </p>
<pre>SELECT COUNT(DISTINCT cislo) FROM Rezervace </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">COUNT OF cislo</th>
</tr>
<tr bgcolor="Yellow">
	<td align="center">5</td>
</tr>
</tbody></table>
<b>D12.</b> Najdi poèet knih v knihovnì, které napsal Macura tzn. knih s <i>isbn</i> = 2. <p> </p>
<pre>SELECT COUNT(*) FROM Exemplar 
  WHERE isbn=2</pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
</td>
<td>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">COUNT (*)</th>
</tr>
<tr bgcolor="Yellow">
	<td align="center">3</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<b>D13.</b> Jaká je celková <i>cena</i> Macurových knih v knihovnì tzn. knih s <i>isbn</i> = 2. <p> </p>
<pre>SELECT SUM(cena) FROM exemplar 
  WHERE isbn = 2 </pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr bgcolor="Aqua">
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
</td>
<td>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">SUM(cena)</th>
</tr>
<tr bgcolor="Yellow">
	<td align="center">707</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p>Vyhodnocení dotazu vede k provedení souètu cen všech uvažovaných (i
eventuálnì stejných) knih. Vznikne jedna hodnota chápaná jako
jednoprvková unární relace. Kombinací aritmetických výrazù a aplikací
agregaèních funkcí lze vytváøet složitìjší konstrukce oznaèované jako <b>hodnotové výrazy</b>. První èást pøíkazu SELECT má potom obecnìjší tvar </p>
<pre>SELECT [DISTINCT | ALL] {* hodnotový-výrazl [,hodnotový-výraz2] ...} </pre>

<h3><a name="k21"></a>3.2.1 Konstrukt GROUP BY </h3>
<a href="#k2"><img src="kap3_soubory/toc.gif" alt="Obsah kapitoly 3.2"></a>
<p>Speciální pøípad, kdy agregaèní funkce aplikujeme na celou relaci èi
její podmnožinu, lze rozšíøit na možnost aplikace na podmnožiny relace
zkonstruované podle výbìrového kritéria. Toto kritérium pøedstavuje
klasifikaci podle hodnot vybraného atributu. Relace se konceptuálnì
(tj. nikoliv fyzicky) rozdìlí na skupiny, pro které je hodnota
zvoleného atributu konstantní. Øádky, které obsahují v dané komponentì
prázdnou hodnotu, se seskupí do jedné skupiny. (Pozor, v nìkterých
verzích SQL se tvoøí pro každou prázdnou hodnotu jedna skupina.) Jména
atributù, podle kterých se klasifikace provádí, jsou dána za vyhrazeným
slovem GROUP BY . Za SELECT se pak jako jména atributù mohou použít jen
tato klasifikaèní (v agregacích však mohou být další atributy). </p>
<b>D14.</b>Vypiš <i>isbn</i> knih a kolik celkem knihovnu stály. <p> </p>
<pre>SELECT isbn, sum(cena) CELKEM FROM Exemplar
  GROUP BY isbn</pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr>
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr>
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr>
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
</td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">CELKEM</th>   
</tr>
<tr bgcolor="Yellow">
	<td>1</td>
    <td>200</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>707</td>
</tr>
<tr bgcolor="Yellow">
	<td>3</td>
	<td>560</td>
</tr>
<tr bgcolor="Yellow">
	<td>4</td>
    <td>125</td>
</tr>
<tr bgcolor="Yellow">
	<td>7</td>
    <td>102</td>
</tr>
<tr bgcolor="Yellow">
	<td>8</td>
    <td>156</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p class="BEZ"><i>Poznámka -</i> Zde vidíme další využití aliasu. V tomto pøípadì je výraz SUM(cena), ve výsledném výpisu, nahrazen textem CELKEM.</p>
<b>D15.</b>Vypiš <i>isbn</i> knih a kolik celkem knihovnu stály. Výstup setøiï podle celkové ceny.<p> </p>
<pre>SELECT isbn, sum(cena) CELKEM FROM Exemplar
  GROUP BY isbn
  ORDER BY celkem</pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr>
	<td>2</td>
    <td>2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr>
	<td>2</td>
    <td>3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr>
	<td>2</td>
    <td>5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr>
	<td>8</td>
    <td>7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
</td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">CELKEM</th>   
</tr>
<tr bgcolor="Yellow">
	<td>7</td>
    <td>102</td>
</tr>
<tr bgcolor="Yellow">
	<td>4</td>
    <td>125</td>
</tr>
<tr bgcolor="Yellow">
	<td>8</td>
    <td>156</td>
</tr>
<tr bgcolor="Yellow">
	<td>1</td>
    <td>200</td>
</tr>
<tr bgcolor="Yellow">
	<td>3</td>
	<td>560</td>
</tr>
<tr bgcolor="Yellow">
	<td>2</td>
    <td>707</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<b>D16.</b> Najdi pro každého ètenáøe poèet rezervovaných knih. <p> </p>
<pre>SELECT cislo, COUNT(DISTINCT isbn) FROM Rezervace 
  GROUP BY cislo</pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>
<tr>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
</td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>	
	<th colspan="1">COUNT OF isbn</th>   
</tr>
<tr bgcolor="Yellow">
    <td>100</td>
    <td>1</td>
</tr>
<tr bgcolor="Yellow">
    <td>101</td>
	<td>1</td>
</tr>
<tr bgcolor="Yellow">
    <td>102</td>
	<td>1</td>
</tr>
<tr bgcolor="Yellow">
    <td>105</td>
	<td>1</td>
</tr>
<tr bgcolor="Yellow">
    <td>107</td>
	<td>1</td>
</tr>
<tr bgcolor="Yellow">
    <td>108</td>
	<td>2</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p>V dotazu D16 se relace VÝPÙJÈKA rozdìlí podle èísel ètenáøù a na
každou skupinu se aplikuje agregaèní funkce COUNT. Chceme-li, aby do
výsledku pøispívaly pouze nìkterá z tìchto skupin, lze použít klauzuli
dotazu uvedenou vyhrazeným slovem HAVING. HAVING má obdobnou funkci
jako WHERE pøi práci s celými relacemi (danými za FROM). Je tøeba. aby
výraz za SELECT vedl právì k jednomu prvku pro každou vybranou skupinu.
</p>
<p>Je pøirozené, že i za HAVING lze použít agregaèní funkci. </p>
<b>D17.</b> Najdi ty ètenáøe, kteøí mají rezervováno více než 1 knihu. <p> </p>
<pre>SELECT cislo, COUNT(DISTINCT isbn) FROM Rezervace
  GROUP BY cislo 
  HAVING 1 &lt; COUNT(isbn) </pre>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<tbody><tr>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>
<tr>
    <td>1</td>
    <td>100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>2</td>
	<td>108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
	<td>105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr bgcolor="Aqua">
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
</td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>	
	<th colspan="1">COUNT OF isbn</th>   
</tr>
<tr bgcolor="Yellow">
    <td>108</td>
    <td align="center">2</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
<p>Výsledek je 2 a ne 3, protože SELECT obsahuje DISTINCT, který nám
vypustí každou položku, která by se opakovala. V našem pøípadì je to
záznam s <i>isbn</i>=8. </p>
<p class="BEZ"><i>Poznámka:</i> Je zajímavé, že tento syntakticky
správný dotaz podle standardu je implementací SQL, v INFORMIXu odmítán
(výskyt dvou DISTINCT v pøíkazu SELECT). Vynechání DISTINCT však vede
opìt k syntaktické chybì. </p>
<p>Pro "ètivìjší" formát výstupu lze do tabulky umístit i konstantu,
která se bude opakovat ve všech øádcích. Vložme takto do dotazu D17.
øetìzce znakù `SI REZERVOVAL', `KNIHY'. </p>
<b>D17'.</b> 
<pre>SELECT cislo,'SI REZERVOVAL',COUNT(isbn),'KNIHY' FROM Rezervace 
  GROUP BY cislo 
  HAVING 1 &lt; COUNT(DISTINCT isbn)</pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>	
    <th colspan="1"> </th>	
	<th colspan="1">COUNT OF ISBN</th>   
    <th colspan="1"> </th>	
</tr>
<tr bgcolor="Yellow">
    <td>108</td>
    <td>SI REZERVOVAL</td>
    <td align="center">2</td>
    <td>KNIHY</td>	
</tr>
</tbody></table>
<h3><a name="k22"></a>3.2.2 Sémantika agregaèních funkcí </h3>
<a href="#k2"><img src="kap3_soubory/toc.gif" alt="Obsah kapitoly 3.2"></a>
<p> Potøebný term má tvar </p>
<p><i>agregaèní,funkce(výraz_ relaèního_ kalkulu[,atributJ)</i></p>
<p>Rozšíøíme-li relaèní kalkul o tyto termy, obdržíme ovšem nìco, co se
ponìkud odlišuje od agregaèních funkcí v SQL. Napø. na prázdných
množinách vrací agregaèní funkce v SQ1. NULL, kromì COUNT, která dává
správnì 0. V kalkulu by sémantika mohla být bohatší (napø . AVG by na
prázdné množinì mìla hlásit chybu). V kalkulu také není nutné se
zabývat DISTINCT, protože výraz_relaèního_kalkulu dává množinu
definitoricky a použití prvku atribut naopak implicitnì neeliminuje
duplicity, což je pro agregaèní funkce vhodné. </p>
<p>Uvažujme schéma relace DODÁVÁ. Pak dotaz </p>
<b>D18.</b> Najdi prùmìrné množství do knihoven dodaných knih se v relaèním kalkulu vyjádøí jako <p> </p>
<pre> mn where mn = AVG(DODÁVÁ,MNOŽSTVÍ)</pre>
<p>kde typ promìnné mn se dìdí podle typu oboru hodnot agregaèních funkcí. V SQL by mìl dotaz D18 vyjádøení </p>
<pre>SELECT `MN =', AVG(mnozstvi) FROM Dodava </pre>
<p class="BEZ"><i>Poznámka:</i>AVG je, co se výstupu týèe, obdoba COUNT s tím rozdílem, že AVG vrací prùmìrnou hodnotu a COUNT poèet záznamù</p> 
<p>Kdybychom požadovali prùmìr pouze z rùzných množství dodávaných
knih, bylo by nutné vytvoøit projekci relace DODÁVÁ na atribut MNOŽSTVÍ
(ta tvoøí relaci) a na ni aplikovat agregaèní funkci. </p>
<pre>mn where mn = AVG(x.MNOŽSTVÍ where DODÁVÁ(x), MNOŽSTVÍ) </pre>
<p>V SQL jde o výraz </p>
<pre>SELECT `MN =' AVG(DISTINCT mnozstvi) FROM Dodava </pre>
<p>V dotazu D19 se budeme zajímat o prùmìrné množství dodaných knih pro
každou knihovnu. V relaèním kalkulu se tento požadavek vyjádøí jako </p>
<pre>x.NÁZEV_K, mn where DODÁVÁ(x) and 
                   mn = AVG(y where DODÁVÁ(y) and 
                            x.NÁZEV_K = y.NAZEV_K, MNOŽSTVÍ) </pre>
<p> a v SQL jako </p>
<b>D19.</b>
<pre>SELECT nazev_k, `MN=', AVG(mnozstvi) FROM Dodava 
  GROUP BY nazev_k </pre>
<p>Vyzkoušíme nyní modifikaci D19 (oznaèenou D19') s prùmìry rùzných
množství dodaných knih pro každou knihovnu. V relaèním kalkulu pouze
provedeme projekci na MNOŽSTVÍ, tj. </p>
<pre> x.NÁZEV_K, mn where DODÁVÁ(x) and 
                    mn = AVG(y.MNOŽSTVÍ where DODÁVÁ(y) and 
                             x.NÁZEV_K = y.NÁZEV_K, MNOŽSTVÍ), </pre>
<p>zatímco v SQL se objeví klauzule DISTINCT. </p>
<b>D19'.</b> 
<pre>SELECT nazev_k, `MN =', AVG(DISTINCT mnozstvi) FROM Dodava 
  GROUP BY nazev_k </pre>
<p>Agregaèní funkce lze podobnì jako za HAVING použít také za WHERE v hnízdìných SELECT blocích (poddotazech). Uvažujme dotaz </p>
<b>D20.</b> Vyber knihovny, do kterých bylo dodáno více než 50 knih. V relaèním kalkulu jde o výraz <p> </p>
<pre>x.NÁZEV_K where DODÁVÁ(x) and 
               sumy where DODÁVÁ(y) and
                         x.NÁZEV_ K = y.NÁZEV_ K, MNOŽSTVÍ)&gt;50 </pre>
<p>Ekvivalentní výraz v SQL má tvar </p>
<pre>SELECT DISTINCT nazev_k FROM Knihovna 
  WHERE 50 &lt; (SELECT SUM(mnozstvi) FROM Dodava Y
                WHERE Dodava.nazev_k = Y.nazev_k) </pre>
<a href="#o1">Grafické vysvìtlení hnízdìného SELECT-FROM-WHERE bloku zaèíná u D27.</a>			
<p class="BEZ"><i>Poznámka:</i> Podle standardu není možné porovnávat
výsledek SELECT s hodnotou (danou výrazem ) v libovolném poøadí. Proto
bylo nutné, oproti relaènímu kalkulu, v posledním dotazu SQL. poøadí
operandù porovnání otoèit. </p>
<p>Vícenásobné použití agregaèních funkcí v jedné úrovni neèiní žádné koncepèní potíže. </p>
<b>D21.</b> Dotaz - Najdi pro každou knihovnu minimální a maximální poèet dodaných knih.
se v relaèním kalkulu zapíše jako <p> </p>
<pre>x.NÁZEV_K, mi, ma where DODÁVÁ(x) and 
    mi=miny where DODÁVÁ(y) and y.NÁZEV_K=x.NÁZEV K,MNOŽSTVÍ)
    and ma=max(y where DODÁVÁ(z) and z.NÁZEV_K=x.NÁZEV K,MNOŽSTVÍ) </pre>
<p> a v SQL jako </p>
<pre>SELECT nazev_k,'MI=',MIN(mnozstvi),'MA=',MAX(mnozstvi) FROM Dodava 
  GROUP BY nazev_k </pre>
<p>Možnost dvou agregací vychází z toho, že jejich argument je tentýž. Problémy nastanou s hnízdìnými agregacemi. </p>
<p>Uvažujme dotaz </p>
<b>D22.</b> Najdi prùmìrný celkový pøírùstek knih do knihoven. <p></p>
<p> V nelaèním kalkulu bychom ho zapsali takto: </p>
<pre>a where a = avg(v.t where DODÁVÁ(x) and 
                          t=sum(y where DODÁVÁ(y) and 
		                y.NÁZEV_K=x.NÁZEV_K. MNOŽSTVÍ),t) </pre>
<p>Ve standardu SQL nelze jedním pøíkazem tento dotaz zapsat. Date se
ovšem zmiòuje o existenci produktù SQL, které umožòují hnízdìní
agregaèních funkcí do dvou úrovni. Z vlastní zkušenosti mohu upozornit
na produkt SQLBase firmy GUPTA, který také dovoluje hnízdìní
agregaèních funkcí. </p>
<p>V standardním SQL lze dotaz D22 realizovat pomocí relaèního pøiøazovacího pøíkazu. </p>
<pre>INSERT INTO X (nazev_k,t) 
SELECT nazev_k, t=SUM(mnozstvi) FROM Dodava 
  GROUP BY nazev_k </pre>
<p>a následného provedení </p>
<pre>SELECT AVG(t) FROM X </pre>
<p>Zkomplikujeme dotazy dalším zpùsobem - aplikací agregaèních funkcí v GROUP BY HAVING. Uvažujme relaci KNIHKUPEC a dotaz </p>
<b>D23.</b> Najdi asociace, ve kterých je více než 150 knihkupcù støedoškolského vzdìlání, který lze v SQL vyjádøit jako <p> </p>
<pre>SELECT asociace FROM Knihkupec
  WHERE vzdelani = `S' 
  GROUP BY asociace 
  HAVING 150 &lt; COUNT(*) </pre>
<p>Formulujeme-li podobný dotaz </p>
<b>D24.</b> Najdi asociace, ve kterých je ménì než 150 knihkupcù støedoškolského vzdìlání "inverznì" jako <p> </p>
<pre>SELECT asociace FROM Knihkupec 
  WHERE vzdelani = `S' 
  GROUP BY asociace 
  HAVING 150 &gt; COUNT(*) </pre>
<p>nebude výsledek zcela korektní, protože nebude zahrnovat ty
asociace, které nemají žádné knihkupce se støedoškolským vzdìláním. To
ovšem nenastává v relaèním kalkulu, kde dotaz D24 má tvar </p>
<pre>x.ASOCIACE where KNIHKUPEC(x) and 
                 count(y.JMÉNO_K where KNIHKUPEC(y) and 
                       y.ASOCIACE=x.ASOCIACE and 
                       y.VZDÌLÁNÍ='S') &lt; 150 </pre>
<p>Abychom dosáhli ekvivalentu tohoto dotazu v SQL, je nutné jej zapsat takto: </p>
<pre>SELECT asociace FROM Knihkupec
WHERE 150 &gt;(SELECT COUNT DISTINCT jmeno_k FROM Knihkupec Y 
              WHERE Y.asociace = asociace AND vzdelani = `S') </pre>
<p>Dotaz D23 se vyjádøí pouhou zámìnou &gt; za &lt;. I když použijeme
podobného triku u dalších agregaèních funkcí, nemusí být výsledek bez
problémù. Uvažujme opìt schéma relace DODAVÁ. Pak dotaz </p>
<b>D25.</b> Najdi knihovny, kde množství do nich dodávaných knih z
Èapkova knihkupectví, je menší než 20 bychom podle daného vzoru
zkonstruovali jako <p></p>
<pre>SELECT DISTINCT nazev_k FROM dodava 
  WHERE 20&gt;(SELECT SUM (mnozstvi) FROM Dodava X
            WHERE Dodava.nazev_k = X.nazev_k
                  AND X.jmeno_k='Èapek') </pre>
<p>Je-li poèet knih dodaných Èapkem nulový, nedává (tak jak bychom
oèekávali) SUM poèet rovný 0, nýbrž NULL, tj. tyto knihovny se
nedostanou do odpovìdi. V DB2 se tento problém øeší konverzí NULL do 0
pomocí funkce VALUE. </p>
<b>D25.(DB2 - SQL)</b>  
<pre>SELECT nazev_k FROM Dodava 
  WHERE 20&gt;(SELECT VALUE (SUM (mnozstvi),0)
              FROM Dodava X 
              WHERE Dodava.nazev_k = X.nazev_k 
                    AND X.jmeno_k='Èapek') </pre>
<p>Dotazy obsahující více agregací rùzných množin hodnot je nutné øešit rozkladem na poddotazy. Napø. dotaz</p>
<b>D26.</b> Najdi pro každou asociaci poèet knihovníkù se støedoškolským vzdìláním a poèet knihovníku s vysokoškolským vzdìláním <p></p>
<p class="BEZ">se rozloží na dva poddotazy, z nichž v prvním se pomocí
INSERT uloží výsledek do SŠKNIH(ASOCIACE,SŠPOÈET) a v druhém do
VSKNIH(ASOCIACE, VŠPOÈET). Potom se provede SELECT vytváøející spojení
obou mezivýsledkù. V relaèním kalkulu jde ovšem o jeden výraz </p>
<pre>x.ASOCIACE,sšpoèet,všpoèet where KNIHKUPEC(x) and
      sšpoèet=count(y.JMÉNO where KNIHKUPEC(y) and 
                    y.ASOCIACE=x.ASOCIACE and y.VZDÌLÁNÍ='S') and
      všpoèet=count(y.JMÉNO where KNIHKUPEC(y) and 
                    y.ASOCIACE=x.ASOCIACL and y.VZDÌLÁNÍ='V')</pre>
<h2><a name="k3"></a>3.3 Manipulace s množinami v SQL</h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Nìkteré složitìjší dotazy vyžadují další konstrukty, které obvykle
vedou k hnízdìní SELECT-FROM-WHERE blokù a dalším možnostem k vytváøení
podmínky za WHERE. </p>
<p>Jeden z takových konstruktù je dán vyhrazeným slovem IN. Zápisem p IN A pak udáváme podmínku, že p je prvkem množiny A. </p>
<a name="o1"></a>
<b>D27.</b> Najdi èísla ètenáøù, kteøí mají rezervovány jisté tituly do 10.2.2000 a vypiš jen ty, kteøí nejsou v tabulce CTENAR.<p> </p>
<p class="BEZ"><i>Poznámka:</i> Závorky dávají jednoznaènì sémantiku dotazu v èeštinì. </p>
<pre>SELECT DISTINCT cislo FROM Rezervace 
  WHERE d_rez &lt; ' 2/10/2000' AND 
        cislo NOT IN (SELECT cislo FROM Ctenar) </pre>
<table align="center" cellpadding="10" cellspacing="0">
<tbody><tr>
<td><b><i>A -</i> SELECT cislo FROM Ctenar</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>CTENAR</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   
</tr>
<tr>
    <td bgcolor="Aqua">100</td>
    <td>Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td bgcolor="Aqua">101</td>
    <td>Begovská</td>
    <td>Karviná</td>
</tr>
<tr>
    <td bgcolor="Aqua">102</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td bgcolor="Aqua">103</td>
    <td>Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td bgcolor="Aqua">104</td>
    <td>Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td bgcolor="Aqua">105</td>
    <td>Káòa</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td bgcolor="Aqua">106</td>
    <td>Èernek</td>
    <td>Orlová</td>
</tr>
<tr>
	<td bgcolor="Aqua">107</td>
    <td>Piš</td>
    <td>Orlová</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><b><i>B -</i> SELECT DISTINCT cislo FROM Rezervace<br>
WHERE d_rez &lt; ' 2/10/2000' </b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>
<tr>
    <td>1</td>
    <td bgcolor="Aqua">100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
	<td bgcolor="Aqua">108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
	<td bgcolor="Aqua">105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
	<td>102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
	<td>108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
	<td>101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
	<td>108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
	<td>8</td>
	<td>107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><b>3. spojení výrazù B NOT IN A</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th>&nbsp;</th>	
</tr>
<tr bgcolor="Yellow">
    <td>108</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>	  
<b>D28.</b> Najdi všechny exempláøe knih, které mají <i>isbn</i> rovno 2 a 8. <p> </p>
<pre>SELECT isbn, id FROM Exemplar 
  WHERE isbn IN (2,8) </pre>
<table align="center" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>EXEMPLAR </i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">ID</th>
	<th colspan="1">D_NAKUP</th> 
	<th colspan="1">CENA</th>   
</tr>
<tr>
	<td>1</td>
    <td>1</td>
    <td>11.5.1988</td>
    <td>200</td>
</tr>
<tr bgcolor="Aqua">
	<td bgcolor="Yellow">2</td>
    <td bgcolor="Yellow">2</td>
    <td>2.5.1978</td>
    <td>255</td>
</tr>
<tr bgcolor="Aqua">
	<td bgcolor="Yellow">2</td>
    <td bgcolor="Yellow">3</td>
    <td>15.6.1984</td>
    <td>100</td>
</tr>
<tr>
	<td>3</td>
    <td>4</td>
    <td>18.3.2000</td>
	<td>560</td>
</tr>
<tr bgcolor="Aqua">
	<td bgcolor="Yellow">2</td>
    <td bgcolor="Yellow">5</td>
    <td>15.2.2000</td>
    <td>352</td>
</tr>
<tr>
	<td>7</td>
    <td>6</td>
    <td>19.5.1977</td>
    <td>102</td>
</tr>
<tr bgcolor="Aqua">
	<td bgcolor="Yellow">8</td>
    <td bgcolor="Yellow">7</td>
    <td>14.6.1982</td>
    <td>156</td>
</tr>
<tr>
	<td>4</td>
	<td>8</td>
    <td>15.2.1985</td>
    <td>125</td>
</tr>
</tbody></table>
<p>Hnízdìní dotazù lze užít nejen v IN, ale i s porovnávacími
operátory, máme-li zaruèeno, že výsledek hnízdìného dotazu bude právì
jedna hodnota. </p>
<b>D29.</b> Najdi jména ètenáøù, kteøí mají rezervovanou knihu Tuèòák. <p> </p>
<pre>SELECT jmeno FROM Ctenar 
  WHERE cislo IN (SELECT cislo FROM Rezervace 
                   WHERE isbn=(SELECT isbn 
                                 FROM Kniha 
                                 WHERE nazev_k='Tuèòák'))</pre>
<table align="center" cellpadding="10" cellspacing="0">
<tbody><tr>
<td><b><i>A -</i> SELECT isbn FROM Kniha<br> 
WHERE nazev_k='Tuèòák'</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>KNIHA</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ISBN</th>
	<th colspan="1">NAZEV</th> 
	<th colspan="1">AUTOR</th>   
	<th colspan="1">ROK</th>   
</tr>
<tr>
    <td>1</td>
    <td>Noha</td>
    <td>Èernek</td>
    <td>1988</td>	
</tr>
<tr>
    <td bgcolor="Aqua">2</td>
    <td>Tuèòák</td>
    <td>Macura</td>
    <td>1977</td>
</tr>
<tr>
    <td>3</td>
    <td>Fazole</td>
    <td>Káòa</td>
    <td>1978</td>
</tr>
<tr>
    <td>4</td>
    <td>Chip</td>
	<td>Široký</td>
	<td>1981</td>
</tr>
<tr>
    <td>5</td>
    <td>Killer</td>
    <td>Mareš</td>
    <td>1999</td>
</tr>
<tr>
    <td>6</td>
    <td>Odpor</td>
    <td>Koláø</td>
    <td>1977</td>
</tr>
<tr>
    <td>7</td>
    <td>Policie</td>
    <td>Kunèický</td>
    <td>1980</td>
</tr>
<tr>
	<td>8</td>
    <td>Šef</td>
    <td>Heòo</td>
    <td>1972</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><b><i>B -</i> SELECT cislo FROM Rezervace</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>REZERVACE</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">ID_R</th>
    <th colspan="1">CISLO</th>	
	<th colspan="1">ISBN</th> 
	<th colspan="1">D_REZ</th>   
</tr>
<tr>
    <td>1</td>
    <td bgcolor="Aqua">100</td>
    <td>2</td>
    <td>1.1.2000</td>
</tr>
<tr>
    <td>2</td>
	<td bgcolor="Aqua">108</td>
    <td>8</td>
    <td>12.1.2000</td>
</tr>
<tr>
    <td>3</td>
	<td bgcolor="Aqua">105</td>
    <td>7</td>
    <td>5.2.2000</td>
</tr>
<tr>
    <td>4</td>
	<td bgcolor="Aqua">102</td>
    <td>2</td>
	<td>5.8.2000</td>
</tr>
<tr>
    <td>5</td>
	<td bgcolor="Aqua">108</td>
    <td>3</td>
    <td>4.1.2000</td>
</tr>
<tr>
    <td>6</td>
	<td bgcolor="Aqua">101</td>
    <td>4</td>
    <td>9.5.2000</td>
</tr>
<tr>
    <td>7</td>
	<td bgcolor="Aqua">108</td>
    <td>8</td>
    <td>25.2.2000</td>
</tr>
<tr>
	<td>8</td>
	<td bgcolor="Aqua">107</td>
    <td>8</td>
    <td>6.4.2000</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><b><i>C -</i> B WHERE isbn = A</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th>&nbsp;</th>
</tr>
<tr bgcolor="Aqua">
    <td>100</td>
</tr>
<tr bgcolor="Aqua">
    <td>102</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><b><i>D - </i>SELECT jmeno FROM Ctenar</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<caption align="top"><i>CTENAR</i></caption>
<tbody><tr bgcolor="#8080ff">
    <th colspan="1">CISLO</th>
	<th colspan="1">JMENO</th> 
	<th colspan="1">ADRESA</th>   
</tr>
<tr>
    <td>100</td>
    <td bgcolor="Aqua">Tomica</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>101</td>
    <td bgcolor="Aqua">Begovská</td>
    <td>Karviná</td>
</tr>
<tr>
    <td>102</td>
    <td bgcolor="Aqua">Piš</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>103</td>
    <td bgcolor="Aqua">Rojíèek</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>104</td>
    <td bgcolor="Aqua">Macura</td>
    <td>Orlová</td>
</tr>
<tr>
    <td>105</td>
    <td bgcolor="Aqua">Káòa</td>
    <td>Bohumín</td>
</tr>
<tr>
    <td>106</td>
    <td bgcolor="Aqua">Èernek</td>
    <td>Orlová</td>
</tr>
<tr>
	<td>107</td>
    <td bgcolor="Aqua">Piš</td>
    <td>Orlová</td>
</tr>
</tbody></table>
</td>
</tr>
<tr>
<td><b>D WHERE cislo IN C</b></td>
<td>
<table align="left" border="1" cellpadding="1" cellspacing="1">
<tbody><tr bgcolor="#8080ff">
    <th>&nbsp;</th>
</tr>
<tr bgcolor="Yellow">
    <td>Tomica</td>
</tr>
<tr bgcolor="Yellow">
    <td>Piš</td>
</tr>
</tbody></table>
</td></tr></tbody></table>						   
<p>Poznamenejme, že úvaha o jednoznaènosti <i>isbn</i> titulu Tuèòák bude platit v pøípadì, že existuje jen jedno vydání Tuèòáka a že má vùbec pøiøazeno <i>isbn</i>. Dotaz D29 nám zároveò ukázal i možnosti více úrovní hnízdìní SELECT FROM WHERE blokù. </p>
<p>Možnost porovnat hodnotu s hodnotou ze specifikované množiny
nabízejí konstrukty &gt; SOME, &lt; SOME, ... . = SOME je zøejmì
ekvivalentní použití IN. Klíèové slovo ANY je v SQL synonymum pro SOME.
Zatímco døívìjší verze SQL dovolovaly pouze ANY, které je v angliètinì
víceznaèné, pozdìjší verze pøidaly SOME.</p>
<p> Dalším konstruktem je &gt; ALL vyjadøující "vìtší než všechny prvky
ze specifikované množiny". K dispozici je i možnost použít další
porovnávací predikáty pøed ALL. Použití != ALL je ekvivalentní NOT IN. </p>
<b>D30.</b> Najdi <i>isbn</i> knih dražších než jakákoliv kniha z GB. <p> </p>
<pre>SELECT isbn FROM Exemplar
  WHERE cena &gt; ALL (SELECT Exemplar.cena 
                      FROM Exemplar 
                      WHERE Exemplar.zeme_vydani = `GB') </pre>
<p>Pùvodní Sequel obsahoval také množinové porovnání " je podmnožinou"
CONTAINS, které se nevyskytuje ve standardu SQL. Dùvodem je zøejmì
vysoká cena vyhodnocení podmínky s CONTAINS. </p>
<h2><a name="k4"></a>3.4 Kvantifikace v SQL </h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Uživatel jazyka SQL se obèas setká s dotazy, které ve své složitosti
obvykle pøesahují rámec jednoduchých dotazù. Lze se snadno pøesvìdèit,
že jednoduché dotazy lze vyjádøit jedním SELECT-FROM-WHERE pøíkazem. </p>
<p>Tìžší dotazy zøejmì vedou k hnízdìní SELECT-FROM-WHERE blokù, což z
hlediska napø. relaèního kalkulu mùže znamenat použití univerzálního
kvantifikátoru a negace. Problémem je, že je obtížné formulovat takové
dotazy pøímo. Pøíkladem budiž dotaz </p>
<b>D31.</b> Najdi jména a adresy knihkupcù, kteøí dodávají knihy do všech knihoven. V relaèním kalkulu má vyjádøení <p> </p>
<pre>x.JMÉNO_K, x.MÌSTO where KNIHKUPEC(x) and forall y <span style="font-size: 12pt; font-family: Symbol;">Î</span> KNIHOVNA 
                       (exists z <span style="font-size: 12pt; font-family: Symbol;">Î</span> DODÁVÁ (z.JMÉNO_K=x.JMÉNO_K and 
                                            z.NÁZEV_K=y.NÁZEV_K)) </pre>
<p> Uvidíme brzy, že vyjádøení tohoto dotazu není v SQL triviální. </p>
<p>V [DD92] navrhuje Date jednoduchou metodu, jak formulovat takové dotazy: </p>
<ol>
<li> vyjádøit dotaz v relaèním kalkulu, 
</li><li> transformovat výraz v relaèním kalkulu do SQL. 
</li></ol>
<p>Výhoda tohoto postupu je zøejmá. Uživatel formulací v kalkulu
vlastnì provádí logickou analýzu dotazu, a to pomocí prostøedku, který
má oproti SQL mnohé výhody, jako napø. ortogonálnost, systematiènost,
pøímou podporu univerzální a existenèní kvantifikace apod. Výsledek
transformace z relaèního kalkulu do SQL bude sice možná ménì prùhledný,
ale formálnì správný. I když i to je tøeba vzhledem k jistým
záludnostem SQL brát s rezervou. </p>
<p>Ze znalosti formálního relaèního kalkulu vyplývá, že univerzální
(forall) a existenèní (exists) kvantifikátor jsou spolu svázány
jednoduchou transformací: </p>
<pre>forall x (p(x)) = not exists x (not p(x)) </pre>
<p>Z toho plyne, že jakýkoliv výraz obsahující univerzální
kvantifikátor mùže být nahrazen výrazem, který obsahuje pouze
existenèní kvantifikátor, a naopak. Uvažujme napø. výraz </p>
<pre>forall x exists y (y &gt; x) </pre>
<p>Tento výraz mùže být nahrazen výrazem </p>
<pre> not exists x (not exists y (y &gt; x)) </pre>
<p>V pøirozeném jazyku jde napø. o konstrukce typu "Pro všechny knihy
platí, že mají název". Ekvivalentní vyjádøení je "Neexistuje kniha
taková, že není pravda, že tato kniha má název". Jednodušeji øeèeno,
"Každá kniha má název" je ekvivalentní tvrzení "Neexistuje
kniha bez názvu". </p>
<p>Zøejmì je jednodušší myslet v univerzálních kvantifikátorech než v
negacích existenèních kvantifikátorù. Zdùraznìme zde, že SQL nemá
univerzální kvantifikátor. Obsahuje však konstrukt EXISTS, který
simuluje existenèní kvantifikátor. EXISTS v SQL není ovšem totéž. co
existenèní kvantifikátor. Je to test na neprázdnost množiny
specifikované za EXISTS. </p>
<p>Ukážeme nejprve nìkolik pøíkladù pro použití EXISTS. </p>
<b>D32.</b> Najdi jména ètenáøù, kteøí mají rezervovanou nìjakou knihu. Reformulací dotazu získáme D32'.<p> </p>
<b>D32'.</b> Najdi jména ètenáøù takových, že existuje kniha, kterou mají rezervovanou. <p> </p>
<pre>SELECT jmeno FROM Ctenar
  WHERE EXISTS (SELECT * FROM Rezervace 
                  WHERE cislo = Ctenar.cislo) </pre>
<p>Sémantika výrazu EXISTS (SELECT * ...) je následující: výraz se
vyhodnotí jako TRUE. je-li množina daná výrazem v závorkách neprázdná.
Vidíme, že v tomto pøípadì je konstrukt EXISTS redundantní, protože
dotaz lze D32' lze formulovat i pomocí IN. </p>
<p>Výraz s EXISTS lze také negovat pomocí NOT. Mìjme dotaz </p>
<b>D33.</b> Najdi èísla ètenáøù takových, že nemají rezervovánu žádnou knihu od B. Nìmcovì. <p> </p>
<p>V logice l.øádu odpovídá dotazu D33 dotaz s univerzálním
kvantifikátorem, který lze pøeformulovat s použitím negace existenèního
kvantifikátoru a negace následné podmínky. </p>
<p>V pøirozeném jazyku lze pak dotaz D33 vyjádøit následovnì: </p>
<b>D33'.</b> Najdi èísla ètenáøù taková, že neexistuje jimi rezervovaná kniha, která by byla od B.Nìmcové. <p> </p>
<b>D33.</b> 
<pre>SELECT cislo FROM Rezervace X 
  WHERE NOT EXISTS (SELECT * FROM Rezervace 
                      WHERE X.cislo = cislo 
                        AND isbn IN (SELECT isbn FROM Kniha
                                       WHERE autor ='Nìmcová B.')) </pre>
<p>Dotazem získáme ty ètenáøe, pro které platí, že množina jejich rezervací, které se netýkají knih B.Nìmcové, je prázdná. </p>
<p>Aplikujme nyní tuto transformaci výrazu s univerzálním
kvantifikátorem na výraz s negaci existenèního kvantifikátoru v dotazu
D31. V relaèním kalkulu obdržíme </p>
<pre>x.JMÉNO_K,x.MÌSTO where KNIHKUPEC(x) and not exists y <span style="font-size: 12pt; font-family: Symbol;">Î</span> KNIHOVNA 
                      (not exists z <span style="font-size: 12pt; font-family: Symbol;">Î</span> DODÁVÁ (z.JMÉNO_K=x.JMÉNO_K and 
                       z.NÁZEV_K=y.NÁZEV_K)) </pre>
<p>Tento výraz již lze transformovat do SQL. </p>
<b>D31.</b> 
<pre>SELECT DISTINCT X.jmeno_k, X.mesto 
     FROM Knihkupec X 
     WHERE NOT EXISTS (SELECT DISTINCT Y.* 
                       FROM Knihovna Y 
                       WHERE NOT EXISTS (SELECT DISTINCT Z.* 
                                         FROM Dodava Z 
                                         WHERE Z.jmeno_k=X.jmeno_k 
                                               AND Z.nazev_k=Y.nazev_k))  </pre>
<p>Lze si povšimnout pøímého vztahu mezi výrazem relaèního kalkulu </p>
<pre>exists y <span style="font-size: 12pt; font-family: Symbol;">Î</span> R (...) </pre>
<p> a výrazem v SQL </p>
<pre>EXISTS (SELECT DISTINCT Y.* FROM R Y WHERE ...) </pre>
<p>V prvním pøípadì výraz nabude hodnoty TRUE, jestliže existuje takový
øádek z R. že nastává (...), v druhém pøípadì nabude výraz hodnoty
TRUE, je-li výsledek vyhodnocení pøíkazu SELECT za EXISTS neprázdnou
množinou øádkù z R. Zøejmì TRUE nastane v kalkulu v tìch samých
pøípadech jako v SQL a naopak. Konstrukce jsou tedy ekvivalentní. </p>
<p>Dotaz D31 v SQL ještì upravíme tak, že odstraníme ve všech úrovních
SELECT bloku pøejmenování relací, protože není nutné. Stejné je to i s
vnitøními DISTINCT. Lepší je však zachovávat pravidlo "Použitím
DISTINCT nic nezkazíš". </p>
<pre>SELECT DISTINCT jmeno_k, mesto 
     FROM Knihkupec 
     WHERE NOT EXISTS (SELECT DISTINCT 
                       FROM Knihovna 
                       WHERE NOT EXISTS (SELECT DISTINCT 
                                          FROM Dodava 
                                          WHERE jmeno_k=jmeno_k 
                                                AND nazev_k=nazev_k)) </pre>
<p>Ještì je však tøeba upozornit na fakt, že uvedená transformace vede
k ekvivalenci vyjádøeni
v SQL a v relaèním kalkulu pouze tehdy, pohybujeme-li se na úrovni
dvouhodnotové logik.. EXISTS v SQL totiž není vždy ekvivalentní
implementaci existenèního kvantifikátoru. EXISTS dává FALSE i v
pøípadì, kdy množina za SELECT je prázdná a vznikla aplikací podmínek
na prázdné hodnoty, tj. podmínky byly vyhodnoceny jako NEDEF. </p>
<p>Ukážeme ještì dvì verze øešení dotazu D31, které by se nabízely, v
pøípadì, že by jazyk SQL. byl ortogonální. Jde o možnost použít
porovnání dvou množin, resp. porovnání mohutnosti dvou množin. Bohužel
ve stávajícím standardu SQL tyto konstrukce nelze použít. </p>
<p>Porovnání dvou množin vychází z pøedstavy, že množina všech knihoven
musí být stejná jako množina knihoven, do kterých dodává (z hlediska
dotazu zajímavý) knihkupec. </p>
<pre>SELECT DISTINCT jmeno_k, mesto FROM Knihkupec
  WHERE (SELECT DISTINCT nazev_k FROM Dodava 
           WHERE Knihkupec.jmeno_k=Dodava.jmeno_k ) 
         =
        (SELECT nazev_k FROM Knihovna) </pre>
<p>Z povahy problému však vyplývá, že dané dvì množiny jsou identické, mají-li stejný poèet prvkù. </p>
<pre>SELECT DISTINCT jmeno_k, mesto FROM Knihkupec  
  WHERE (SELECT COUNT(DISTINCT nazev_k) FROM Dodava 
           WHERE Knihkupec.jmeno_k=Dodava.jmeno_k ) 
         =
        (SELECT COUNT(DISTINCT nazev_k) FROM Knihovna) </pre>
<p>Závìrem diskuse dotazu D31 prozradíme ještì jedno øešení, které
standard dovoluje a které využívá konstruktu GROUP - BY - HAVING. </p>
<pre>SELECT DISTINCT jmeno_k, mesto FROM Knihkupec 
  WHERE jmeno_k IN (SELECT jmeno_k FROM Dodava 
  GROUP BY jmeno_k 
  HAVING COUNT(*) = (SELECT COUNT(*) FROM Knihovna ) ) </pre>
<p>Vybírají se takoví knihkupci, jejichž poèet knihoven, do kterých
dodávají, je týž jako poèet všech knihoven. Syntaxe je správná, protože
vlevo od = je výraz definující hodnotu a vpravo hnízdìný SELECT blok. </p>
<p>Ještì komplikovanìjší jsou ty dotazy, které se relaèním kalkulu
vyjadøují univerzálnì kvantifikovanou implikací. Pøíkladem mùže být
dotaz </p>
<b>D34.</b> Vyber knihkupce a jejich adresy, kteøí dodávají alespoò do
tìch knihoven jako knihkupec Èapek. Tento dotaz má v relaèním kalkulu
vyjádøení <p> </p>
<pre>x.JMÉNO_K, x.MÌSTO where KNIHKUPEC(x) and forall y <span style="font-size: 12pt; font-family: Symbol;">Î</span> KNIHOVNA 
                   (exists z <span style="font-size: 12pt; font-family: Symbol;">Î</span> DODÁVÁ(z.JMÉNO_K = `Èapek' and 
                                       z.NÁZEV_K = y.NÁZEV_K) implies <p></p>
                    exists t <span style="font-size: 12pt; font-family: Symbol;">Î</span> DODÁVÁ(t.JMÉNO_K =x.JMÉNO_K and 
                                       t.NÁZEV_K = y.NÁZEV_K) ) </pre>
<p>Teorie relaèního kalkulu má ovšem k dispozici transformaci implikace pomocí negace a disjunkce. </p>
<pre>(p implies q) = (not p) or (q) </pre>
<p>Je-li implikace univerzálnì kvantifikovaná, lze formulovat výslednou transformaci takto: </p>
<pre>forall x (p(x) implies q(x)) = not exists x not(not p(x) or q(x)) </pre>
<p>Aplikujeme-li tuto transformaci k dotazu D34, obdržíme v relaèním kalkulu </p>
<pre> x.JMÉNO_K, x.MÌSTO where x <span style="font-size: 12pt; font-family: Symbol;">Î</span> KNIHKUPEC and not exists y <span style="font-size: 12pt; font-family: Symbol;">Î</span> KNIHOVNA 
                    not(not exists z <span style="font-size: 12pt; font-family: Symbol;">Î</span> DODÁVÁ(z.JMÉNO_K = `Èapek' and 
                                               z.NÁZEV_K = y.NÁZEV_K)or 
                    exists t <span style="font-size: 12pt; font-family: Symbol;">Î</span> DODÁVÁ(t.JMÉNO_K = x.JMÉNO_K and 
                                       t.NÁZEV_K = y.NÁZEV_K)) </pre>
<p>Nyní již lze provést transformaci dotazu do SQL. </p>
<pre>SELECT DISTINCT X.jmeno_k, X.mesto FROM Knihkupec X 
  WHERE NOT EXISTS (SELECT DISTINCT Y.* FROM Knihovna Y 
                      WHERE NOT ( (NOT EXISTS (SELECT DISTINCT FROM Dodava Z
            				         WHERE Z.jmeno_k = `Èapek' AND Z.nazev_k = Y.nazev_k) 
                  			       		 OR (EXISTS SELECT DISTINCT FROM Dodava T 
   							              WHERE T.jmeno_k=X.jmeno_k AND T.nazev_k = Y.nazev_k) </pre>
<p>Výraz v SQL je možné uèinit ještì srozumitelnìjší. V logice se používají tzv. De Morganova pravidla. Platí </p>
<pre>(not (p or q) = (not p) and not (q) </pre>
<p>Mùžeme tedy odstranit dvì po sobì jdoucí NOT. Výsledkem je vyjádøení </p>
<pre>SELECT DISTINCT X.JMÉNO_K, X.MÉSTO FROM KNIHKUPEC X 
  WHERE NOT EXISTS (SELECT DISTINCT Y.* FROM Knohovna Y 
                      WHERE EXISTS (SELECT DISTINCT FROM Dodava Z 
                                      WHERE Z.jmeno_k = `Èapek' 
                                            AND Z.nazev_k = Y.nazev_k) 
                                            AND NOT EXISTS (SELECT DISTINCT FROM Dodava T 
                                                              WHERE T.jmeno_k -X.jmeno_k 
                                                                    AND T.nazev_k = Y.nazev_k)) </pre>
<p>V této verzi dotazu je vyjádøeno, že hledáme takové knihkupce, ke
kterým neexistuje
knihovna taková, že do ní dodává Èapek a souèasnì do ní tito knihkupci
nedodávají Samozøejmì, že v odpovìdi na dotaz D34 se objeví i Èapek
sám. Eliminaci tohoto prvku odpovìdi by bylo nutné provést explicitnì
zadáním podmínky jmeno_k&lt;&gt; `Èapek'. </p>
<p>Potencionálního uživatele mùže zaskoèit složitost formulace takových
dotazù. Komplikovanìjší dotazy je proto vhodné rozložit na poddotazy,
jejichž výsledky lze umístit do doèasných pomocných relací. Tyto relace
lze vytváøet pomocí CREATE TABLE. a jak uvidíme pozdìji, napø. pomocí
speciální formy pøíkazu INSERT. Samozøejmì, když takovou pomocnou
relaci již nepotøebujeme, lze ji zrušit pøíkazem DROP TABLE. Druhou
možností je vytvoøit vhodný pohled (VIEW) a na nìj aplikovat druhou
èást dotazu. </p>
<p>Oznaème jako NÌMCOVÁ pomocnou relaci pro výsledek nejhloubìji zahnízdìného poddotazu v D33'. Pak lze psát </p>
<b>D33'.</b> 
<pre>SELECT cislo FROM Rezervace X 
  WHERE NOT EXISTS (SELECT * FROM Rezervace 
                      WHERE X.cislo=cislo AND isbn IN NÌMCOVÁ)</pre>
<p> Pro test negativní informace lze využít i možnosti porovnání 0=COUNT(...). </p>
<b>D33".</b> 
<pre>SELECT cislo FROM Rezervace X 
  WHERE 0 = SELECT COUNT(*) FROM Rezervace 
              WHERE X.cislo = cislo AND isbn IN NÌMCOVÁ </pre>
<p>V nìkterých relaèních SØBD je možné i jiné, explicitní vyjádøení
univerzálního kvantifikátoru, a sice pomocí ALL, nebo pøevedením na
test vztahu "být podmnožinou''. tj. pomocí konstruktu CONTAINS. </p>
<p>Posledním dùležitým množinovým konstruktem je UNION, sjednocení
relací. Pøestože je souèástí standardu, ne všechny implementace SQL ho
obsahují. Za zmínku stojí, že UNION eliminuje duplikáty z výsledku. </p>
<b>D35.</b> Najdi èísla ètenáøù, kteøí mají pùjèenou nebo rezervovanou knihu do 31.12.1990 (nebo obojí).<p> </p>
<pre>SELECT cislo FROM Rezervace 
  WHERE d_rez &lt; ' 12/31 /90' 
UNION
SELECT cislo FROM Vypujcka 
  WHERE d_zpet &lt; ' 12/31 /90' </pre>
<p>Uživatelé si èasto myslí, že stejného efektu by dosáhli spojením obou relací pøes rovnost hodnot atributù <i>cislo</i> a disjunkcí podmínek s <i>d_rez</i> a <i>d_zpet</i>.
To ovšem není zcela pravda. nebo takto získáme pouze ty ètenáøe, kteøí
splòují to, že mají souèasnì nìco rezervována a nìco vypùjèeno. Výraz
za WHERE by nemìl obsahovat podmínku spojení. Z hlediska implementace,
tj. vyhodnocení dotazu, by ovšem efektivnìjší byla forma dotazu D35 s
použitím UNION. </p>
<p>V pùvodním Sequelu se nacházely také další množinové konstrukty -
INTERSECT a MINUS. Tyto však nejsou souèástí standardu SQL89 a jejich
použití lze obejít pomocí jiných konstruktù SQL (IN a NOT IN). </p>
<p>V rùzných dialektech SQL lze objevit další logické èi množinové
konstrukty, které ovšem nezvyšují sílu jazyka, tak jak byla podána zde.
</p>
<p>V závìru popisu prostøedkù SQL pro výbìr dat si ještì všimneme
nìkterých speciálních detailù - možnosti používání prázdných hodnot,
kolekcí a konstruktu LIKE, které pøesahuj í rámec RMD. </p>
<h2><a name="k5"></a>3.5 Používání prázdných hodnot </h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Prázdné hodnoty tvoøí dùležité rozšíøení RMD. Existence prázdné
hodnoty v SQL ovšem nutnì vede ke zmìnì sémantiky pùvodních možností
RMD. </p>
<p>Vyskytne-li se v aritmetickém výrazu hodnota NULL, je výsledek také
NULL. Pøi vyhodnocování aplikací porovnávacích operátorù platí, že
porovnává-li se pøitom s nìèím prázdná hodnota, je výsledek vždycky
NEDEF. Z toho plyne, že pøi spojení pøes rovnost se nikdy do výsledku
nespojí dvì n-tice, které mají ve spojovacím atributu prázdnou hodnotu.
Syntakticky je zakázáno používat prázdnou hodnotu NULL jako konstantu v
porovnáváni. tj. napø. <i>d_nakup </i>= NULL vede k syntaktické chybì. </p>
<p>Pro možnosti manipulace s prázdnými hodnotami je však k dispozici
speciální porovnávati operátor IS NULL. Pak lze realizovat dotaz </p>
<b>D36.</b> Vypiš inventární èísla exempláøù, které nebyly nakoupeny (ale získány nìjakým jiným zpùsobem).<p> </p>
<pre>SELECT id FROM Exemplar 
  WHERE d_nakup IS NULL </pre>
<p>Použití prázdných hodnot v kombinaci s prázdnými množinami mohou
provázet i nìkteré problémy. Uvažujme dotaz D30 a jeho vyjádøení pomocí
ALL. </p>
<pre>SELECT isbn FROM Exemplar
  WHERE cena &gt; ALL (SELECT Exemplar.cena FROM Exemplar
                      WHERE Exemplar.zeme_vydani = `GB') </pre>
<p>V této verzi dotazu se vybírají ty øádky relace EXEMPLAR , které mají hodnotu <i>cena</i>
vìtší než kteroukoli z cen exempláøù anglických knih v knihovnì. Je tak
vlastnì simulováno hledání maxima. Jestliže množina za ALL bude
prázdná, pak vnìjší porovnání ceny dává TRUE pro každou hodnotu ceny a
do odpovìdi se dostanou všechny ceny z relace EXEMPLAR . </p>
<p>Pøi použití funkce MAX ovšem dostaneme nìco jiného. </p>
<b>D30'.</b> 
<pre>SELECT isbn FROM Exemplar 
  WHERE cena &gt; (SELECT MAX(Exemplar.cena) FROM Exemplar
                  WHERE Exemplar.zeme_vydani = `GB') </pre>
<p>V SQL totiž MAX aplikovaná na prázdnou množinu dává hodnotu NULL a
porovnání s cenou nebude TRUS pro žádnou hodnotu ceny. V odpovìdi se
tedy neobjeví žádné <i>isbn</i>, tj. odpovìdí bude prázdná množina.</p>
<p> Také funkce MIN, SUM a AVG aplikované na prázdnou množinu dávají
vždy hodnotu NULL. Toto zøejmì není v souladu s bìžnou intuicí. Napø.
mìlo by platit </p>
<pre>SUM( SUM(), SUM(X)) = SUM(X) </pre>
<p>kde X je množina. Protože levou stranu lze redukovat na SUM() +
SUM(X), mìlo by být SUM() = 0. Podobnì MIN() by se mìlo vyhodnotit jako
-nekoneèno a MAX() jako
+nekoneèno . Naopak AVG() by mìlo být nedefinované, tj. spíše hlásit
chybu. </p>
<p>Funkce COUNT aplikovaná na prázdnou množinu dává v souladu s oèekáváním 0. </p>
<p>Ještì je nutné dodat, jak se chovají agregaèní funkce aplikované na
daný sloupec s použitím klauzule DISTINCT. Nejprve se eliminují prázdné
hodnoty (všechny), pak duplicitní hodnoty a poté se kalkuluje výsledek.
Jistá nesymetriènost øešení ale vznikne pøi použití COUNT(*), kdy nejde
použít DISTINCT a øádek prázdných hodnot je zapoèítáván do výsledku, a
to dokonce vícenásobnì podle poètu výskytù. Poèet prázdných hodnot
sloupce A v relaci R lze snadno zjistit dotazem </p>
<pre>SELECT COUNT(*) - COUNT(DISTINCT A) FROM R</pre>
<p>Výskyt prázdných množin vede také k tomu, že výrazy s IN a EXISTS intuitivnì ekvivalentu í se chovají jinak. Vyjdeme z dotazu </p>
<b>D37.</b> Najdi <i>isbn</i> knih, jejichž cena není rovna cenì žádné z knih z Velké Británie.<p> </p>
<pre>SELECT isbn FROM Exemplar
  WHERE cena NOT IN (SELECT Exemplar.cena FROM Exemplar
                       WHERE Exemplar.zeme_vydani = `GB')</pre>
<p>Zdánlivì ekvivalentní vyjádøení s EXISTS vede k výrazu</p>
<b>D37'.</b> 
<pre>SELECT isbn FROM exemplar X
  WHERE NOT EXISTS (SELECT Exemplar.* FROM Exemplar
                      WHERE Exemplar.zeme_vydani = `GB'
                            AND X.cena = Exemplar.cena)</pre>
<p>Pøedpokládejme, že existuje právì jedna britská kniha
a to s neznámou cenou. V první formulaci množina za NOT IN obsahuje pouze
NULL a tedy podmínka za vnìjším WHERE bude vyhodnocena jako nedefinovaná
pro každý exempláø. Odpovìdí bude prázdná množina. V druhém pøípadì
hnízdìný SELECT dává prázdnou množinu a odpovìdi budou tedy vyhovovat všechny
exempláøe, tj. i všechna <i>isbn</i>.</p>
<p>Pøi použití klauzule ORDER BY se prázdné hodnoty berou
jako menší než jakákoli jiná hodnota, napø. pøi vzestupném uspoøádání
se objeví na zaèátku výstupu.</p>
<p>Date uvádí v [DD92] poznámku obsahující ještì další
pozorování. Neexistují-li žádné britské knihy v knihovnì a existuje
exempláø jehož cenu neznáme, melo by se jeho <i>isbn</i> objevit ve výsledku. Jeho
cena je jistì jiná než jakákoli cena britské knihy v knihovnì. SØBD ORACLE
ovšem ve formulaci D37 nevybere takové <i>isbn</i> do odpovìdi.</p>
<h2><a name="k6"></a>3.6 Práce s kolekcemi v SQL</h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Pro práci s kolekcemi slouží nerelaèní operátory
SELECT ALL, UNION ALL. Dùsledkem jejich použití mohou vzniknout dost nepøirozené
jevy.</p>
<p>Uvažujme tøi relace R(A). S(A) a T(A,B) dané tabulkou 2</p>
<table align="center" border="0" cellpadding="10" cellspacing="0">
<caption align="top"><i>Tabulka 2 Relace R,S,T</i></caption>
  <tbody><tr align="center">
    <th colspan="2">a)</th>
    <th colspan="1"></th>
	<th colspan="2">b)</th>
    <th colspan="1"></th>
	<th colspan="3">c)</th>
  </tr>
  <tr align="center">
    <th bgcolor="Lime">R</th> 
	<th bgcolor="Lime">A</th> 
	<th></th>
	<th bgcolor="Lime">S</th> 
	<th bgcolor="Lime">A</th> 
	<th></th> 
	<th bgcolor="Lime">T</th>
	<th bgcolor="Lime">A</th> 
	<th bgcolor="Lime">C</th>
  </tr>
  <tr align="center">
    <td>&nbsp;</td> 
	<td>1</td> 
    <td></td> 
	<td>&nbsp;</td> 
    <td>1</td> 
	<td></td> 
    <td>&nbsp;</td> 
	<td>1</td> 
    <td>3</td> 
  </tr>
  <tr align="center">
    <td></td> 
	<td></td> 
    <td></td> 
	<td>&nbsp;</td> 
    <td>1</td> 
	<td></td> 
    <td>&nbsp;</td> 
	<td>1</td> 
    <td>4</td> 
  </tr>
  <tr align="center">
    <td></td> 
	<td></td> 
    <td></td> 
	<td></td> 
    <td></td> 
	<td></td> 
    <td>&nbsp;</td> 
	<td>0</td> 
    <td>6</td> 
  </tr>
  <tr align="center">
    <td></td> 
	<td></td> 
    <td></td> 
	<td></td> 
    <td></td> 
	<td></td> 
    <td>&nbsp;</td> 
	<td>4</td> 
    <td>1</td> 
  </tr>
</tbody></table>

<p>UNION ALL relací R a S dává relaci obsahující tøikrát
hodnotu 1. UNION ovšem eliminuje duplicity, takže napø. S UNION S dává R,
což je ponìkud absurdní. Nìco sjednoceno samo se sebou by melo dávat totéž!
Provedeme-li</p>
<pre>SELECT ALL S.A,T.C FROM S,T
  WHERE S.A = T.A</pre>
<p>pak obdržíme výsledek v tab. 3.</p>
<table align="center" border="0" cellpadding="15" cellspacing="0">
<caption align="top"><i>Tabulka 3 Relace Y</i></caption>
<tbody><tr bgcolor="Lime">
    <th colspan="1">Y</th>
	<th colspan="1">A</th> 
	<th colspan="1">C</th>   
</tr>
<tr>
	<td></td>
	<td>1</td>
	<td>3</td>
</tr>
<tr>
	<td></td>
	<td>1</td>
	<td>3</td>
</tr>
<tr>
	<td></td>
	<td>1</td>
	<td>4</td>
</tr>
<tr>
	<td></td>
	<td>1</td>
	<td>4</td>
</tr>
</tbody></table>  
<p>Provedeme-li následné projekce SELECT DISTINCT, resp. SELECT ALL na atribut A. obdržíme po øade výsledky v tab.4</p>
<table align="center" border="0" cellpadding="15" cellspacing="0">
<caption align="top"><i>Tabulka 4 Projekce relace Y</i></caption>
<tbody><tr>
    <th colspan="1" bgcolor="Lime">A</th>
	<th colspan="2"> </th> 
	<th colspan="1" bgcolor="Lime">A</th>   
</tr>
<tr>
	<td>1</td>
	<td> </td>
	<td> </td>
	<td>1</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td></td>
	<td>1</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td></td>
	<td>1</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td></td>
	<td>1</td>
</tr>
</tbody></table>  

<p>tj. žádnou vhodnou selekci relace S.</p>
<h2><a name="k7"></a>3.7 Práce s øetìzci znaku v SQL</h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Konstrukt LIKE umožòuje pracovat s podøetìzci hodnot atributu, které
jsou typu CHAR nebo VARCHAR. Podmínka použitelná ve výrazu za WHERE
(HAVING) má potom tvar</p>
<p><i>jméno-atributu LIKE øetìzcová-konstanta</i></p>
<p>Použitím LIKE lze pak dosáhnout napø. následujících selekcí relací:</p>
<dt><b>AUTOR LIKE `JI%'</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- získají se jména autoru libovolné délky zaèínající na JI</dt>
<dt><b>AUTOR LIKE `K-'</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- získají se dvoupísmenová jména autoru zaèínající na K</dt>
<dt><b>AUTOR LIKE `%d--'</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- získají se minimálnì tøípísmenová jména autoru se tøetím písmenem od konce rovným d</dt>
<dt><b>ADRESA LIKE `%PRAHA%'</b>&nbsp;&nbsp;&nbsp;- získají se adresy obsahující kdekoliv slovo PRAHA.</dt>

<h2><a name="k8"></a>3.8 Sémantika pøíkazu SELECT</h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Známe-li popsané konstrukty, je nutné vìdìt, v jakém poøadí se
vyhodnocují, objeví-li se v jednom dotazu. Speciálnì jde o pøípad
použití SELECT-FROM-WHERE bloku následovaného GROUP-BY-HAVING.</p>
<b>D38.</b> Vytvoø tabulku s èísly ètenáøù, jmény a poètem výpùjèek u
ètenáøù, kteøí mají vypùjèeno více než 5 exempláøù. Tabulka nech je
netøídìna sestupnì podle poctu výpùjèek a v rámci toho vzestupnì podle
jmen ètenáøù.<p></p>
<pre>SELECT cislo,jmeno,COUNT(id_v) FROM Vypujcka, Ctenar
  WHERE Vypujcka.cislo = ctenar.cislo
  GROUP BY Vypujcka.cislo
  HAVING COUNT(id_v) &gt; `5'
  ORDER BY 3 DESC,jmeno ASC</pre>
<p>Procedurální sémantika dotazu (pozor, to neznamená, že
skuteèný vyhodnocovací algoritmus takto pracuje) je dána následujícím
algoritmem:</p>
<ol>
<li>Vytvoøí se Vypujcka X ctenar.
</li><li>Vyhodnocením podmínky za WHERE se relace z kroku 1. zúží na spojení pres rovnost na atributech C_CT.
</li><li>Relace z kroku 2. se rozdìlí na podskupiny podle hodnot atributu <i>cislo</i>.
</li><li>Ze skupin kroku 3. se vyberou jen ty skupiny, kde poèet inventárních èísel je vetší než 5.
</li><li>Každá skupina z kroku 4. pøispívá do jednoho øádku výsledné relace.
</li><li>Relace z 5. je uspoøádána v souladu s ORDER BY. Protože tøetí sloupec výsledné relace nemá jméno, je atribut zadán èíslem.
</li></ol>
<h2><a name="k9"></a>3.9 Aktualizace v SQL </h2>
<a href="#k"><img src="kap3_soubory/toc.gif" alt="Obsah 3. kapitoly"></a>
<p>Aktualizaèní pøíkazy v SQL jsou INSERT, DELETE, UPDATE. Pøíkazy lze
použít pro aktualizaci jedné n-tice relace nebo pro množinu n-tic.</p>
<pre>INSERT
INTO Ctenar (cislo,jmeno)
VALUES (`Z20','NOVÁK P.')</pre>
<p>Protože seznam atributu za jménem relace CTENAR neobsahuje atribut <i>adresa</i>,
znamená to, že hodnota tohoto atributu bude pro vkládanou n-tici
prázdná. V pøípadì vložení kompletní n-tice není nutné seznam atributu
uvádìt.</p>
<p>Množinové orientovaný pøíkaz INSERT znamená uložit výsledek dotazu
do nìjaké tabulky. To znamená, že po prvním použití INSERT na prázdnou
tabulku lze takto simulovat pøiøazovací pøíkaz.</p>
<p>Chceme napø. vytvoøit relaci obsahující <i>isbn</i> a poèet vypùjèených knih.</p>
<pre>CREATE TABLE Kolik_ex
           (isbn CHAR(8), pocet SMALLINT)
INSERT
INTO TABLE Kolik_ex
     SELECT isbn, COUNT(id)
     FROM Exemplar
     GROUP BY isbn</pre>
<p>Z relace lze odstranit i více záznamu pomocí pøíkazu DELETE
formulací nìjaké podmínky. Není-li zadána žádná podmínka, lze tak
odstranit všechny øádky tabulky. (Tabulka se však nezruší, to umožòuje
pøíkaz DROP TABLE).</p>
<p>Odstranìní všech výpùjèek ètenáøe Z20 z relace VYPUJCKA se provede pøíkazem</p>
<pre>DELETE FROM Vypujcka
WHERE cislo = Z20</pre>
<p>Relace se modifikuje na jedné specifikované n-tici nebo
na množinì n-tic.</p>
<p>Zmìní-li se jméno ètenáøky Z10, modifikujeme je pøíkazem</p>
<pre>UPDATE Ctenar
SET jmeno = nové jméno
WHERE cislo = `Z10'</pre>
<p class="BEZ">kde "nové jméno" je výraz (zde konstanta) dávající
nové jméno. Výraz muže být obecnì dán pomocí aritmetických operací. Podmínka za WHERE opìt muže specifikovat
libovolnou selekci relace urèené za UPDATE. Aktualizace specifikovaná za SET
se provede na všech takto specifikovaných n-ticích.</p>
<hr color="Blue" size="1">
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap2.html"><img src="kap3_soubory/prev.gif" alt="2. Definice dat v SQL" align="left"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap4.html"><img src="kap3_soubory/next.gif" alt="4. Systémový katalog" align="left"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/index.html"><img src="kap3_soubory/toc.gif" alt="Obsah" align="left"></a>
    
</body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs"><head>



<meta name="generator" content="PPWIZARD version 99.231 on OS/2, FREE tool for OS/2, Windows, DOS and UNIX by Dennis Bareis (http://www.labyrinth.net.au/~dbareis/ppwizard.htm)">

<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
<meta http-equiv="Content-language" content="cs">
<meta http-equiv="expires" content="1">
<meta http-equiv="pragma" content="no-cache">
<meta name="author" content="Lukáš Oborskı">
<meta name="copyright" content="PROKOP software s.r.o. - specialista na internet a WWW">
<meta name="robots" content="ALL,FOLLOW"><title>Mod_rewrite pro lepší odkazy</title>

<meta name="keywords" content="bookmarklet,bookmarklety,favelet,favelety,javascript">
<meta name="description" content="V tomto èlánku se dozvíte, co je to mod_rewrite a jak pomocí nìj mùete vylepšit odkazy na vaší webové stránce tak, aby byly srozumitelnìjší pro návštìvníky a vstøícnìjší k vyhledavaèùm.">
<meta name="icbm" content="49.98743, 14.67578">
<meta name="dc.title" content="Sova v síti">
<meta name="dc.language" content="cs">
<meta name="geo.country" content="CZ">
<link rel="start" href="http://www.sovavsiti.cz/">
<style media="all" type="text/css">@import "../css2.css";</style>
<script src="mod_rewrite_soubory/master.js" type="text/javascript"></script></head><body id="sovavsiti-cz">
<p class="reader"><a href="#top">Pøeskoè navigaci</a></p>
<div id="page">
<!-- Header begins -->
<div id="header">
<a href="http://www.sovavsiti.cz/"><img src="mod_rewrite_soubory/head2.gif" id="toplogo" alt="Sova v síti"></a>
<div id="htitle">Sova&nbsp;v&nbsp;síti</div>
<div id="hsubtitle">Èlánky, rady a novinky pro webmastery, webdesignéry a informaèní architekty</div>
</div>
<div id="headerline"></div>
<div id="topmenu">
<ul>
<li><a href="http://www.sovavsiti.cz/" title="Úvodní stránka Sovy v síti">Úvod</a></li>
<li><a href="http://www.sovavsiti.cz/weblog/" title="Novinky a aktuální odkazy pro webmastery, webdesignéry a majitele webovıch stránek.">Weblog</a></li>
<li><a href="http://www.sovavsiti.cz/archiv.html" title="Archiv èlánkù a starších vydání Sovy v síti">Archiv</a></li>
<li><a href="http://www.sovavsiti.cz/reg.html" title="Jak si pøihlásit a odhlásit odbìr Sovy v síti">Registrace</a></li>
<li><a href="http://www.sovavsiti.cz/nastroje/" title="Nástroje pro webmastery, webdesignéry a majitele webovıch stránek.">Nástroje</a></li>
<li><a href="http://www.sovavsiti.cz/odkazy.html" title="Uiteèné odkazy pro webmastery">Odkazy</a></li>
<li><a href="http://www.sovavsiti.cz/sluzby.html" title="Nabídka bezplatnıch i placenıch slueb pro webmastery">Sluby</a></li>
<li><a href="http://www.sovavsiti.cz/spoluprace.html" title="Autorská spolupráce, vımìna odkazù, reklama v Sovì, atd.">Spolupráce</a></li>
</ul>
<form method="get" action="http://jyxo.cz/search.php" id="search">
<div>
<input name="look" value="sova" type="hidden">
<input name="stem" value="on" type="hidden">
<label for="sstr"><strong>Hledej:</strong></label>
<input name="s" size="15" id="sstr" class="inputfield" type="text">
<fieldset>
<legend>Kde hledat</legend>
<div><input name="d" value="cz@sovavsiti.cz" id="searchinsova" checked="checked" type="radio"> <label for="searchinsova">v Sovì</label></div>
<div><input name="d" value="cz" id="searchincz" type="radio"> <label for="searchincz">všude</label></div>
</fieldset>
<input value="Hledej" class="button" type="submit">
</div>
</form>
<p>Zde hledá <a href="http://jyxo.cz/">Jyxo</a>.</p>
<div class="centered"><a href="http://jyxo.cz/"><img src="mod_rewrite_soubory/jyxo.gif" alt="Jyxo"></a></div>
</div>
<div id="maincontent">
<h1><a name="top"></a>Mod_rewrite pro lepší odkazy</h1>
<p><small>Lukáš Oborskı, vydáno/aktualizováno: 21.7.2003/02.08.2003</small></p>
<div class="articlecontent"><p>V tomto èlánku se dozvíte, co je to
mod_rewrite a&nbsp;jak pomocí nìj mùete vylepšit odkazy na vaší webové
stránce tak, aby byly srozumitelnìjší pro návštìvníky
a&nbsp;vstøícnìjší k&nbsp;vyhledavaèùm.</p> <p>Jedním z nejpouívanìjších webovıch serverù je <a href="http://www.apache.org/">Apache</a>. Je napsán s&nbsp;dùrazem na otevøenost, co umoòuje pøidávat rozšiøující funkce neboli krátce moduly. <a href="http://modules.apache.org/">Modulù pro Apache</a>
je celá øada, nás však dnes bude zajímat pouze jedinı&nbsp;-
mod_rewrite. Umí jen jednu vìc, ale zato geniálnì&nbsp;- pøekládat
adresy. Èíhá na serveru na kadou poadovanou stránku, zkontroluje její
adresu podle seznamu svıch pravidel a&nbsp;pokud poadovaná adresa
v&nbsp;seznamu je, aplikuje na ni konkrétní pøepisovací pravidlo.</p> <h2>Proè pouívat mod_rewrite</h2> <p>Ne vám povím, jak se mod_rewrite aktivuje a&nbsp;konfiguruje, krátce zmíním, s&nbsp;jakımi typickımi problémy vám mùe pomoci.</p> <ul> <li>Vaše stránky se pøesunuly na nové adresy a&nbsp;vy na nì chcete návštìvníky pøesmìrovat.</li> <li>Vaše
stránky mají pøíliš sloité adresy. Nelze si je zapamatovat, špatnì se
posílají emailem, nevyjadøují obsah stránky, ani strukturu webu.</li> <li>Dynamické stránky obsahují v&nbsp;adresách parametry a&nbsp;vyhledavaèe je neochotnì indexují.</li> <li>Chcete, aby adresy stránek byly nezávislé na pouité technologii a&nbsp;potøebujete se tedy zbavit koncovek html, php, apod.</li> </ul> <h2>Praktickı pøíklad pouití mod_rewrite</h2> <p>Konkrétní
pøíklad je desetkrát lepší ne obecné povídání. Proto vám ukáu, jak
jsem dva typické problémy øešil pomocí mod_rewrite pøímo na našem
weblogu <a href="http://weblog.oborsky.cz/">Letem svìtem</a>.</p> <h3>Jak mod_rewrite aktivovat</h3> <p>Nejprve
si ale musíme ukázat, jak se podpora mod_rewrite vùbec zapíná.
V&nbsp;pøíslušném adresáøi, pro kterı se mají pravidla uplatòovat,
vytvoøte soubor .htaccess a&nbsp;do nìj vlote následující øádku:</p> <code>RewriteEngine on</code> <p>Od
té chvíle bude pro danı adresáø mod_rewrite aktivní. Zatím ale nic
nedìlá, protoe ještì nejsou vytvoøena ádná pravidla. Nue pojïme se
podívat, jaké problémy vyøešíme.</p> <h3>Pøesun stránek do domény tøetího øádu</h3> <p>Prvním
problémem weblogu byla zdvojená adresa. Pùvodnì weblog sídlil na adrese
www.oborsky.cz/weblog, ale pozdìji jsem z&nbsp;adresáøe weblog udìlal
doménu tøetí úrovnì, take nová adresa je weblog.oborsky.cz. Jak jsem
ale zjistil ze statistik, pøes novou adresu stále chodilo ménì lidí ne
pøes starou. To by ani tak nevadilo, protoe obì byly funkèní, ale
Google trpìl schizofrenií a&nbsp;rozdìloval svùj PageRank mezi obì
pøístupové cesty.</p> <p>Po pár dnech pøemıšlení mne napadlo, e
nejlepší by bylo na staré adrese vracet návratovı kód HTTP 301, kterı
signalizuje trvale pøesunuté stránky a zároveò automaticky pøesmìruje
na novou adresu. Tomu rozumí i&nbsp;Google a&nbsp;mìl by oba PageRanky
seèíst. Jak ale podstrèit kód 301 v&nbsp;pøípadì pøístupu pøes starou
adresu, kdy vše leelo stále v&nbsp;jednom adresáøi? Snadno,
vloíme-li do .htaccess následující dvì øádky:</p> <code class="codesample"> </code><div>RewriteCond&nbsp; %{HTTP_HOST}&nbsp; ^www\.oborsky\.cz</div> <div>RewriteRule&nbsp; ^index\.php$&nbsp; http://weblog.oborsky.cz/index.php [L,R=301,QSA]</div>  <p>Co ty dvì øádky znamenají? První, <code>RewriteCond</code>,
urèuje, za jakıch podmínek se má pravidlo aplikovat. V&nbsp;tomto
pøípadì soubor .htaccess leí v&nbsp;adresáøi weblog a&nbsp;proto se
pouije pouze v&nbsp;pøípadì, e do tohoto adresáøe míøí poadavek
návštìvníka. Prvním øádkem urèíme, e následující pravidlo se pouije
pouze, kdy adresa bude zaèínat www.oborsky.cz. Pùjdeme-li na weblog
novou cestou, pøes weblog.oborsky.cz, pravidlo se neaplikuje.</p> <p>Obsahem
druhého øádku je samotné pravidlo pøepisu adresy. První èást obsahuje
standardní vstupní stránku weblogu, index.php. Pro zápis je pouito
regulárních vırazù, pokud s&nbsp;nimi nejste úplní kamarádi, nastudujte
patøiènou literaturu (napø. <a href="http://www.root.cz/clanek/1490">Regulární vırazy v&nbsp;pøíkladech</a> od <cite>Lukáše Zapletala</cite> na <cite>Root.cz</cite>). Druhá èást pravidla obsahuje cílovou podobu adresy, v&nbsp;našem pøípadì tu samou stránku zpøístupnìnou pøes novou adresu.</p> <p>Následují parametry pravidla v&nbsp;hranatıch závorkách. <code>L</code>&nbsp;znamená, e pravidla nehodláme øetìzit, <code>R</code>&nbsp;indikuje fyzické pøesmìrování vèetnì pøíslušného návratového kódu HTTP. Skupina <code>QSA</code>
pak øíká, e pøípadné pøedávané promìnné (tedy vše za otazníkem
v&nbsp;adrese stránky) mají bıt do cílové adresy vloeny taky.
Vyzkoušíme, prima, funguje to.</p> <h3>Jak udìlat z dynamické adresy statickou</h3> <p>Druhı
problém, kterı jsem øešil, byl snaší. Nelíbily se mi toti adresy
jednotlivıch spotù weblogu. Adresa vypadala napø. takto:</p> <code>http://weblog.oborsky.cz/index.php?p=1234567&amp;c=1</code> <p>Ukái
vám, jak pomocí jednoduchého pravidla mod_rewrite vytvoøíte nové
odkazy, které budou mít mnohem pøívìtivìjší podobu, tøeba tuto:</p> <code>http://weblog.oborsky.cz/spot1234567.html</code> <p>Kromì
toho, e je druhá adresa srozumitelnìjší a&nbsp;vyhledavaèe ji radìji
a&nbsp;èastìji indexují, hovoøí pro ni ještì jeden dùvod. Weblog je
nyní zaloen na PHP. Ale pokud nìkdy v&nbsp;budoucnu pøejdu na jinı
systém, tøeba .NET, zmìní se adresa stránky na index.aspx
a&nbsp;veškeré odkazy z&nbsp;jinıch serverù pøijdou vniveè. Pokud ale
budu skuteènou adresu maskovat pod virtuální html stránku, odkazy budou
fungovat vdy a&nbsp;všude.</p> <p>Jak bude tedy pravidlo vypadat?</p> <code class="codesample"> </code><div>RewriteCond&nbsp; %{HTTP_HOST}&nbsp; ^weblog\.oborsky\.cz</div> <div>RewriteRule&nbsp; ^spot(.*)\.html$&nbsp; http://weblog.oborsky.cz/index.php?p=$1&amp;c=1 [L,QSA]</div>  <p>První
øádek je vám u z&nbsp;pøedchozího pøípadu jasnı. Co øíká ten druhı?
Pokud nìkdo poaduje stránku na adrese zaèínající písmeny <kbd>spot</kbd> s&nbsp;koncovkou <kbd>html</kbd>, má se mu místo toho podstrèit adresa vedoucí na skuteènı èlánek. Díky tomuto pravidlu nemusí stránky s&nbsp;pøíponou <kbd>html</kbd> vùbec existovat! Mod_rewrite toti pøemìní adresu døív, ne Apache zaène zjišovat, zda stránka existuje.</p> <p>Vidíme také, e z hranatıch závorek vypadlo písmeno <code>R</code>
pro pøesmìrování. To zpùsobí, e místo klasického pøesmìrování se
browseru pouze podsune obsah cílové stránky, ani by se na ni skuteènì
pøešlo. V&nbsp;adresním øádku prohlíeèe proto nadále uvidíte <code>spot1234567.html</code>.</p> <p>Na
dvou praktickıch pøíkladech jsem vám ukázal, k&nbsp;èemu mùete
mod_rewrite pouít. Samozøejmì není moné celou problematiku probrat na
pár øádcích. Proto berte tento text spíše jako motivaci k&nbsp;dalšímu
samostudiu. Pro zaèátek nabízím vıbornı dvojdílnı seriál <a href="http://www.root.cz/clanek/542">Co si tak trochu zapøepisovat?</a> od <cite>Michala Krause</cite>, kterı vyšel pøed dvìma lety v&nbsp;<cite>Root.cz</cite>. Kupodivu se dodnes jinı èlánek v&nbsp;èeštinì k dané tématice neobjevil.</p> <p>Pøeji
vám úspìšné bádání a&nbsp;hodnì štìstí pøi pøepisování. V&nbsp;pøípadì
jakıchkoliv dotazù k&nbsp;tématu mì mùete kontaktovat emailem nebo na
ICQ 45441092. Viva mod_rewrite.</p> <h3>Odkazy</h3> <ul> <li><a href="http://httpd.apache.org/docs/mod/mod_rewrite.html">Mod-rewrite v dokumentaci Apache&nbsp;1.x</a></li> <li><a href="http://httpd.apache.org/docs-2.0/mod/mod_rewrite.html">Mod-rewrite v dokumentaci Apache&nbsp;2.x</a></li> <li><a href="http://httpd.apache.org/docs/misc/rewriteguide.html">Prùvodce k pøepisování URL</a></li> <li><a href="http://httpd.apache.org/docs/mod/mod_alias.html">Dokumentace souvisejícího modulu mod_alias</a></li> <li><a href="http://www.jakpsatweb.cz/server/mod-rewrite.html">Praktickı návod na mod_rewrite od Dušana Janovského</a></li> <li><a href="http://google.com/search?q=url+rewriting+iis">Pøepisování URL pro Windows IIS</a> (via Google)</li> </ul> © 2003 Lukáš Oborskı, <a href="mailto:lukas@oborsky.cz">lukas@oborsky.cz</a> <h3>Poznámky Sovy v síti</h3> <ol> <li>V
èlánku popsanı postup pøedpokládá, e máte na serveru k&nbsp;dispozici
mod_rewrite monost mìnit nastavení Apache pøes .htaccess.
V&nbsp;pøípadì sdíleného hostingu tomu tak bıt nemusí.</li> <li>V uvedeném postupu není ošetøen pøípad, kdy uivatel zadá URL bez úvodního www (tj. napø. jen oborsky.cz).</li> </ol> <hr> <h3>O autorovi</h3> <p>Lukáš Oborskı, alias Lukin, je zakladatelem a&nbsp;hlavním pøispìvatelem weblogu <a href="http://weblog.oborsky.cz/">Letem svìtem</a>, ve kterém dennì naleznete uiteèné rady, odkazy a&nbsp;aktuality tıkající se webdesignu a&nbsp;tvorby webovıch stránek.</p></div>
</div>
<div id="sidebar">
<div class="sidebox">
<h2><a name="regform">Registrace zdarma</a></h2>
<p>Líbí se vám tento èlánek? Zajistìte si odbìr Sovy v síti zdarma pøímo do vaší emailové schránky.</p>
<form action="http://www.prokopsw.cz/app/nl/subscribe.asp" method="post" onsubmit="return checkSubscribeForm(this)">
<div><input name="txtNlId" value="2" type="hidden"></div>
<p><label for="txtEamil">Váš email:</label></p>
<p><input id="txtEamil" name="txtEmail" value="Váš@email" size="10" class="inputfield" onfocus="this.select();" type="text"></p>
<p><input name="cmdSubscribe" value="Zaregistrovat" class="button" type="submit"></p>
</form>
<p><a href="http://www.sovavsiti.cz/reg.html">Další informace...</a></p>
</div>
<div class="sidebox">
<h2>Diskuse, komentáøe</h2>
<p>Chcete se vyjádøit k tomuto èlánku? Zajímají nás vaše názory. <a href="http://www.sovavsiti.cz/feedback.html">Napište nám</a>!</p>
</div>
<div class="sidebox">
<h2>Doporuète èlánek</h2>
<p>Líbí se vám tento èlánek? Je pro vás náš e-zin uiteènı? <a href="http://www.sovavsiti.cz/recommend.html">Doporuète Sovu pøátelùm</a>!</p>
</div>
<div class="centered">
<img src="mod_rewrite_soubory/a.gif" alt="" height="1" width="1">
<iframe src="mod_rewrite_soubory/code.htm" marginwidth="0" marginheight="0" style="border-style: none;" frameborder="0" height="1" scrolling="no" width="1"></iframe>
<!-- Google Analytics start -->
<script src="mod_rewrite_soubory/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1129578-1";
urchinTracker();
</script>
<!-- Google Analytics end -->
<p><a href="http://www.toplist.cz/cgi-bin/toplist.asp?kat=32"><img src="mod_rewrite_soubory/count.gif" alt="TOPlist" style="border: 0pt none ;" height="60" width="88"></a></p>
<p>Ctíme standardy <a href="http://www.w3c.org/">W3C</a>:</p>
<div class="w3cb"><a href="http://validator.w3.org/check/referer"><span class="w3c">W3C</span> <span class="spec">XHTML 1.0</span></a></div>
<div class="w3cb"><a href="http://jigsaw.w3.org/css-validator/check/referer"><span class="w3c">W3C</span> <span class="spec">CSS</span></a></div>
<p>Nemáte cestu kolem? <a class="geourl" href="http://geourl.org/near/?p=http://www.sovavsiti.cz/weblog/" title="Sousedé v okolí">GeoURL</a></p>
</div>
</div>
<ul id="bottommenu">
<li><a href="#top"><img src="mod_rewrite_soubory/au.gif" alt="Zaèátek stránky" class="arrow" title="Zpìt na zaèátek stránky"></a></li>
</ul>
<!-- Footer begins -->
<div id="footer">
Sovu v síti vydává Marek Prokop za pøispìní spol.&nbsp;<a href="http://www.prokopsw.cz/">PROKOP software</a>. Email:&nbsp;<a href="mailto:redakce@sovavsiti.cz">redakce@sovavsiti.cz</a>, ISSN&nbsp;1213-9076,
<a class="xmlbutton" href="http://www.sovavsiti.cz/weblog/index.rss" type="application/rss+xml" title="RDF (Resource Description Framework) Site Sumary kanál weblogu Sovy v síti">&nbsp;RSS&nbsp;</a>
</div>
<!-- Footer ends -->
</div>
<p class="nostyle">Tato stránka je pøístupná <strong>libovolnım prohlíeèem</strong>,
nejlépe však vypadá v prohlíeèi, kterı podporuje HTML&nbsp;4.0
a&nbsp;CSS&nbsp;2 (Internet Explorer od verze&nbsp;5, Mozilla, Opera
a&nbsp;další). Pokud ètete tuto zprávu, váš prohlíeè zøejmì dostateènì
nepodporuje CSS. Stránku sice vidíte bez pokroèilejšího formátování,
avšak veškerı <strong>obsah je plnì pøístupnı</strong> i&nbsp;pro vás.</p>
<script type="text/javascript">
<!--
document.write("<img src=\"http://www.prokopsw.cz/app/log/alog.asp?id=sovavs&amp;r=" + escape(top.document.referrer) + "\" width=\"1\" height=\"1\" border=\"0\" alt=\"\">");
//-->
</script><img src="mod_rewrite_soubory/alog.htm" alt="" border="0" height="1" width="1">
<noscript><div><img src="http://www.prokopsw.cz/app/log/alog.asp?id=sovavs" width="1" height="1" alt="" /></div></noscript>
<script src="mod_rewrite_soubory/code.js" type="text/javascript"></script><a href="http://navrcholu.cz/Statistika/50/"><img src="mod_rewrite_soubory/hit.gif" alt="" style="border: medium none ;" height="1" width="1"></a>
<noscript><div><img
src="http://c1.navrcholu.cz/hit?site=50;flver=-1;jsup=-1;csup=-1;ref=;cdepth=-1;screenx=-1;winx=-1;jssup=0"
width="1" height="1" alt="" /></div></noscript>
<div style="position: absolute; left: 0px; top: 0px; z-index: 1000000000; visibility: hidden; opacity: 1;" id="linkalert-box"><img src="mod_rewrite_soubory/none-icon.png" id="linkalert-icon-1"></div></body></html>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1250"><title>2. Definice dat v SQL</title>


	
	<link rel="STYLESHEET" type="text/css" href="kap2_soubory/main.css">
	<style type="text/css"><!--:hover { font-weight: bold;         color: red }
--></style></head><body alink="Blue" background="kap2_soubory/pozadi.jpg" vlink="Blue">
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap1.html"><img src="kap2_soubory/prev.gif" alt="1. Úvod do SQL"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap3.html"><img src="kap2_soubory/next.gif" alt="3. Manipulace dat v SQL"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/index.html"><img src="kap2_soubory/toc.gif" alt="Obsah"></a>
<hr color="Blue" size="1">
<h1>2. Definice dat v SQL</h1>
<p>Jazyk DDL obsahuje klíèová slova pro definici, modifikaci a rušení
typu entity i typu vazby. Dále obsahuje seznam datovıch typù a datovıch
struktur pro definici typu atributu. </p>
<center><h3>Pøehled klíèovıch slov DDL</h3></center>
<table align="center" border="1" cellpadding="1" cellspacing="1">
  <tbody>
  <tr bgcolor="Lime">
    <th>SQL</th>
    <th>vıznam</th>
  </tr>
  <tr>
    <td>ADD</td>
    <td>pøidej</td>
  </tr>
  <tr>
    <td>AND</td>
    <td>a</td>
  </tr>
  <tr>
    <td>ALTER</td>
    <td>obmìò</td>
  </tr>
  <tr>
    <td>BETWEEN</td>
    <td>mezi</td>
  </tr>
  <tr>
    <td>CHAR</td>
    <td>znakovı øetìzec</td>
  </tr>
  <tr>
    <td>CHECK</td>
    <td>ovìø, zda</td>
  </tr>
  <tr>
    <td>COLUMN</td>
    <td>sloupec</td>
  </tr>
  <tr>
    <td>CREATE</td>
    <td>vytvoø</td>
  </tr>
  <tr>
    <td>DATE</td>
    <td>datum</td>
  </tr>
  <tr>
    <td>DROP</td>
    <td>zruš</td>
  </tr>
  <tr>
    <td>IN</td>
    <td>je prvkem mnoiny</td>
  </tr>
  <tr>
    <td>INDEX</td>
    <td>indexovı soubor</td>
  </tr>
  <tr>
    <td>INTEGER</td>
    <td>celé èíslo</td>
  </tr>
  <tr>
    <td>LOGICAL</td>
    <td>logická hodnota</td>
  </tr>
  <tr>
    <td>NOT</td>
    <td>ne</td>
  </tr>
  <tr>
    <td>NULL</td>
    <td>nic (prázdnota)</td>
  </tr>
  <tr>
    <td>REAL</td>
    <td>reálné èíslo</td>
  </tr>
  <tr>
    <td>RENAME</td>
    <td>pøejmenování</td>
  </tr>
  <tr>
    <td>TABLE</td>
    <td>tabulka</td>
  </tr>
  <tr>
    <td>UNIQUE</td>
    <td>unikátní (jedineènı)</td>
  </tr>
</tbody></table>
<p class="BEZ"><i>DDL - <b>D</b>ata <b>D</b>efinition <b>L</b>anguage</i></p>
<font color="Fuchsia"><dt>Pro následující pøíklady platí tyto pravidla :</dt></font>
<ul type="disc">
<li><font color="Fuchsia">klíèová slova velkım tiskacím pø. <b>SELECT </b></font>
</li><li><font color="Fuchsia">názvy tabulek mají první znak velkım ostatní malım písmem pø. <b>Kniha</b> </font>
</li><li><font color="Fuchsia">názvy atributù jsou psány malım písmem pø. <b>cena</b></font>
</li></ul>

<br> 
<p>Schéma je autorizováno pøíkazem</p>  
<pre>CREATE SCHEMA AUTHORIZATION c-identifikátor</pre> 
<p>kde c-identifikátor je jméno jednoznaènì identifikující schéma
databáze. Uivatelská databáze mùe bıt (na rozdíl od bìnıch konvencí)
formována více databázovımi schématy. </p>
<p>Deklarací napø. </p>
<pre>CREATE SCHEMA AUTHORIZATION Knihovna</pre> 
<p>lze název KNIHOVNA pouít v teèkové notaci pro odkazy na tabulky
nebo pohledy ze schématu.
Deklarace relaèního datového typu ve své jednoduchostí (jde o relace v
1.NF) odpovídá popisu obyèejné dvourozmìrné tabulky s oznaèenımi
sloupci. </p>
<p class="BEZ"><i>Poznámka:</i> Pøipomeòme zde, e øada systémù SQL
"umí" pracovat i s relacemi, které porušují 1.NF v tom. e dovolují
vícehodnotové atributy. Jde o pøípad, kdy relace není definována pomocí
SQL. Systém si s ní poradí tak, e ji pøed pouitím jakoby doèasnì
normalizuje do 1.NF. </p>
<p>Pro práci se schématy základních relací jsou nejèastìji k dispozici
tøi pøíkazy - CREATE TABLE, ALTER TABLE, DROP TABLE, které po øadì
vedou k vytvoøení, zmìnì a zrušení relace. </p>
<p>Pro relace lze definovat index pøíkazem CREATE INDEX. Pøíkazùm pro
definici virtuálních relací (pohledù) je vìnována zvláštní kapitola. </p>
<p>SQL umoòuje definovat nìkteré uiteèné typy atributù (délky èísel platí pro DB2, obecnì závisí na pouitém hardware). </p>
<p>
</p><dt><b>INTEGER</b> celé èíslo se znaménkem ve 4 bytech,</dt>
<dt><b>SMALLINT</b> celé èíslo se znaménkem ve 2 bytech,</dt> 
<dt><b>DECIMAL(p,q)</b> pakované dekadické èíslo s p ciframi, (p
&lt;=15), a pøedpokládanou desetinnou èárkou q cifer zprava (0=&lt; q
&lt; p). Je-li q = 0, vynechává se.</dt> 
<dt><b>FLOAT</b> reálné èíslo se znaménkem v 8 bytech (mantisa je
tvoøena 14 hexadecimálními èíslicemi, obecnì je typ parametrizován
poadovanou pøesností),</dt> 
<dt><b>CHAR(n)</b> øetìzec znakù délky n,</dt> 
<dt><b>VARCHAR(n)</b> øetìzec znakù maximální délky n. </dt><p></p>
<p>Ve standardu jsou ještì <b>NUMERIC, REAL, DOUBLE PRECISION</b>.
Kromì tìchto typù dat se pouívají i další (nestandardní), jako napø.
MONEY, DATE apod. Budeme-li pouívat konstanty typu DATE, budou ve
tvaru známém z INFORMIXu, tj. mm/dd/rr. Øetìzce znakù i konstanty typu
DATE budeme uzavírat do závorek '´ . </p>
<p>Pomocí NOT NULL se indikuje neprázdnost hodnoty definovaného
atributu pro kadou n-tici dané relace. V opaèném pøípadì mohou bıt
hodnoty prázdné (skuteèné nuly èi mezery nejsou prázdné hodnoty). Ty,
jak víme, se sice v pùvodní verzi RMD nevyskytují, nicménì pro praxi
jsou velmi uiteèné - interpretují se jako neznámé nebo nedefinované
hodnoty. Specifikace NOT NULL je zvláš vhodná pro simulaci primárního
klíèe, kterı v nìkterıch implementacích není pøímo podporován. </p>
<p>Jednoznaèné hodnoty atributu lze definovat kvalifikací jeho datového typu oznaèovanou UNIQUE. </p>
<p>Podle definice RMD ani zde definice relace nepøedpokládá ádné
uspoøádání n-tic relace. V SQL lze uspoøádání pøedepsat pouze pro
vıstup relace získané jako vısledek nìjakého dotazu. </p>
<p>Relaci lze definovat pøíkazem </p>
<pre>CREATE TABLE [c-identifikátor]jméno-relace 
             (jméno-atrl typ-atrl [NOT NULL [UNIQUE]] 
             [,jméno-atr2 typ-atr2 [NOT NULL [UNIQUE]]]... 
             [,UNIQUE seznam-atr])</pre> 
<p>kde [ ] znaèí 0¸I vıskytù, ... znaèí opakování 0 nebo vícekrát pøedchozí syntaktické jednotky.
Jméno relace mùe bıt rozšíøeno o pøedponu autorizace, tj. vlastnì jméno schématu (nebo
vlastníka schématu). Skupina atributù mùe bıt definovaná globálnì jako jednoznaèná zadáním
UNIQUE (supluje èásteènì pojem primárního klíèe). </p>
<p>Pro relaci VİPÙJÈKA lze pøíkaz CREATE TABLE pouít takto: </p>
<pre>CREATE TABLE Vypujcka
     (id_v CHAR(3) NOT NULL, 
     cislo CHAR(3) NOT NULL, 
     d_zpet CHAR(6))</pre> 
<p>Po vyvolání tohoto pøíkazu se vytvoøí prázdná relace VYPUJCKA a
schéma relace se zaznamená do systémového katalogu. Vlastní data se do
relace vkládají pomocí pøíkazu INSERT (po jedné n-tici) nebo nìjakım
hromadnì orientovanım zpùsobem (v závislosti na daném SØBD). </p>
<p>Definovat lokálnì atribut jako jednoznaènı znamená vlastnì definovat klíè relace. To se však
obvykle oproti standardu v øadì systémù zajišuje ne pomocí UNIQUE v definici atributu.
ale pomocí CREATE UNIQUE INDEX (viz dále).</p> 
<p>Ji vytvoøenou relaci mùeme zmìnit pøíkazem ALTER. Chceme-li napø. v relaci ÈTENÁØ
sledovat i jeho prioritu, lze odpovídající zmìny schématu relace docílit pøíkazem </p>
<pre>ALTER TABLE Ctenar ADD COLUMN priorita NUMERIC</pre> 
<p>Fyzicky se ovšem neprovede ádná reorganizace, informace se pouze uloí v systémovém
katalogu (v DB2 není v ALTER dovoleno pouít NOT NULL). Øádek relace, tj. obvykle záznam
na disku, je fyzicky mìnìn a po pouití UPDATE pøíkazu. Odstranìní relace
z databáze (tj. odstranìní jejího popisu ze systémového katalogu) se provede pøíkazem DROP.
Zjistíme-li napø., e rezervace se nebudou v knihovnì provádìt, staèí napsat </p>
<pre>DROP TABLE Rezervace</pre> 
<p>Je zøejmé, e v takovém pøípadì se zruší i pøípadnì ji vytvoøené soubory indexù nebo
pohledy, v jejich definicích se dané relace vyskytují. </p>
<p>Poadavek na vytvoøení indexù se realizuje pøíkazem CREATE INDEX. Index lze definovat
pro jeden atribut i pro kombinaci atributù. Pro schéma jedné relace lze zadat libovolné potøebné
mnoství indexù. Pouze jeden z nich mùe bıt definován jako CLUSTER; záznamy
v primárním souboru jsou pak uspoøádány podle tohoto atributu (nebo tìchto atributù) a leí
fyzicky za sebou. Tato varianta má ovšem omezené pouití, protoe s pøibıvajícími n-ticemi
se chování struktury zhoršuje (srovnej s ukládáním záznamù do oblasti pøeteèení u sekvenèních
souborù). </p>
<p>Napø. k relaci Ctenar lze vytvoøit sloenı index - nazveme ho Ja - (jmeno,adresa)
pøíkazem </p>
<pre>CREATE INDEX Ja ON Ctenar
     (jmeno,adresa)</pre>
<p>Není-li explicitnì vyznaèeno jinak (DESC), pøedpokládá se, e hodnoty v indexu
jsou uspoøádány vzestupnì (ASC). Index lze také zadat jako UNIQUE, co znamená, e jde
o primární index v bìné terminologii souborù dat (UNIQUE v kombinaci s CLUSTER vlastnì
vede ke koncepci index sekvenèního souboru). </p>
<p>Definice indexu má tvar </p>
<pre>CREATE [UNIQUE] INDEX jméno-indexu 
ON jméno-základní-relace (jméno-atr [uspoøádání] 
[,jméno-atr [uspoøádání]]...) 
[CLUSTER]</pre>
<p>Index lze zrušit pøíkazem DROP. Existoval-li napø. index podle atributu ISBN se jménem IS
pro relaci KNIHA, staèí napsat </p>
<pre>DROP INDEX IS</pre>
<p>Je zøejmé, e v rámci relaèního schématu databáze musí bıt jména
indexù rùzná. Mezi definièní pøíkazy øadíme ještì pøíkazy pro vytváøení
a rušení pohledù (CREATE VIEW, DR(&gt;P VIEW). Protoe vyuívají
konstruktù pro vıbìr dat, zmíníme se o nich a v
kapitole 4. </p>
<p>Indexy jsou vìtšinou implementovány pomocí B-stromù (viz [Po91],
[Po92]), které tvoøí de facto standard øešení v souèasné relaèní
technologii.</p>
<p>U vytvoøené relace mùeme pøejmenovat název tabulky nebo názvy sloupcù pomocí pøíkazu RENAME.</p>
<pre>RENAME TABLE tabulka_stará TO tabulka_nová</pre>
<pre>RENAME COLUMN tabulka.sloupec_starı TO tabulka.sloupec_nová</pre>
<hr color="Blue" size="1">
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap1.html"><img src="kap2_soubory/prev.gif" alt="1. Úvod do SQL" align="left"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/kap3.html"><img src="kap2_soubory/next.gif" alt="3. Manipulace dat v SQL" align="left"></a>
<a href="http://www.cs.vsb.cz/amalka/tomica/sql/index.html"><img src="kap2_soubory/toc.gif" alt="Obsah" align="left"></a>
<div style="position: absolute; left: 0px; top: 0px; z-index: 1000000000 ! important; visibility: hidden; opacity: 1;" id="linkalert-box"><img src="kap2_soubory/none-icon.png" id="linkalert-icon-1"></div></body></html>
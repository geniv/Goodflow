<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>





<meta http-equiv="Content-Language" content="cs">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2"><title>Mod_rewrite - návod</title>





<link rel="stylesheet" href="mod-rewrite_soubory/jpw.css"></head><body class="ost" id="www-jakpsatweb-cz">
<div id="text">
	

<h1>Mod_rewrite</h1>
	<p class="podtitul">pokroèilá manipulace s URL od základù</p>
<p>Na serveru Apache mù¾e být nainstalován modul mod_rewrite, který umo¾òuje 
podnikat <b>psí kusy s URL adresami -- pøesmìrování a podstrkávání</b>. Mod_rewrite 
je dost ¹ikovná vìcièka na slo¾itìj¹í problémy. Na druhou stranu je dost tì¾ké 
se s ním nauèit, mnì to trvalo asi rok a stejnì to je¹tì poøádnì neumím. Tento 
návod by vám mìl u¹etøit poèáteèní tápání (a ten rok èasu).</p>
	<p>Vìt¹ina <a href="http://www.jakpsatweb.cz/presmerovani.html">pøesmìrování se dá udìlat i 
	jednodu¹eji</a> (napøíklad meta tagem nebo pomocí mod_alias).</p>
	<p class="zalozka"><a href="#podminky">Dá se mod_rewrite pou¾ít?</a> -
	<a href="#priklady">První pøíklady na Mod_rewrite</a> -
	<a href="#rewriterule">Obecný zápis RewriteRule</a> - <a href="#rozdil">
	Podstrkávání a pøesmìrování</a> - <a href="#regular">Pøíklad jednoduchého 
	regulárního výrazu</a> - <a href="#promenne">Promìnné z regulárù</a> -
	<a href="#rewritecond">Podmínky RewriteCond</a> - <a href="#flags">Pøíznaky v 
	hranatých závorkách</a> - <a href="#varianty">Varianty k mod_rewrite</a> -
	<a href="#cesty">Bacha na interpretaci cest</a> -
	<a href="#koncim">Konèím tam, kde jiní zaèínají</a></p>
	<h2><a name="podminky"></a>Dá se mod_rewrite pou¾ít?</h2>
	<p>Ne na ka¾dém serveru se dá pracovat s mod_rewrite. Po¾adavky nutné:</p>
	<ul>
		<li>na serveru musí bì¾et Apache </li>
		<li>na tom Apaèi musí být mod_rewrite nainstalován a povolen </li>
		<li>musíte mít mo¾nost konfigurovat server -- buïto souborem httpd.conf, 
		nebo svým souborem <a href="http://www.jakpsatweb.cz/server/htaccess.html">.htaccess</a></li>
	</ul>
	<p>I tak to poøád nejsou podmínky dostaèující. Nìkdy se mohou direktivy mod_rewrite 
	tøískat s jinými existujícími direktivami. Na mém serveru napøíklad zaèal 
	mod_rewrite fungovat a¾ poté, co jsem si do .htaccess pøidal zápis </p>
<p class="code">Options +FollowSymlinks</p>
	<p>Jestli¾e nevíte, jestli mod_rewrite a .htaccess fungují, tak to prostì 
	zkuste, pøípadnì se zeptejte správce serveru.</p>
<h3>Bacha na chyby a na cyklení</h3>
	<p>Jestli¾e jste nikdy nezkou¹eli konfigurovat server nebo pracovat se 
	souborem 
	.htaccess, mod_rewrite asi není dobrá parketa, na které se to uèit. Zkuste 
	si napøed <a href="http://www.jakpsatweb.cz/server/htaccess.html">jednodu¹¹í vìci s .htaccess</a>.</p>
	<p>Asi jsem v ¾ivotì v nevidìl více serverových chyb, ne¾ kdy¾ jsem se uèil 
	pracovat s mod_rewrite. Kdy¾ se to rozbije, tak server hází chybu serveru s 
	èíslem 500 èasto i u stránek, se kterými jsem si pùvodnì hrát nechtìl. U¾ijete si spoustu srandy, stojí to za to.</p>
	<p>Hor¹í je, kdy¾ nìjakým pokusem mod_rewrite zacyklím. Pak se pìtistovka 
	objevit nemusí -- já koukám na prázdnou stránku a v serveru se zatím peèe 
	procesor.</p>
<p>Osobnì jsem vìci s mod_rewrite v¾dy testoval v podadresáøi na svém domácím 
serveru. Dìlejte to taky tak, jestli mù¾ete (zkuste
<a href="http://www.jakpsatweb.cz/php/easyphp.html">tøeba EasyPHP</a>). Jestli nemù¾ete, poraïte si 
jinak, ale vá¾nì nedoporuèuji experimentovat na ostrém serveru v adresáøi, kde 
máte ¾ivé stránky. Pøinejhor¹ím si tam udìlejte testovací adresáø s vlastním 
.htaccess a hrajte si v nìm. </p>
	<p>Pokud pracujete s http.conf, nezapomeòte po ka¾dé zmìnì server 
	restartovat.</p>
<h2 align="left"><a name="priklady"></a>První pøíklady na Mod_rewrite</h2>
<p>Ní¾e uvedená zaklínadla se zapisují do souboru .htaccess nebo httd.conf.</p>
<h3>Pøíklad jednoduchého pøesmìrování</h3>
	<p>Budu chtít, aby se mi stránka <code>http://muj-server.cz/<font color="#ff0000">pozadovany-soubor.html</font></code> 
	pøesmìrovala na <code>http://muj-server.cz/<font color="#008000">vysledny-soubor.html</font></code>. Do souboru 
	.htaccess nebo httpd.conf zadám tento kód:</p>
<p class="code"># presmerovani<br>
RewriteEngine on<br>
RewriteRule&nbsp;&nbsp; <font color="#ff0000">pozadovany-soubor\.html</font>&nbsp;&nbsp;
<font color="#008000">/vysledny-soubor.html</font>&nbsp;&nbsp;
<font color="#800000">[R]</font></p>
	<p>Kdy¾ pak ètenáø po¾ádá o <font color="#ff0000">pozadovany-soubor.html</font>, tak místo nìj dostane
	<font color="#009933">vysledny-soubor.html</font>. </p>
	<p>Tuto novou adresu 
	<font color="#009933">vysledny.soubor.html</font> <b>uvidí i v adrese</b> 
prohlí¾eèe. <font color="#800000">To [R] je jako <i>redirect</i></font>, tedy pøesmìrování 
	(hodí ho to na jinou adresu, ne¾ chtìl). </p>
	<p>Cíl pøesmìrování musí být absolutní adresa. V¹imnìte si, ¾e
	<font color="#009933">/vysledny.soubor.html</font> zaèíná lomítkem, a tak se 
	poèítá od rootu webu (a je to tedy absolutní adresa).</p>
<h3>Pøíklad jednoduchého podstrèení obsahu</h3>
	<p>Do souboru .htaccess nebo httpd.conf se zadá tento kód:</p>
<p class="code"># podstrceni<br>
RewriteEngine on<br>
RewriteRule <font color="#ff0000">zadana-stranka\.html</font>
<font color="#008000">podstrcena-stranka.html</font></p>
<p>Místo zadané stránky se pak objeví <b>obsah</b> podstrèené stránky. Zadaná 
<b>adresa</b> v 
prohlí¾eèi ale <b>zùstává stejná</b>, toti¾ <font color="#ff0000">zadana-stranka.html</font>. Proto tomu øíkám 
podstrèení, odbornìji se tomu øíká pøepisování. (Adresa bude èervená, obsah zelený.)</p>
	<p>Bude se to podstrkávat, proto¾e tentokrát tam není to [R].</p>
<p>Proto¾e zápisy adres v tomto pøíkladu nezaèínají lomítkem, adresa zadané stránky 
se odvozuje od adresáøe, ve 
kterém se vyskytuje .htaccess. Stejnì tak podstrcena-stranka.html (ta musela být 
v minulém pøíkladu zadávána absolutnì s lomítkem na zaèátku). Kdyby podstrèená 
stránka zaèínala lomítkem, poèítala by se nikoliv od aktuálního adresáøe, ale od 
koøene webu.</p>
<p><font color="#ff0000">První parametr</font> se chápe jako regulární výraz. V zadané stránce (první 
parametr) se tedy musejí nìkterým znakùm pøedøazovat zpìtná lomítka (typicky 
tøeba pøed teèku), aby se tyto znaky jako regulární výraz neinterpretovaly. 
Proto je zadaná stránka zapsaná se zpìtným lomítkem pøed teèkou: zadana-stranka\.html. Naopak 
v cílové stránce se ¾ádné znaky nanahrazují (<font color="#009933">druhý 
parametr</font> není regulár).</p>
<h2><a name="rewriterule"></a>Obecný zápis RewriteRule</h2>
	<p>Zápis mod_rewrite v¾dy zaèíná jeho zapnutím:</p>
	<p class="code">RewriteEngine on</p>
	<p>Je potøeba mít to tam samozøejmì v¾dycky, ale v pøíkladech to nìkdy 
	vynechávám.</p>
<p>RewriteRule má následující syntaxi:</p>
<p class="code">RewriteEngine on<br>
RewriteRule&nbsp;&nbsp; <font color="#ff0000">Na-co-se-ptá-klient</font>&nbsp;&nbsp;
<font color="#008000">Co-skuteènì-dostane</font>&nbsp;&nbsp;
<font color="#800000">[nepovinná-pravidla]</font></p>
<p>První øádek <code>RewriteEngine on</code> je to zaklínadlo, kterým se mod_rewrite 
zapíná.</p>
	<p>RewriteRule: Na co se ptá klient <font color="#ff0000">(první parametr)</font>, se 
zpracovává jako cesta k souboru odvozená od rootu webu. Pøíklady: /index.html, 
/archiv/akce.php Je to regulární výraz (nìkteré znaky se musejí escapovat). Kdy¾ 
	server vidí, ¾e klient chce stránku, která odpovídá <font color="#ff0000">prvnímu parametru</font>, zaène 
	nìco podnikat.</p>
<p>Adresa stránky, kterou u¾ivatel skuteènì dostane <font color="#008000">(druhý 
parametr)</font>, je buïto absolutní adresa (zaèíná na http://), nebo relativní. 
Relativní adresa se odvozuje buïto od aktuálního adresáøe, nebo od rootu webu -- 
to pokud zápis <font color="#008000">Co-skuteènì-dostane</font> zaèíná lomítkem. 
Napøíklad http://priklad.cz/soubor.html je adresa absolutní, zápis /soubor.html 
je adresa relativní.</p>
<p>Tento <font color="#008000">druhý parametr</font> se narozdíl od prvního 
nezapisuje jako regulární výraz, napøíklad se tedy nemusejí escapovat teèky zpìtným 
lomítkem (ale zase kdy¾ se zaescapují, tak to nevadí).</p>
<p>Co se týká <font color="#800000">nepovinných pravidel</font>, budu je rùznì 
zmiòovat v dal¹ích pøíkladech a na <a href="#flags">na konci tohoto textu</a>.</p>
<h2><a name="rozdil"></a>Podstrkávání a pøesmìrování</h2>
<p>Pro pochopení mod_rewrite je naprosto nutné, abyste perfektnì porozumìli 
rozdílu mezi podstrkáváním a pøesmìrováním. Mo¾ná se vám bude zdát, ¾e se 
opakuji, ale je to dùle¾ité.</p>
<p>Proberu opìt jeden z pùvodních pøíkladù. (Server bude v¹echny soubory chápat jako by 
byly v aktuálním adresáøi.)</p>
<p class="code">RewriteEngine on<br>
RewriteRule <font color="#ff0000">zadana-stranka\.html</font>
<font color="#008000">podstrcena-stranka.html</font></p>
<p>V tomto pøíkladu se neprovede pøesmìrování, nýbr¾ <b>podstrèení</b> (není tam 
to <font color="#800000">[R]</font>). To znamená, ¾e u¾ivatel stále uvidí adresu, kterou zadal (pøípadnì na 
kterou kliknul). Server mu na tuto adresu "podstrèí" obsah souboru
<font color="#008000">podstrcena-stranka.html</font>. V¹imnìte si, ¾e tentokrát 
nejsou <font color="#800000">v ¾ádných hranatých závorkách</font> ¾ádné kódy -- podstrkávání je výchozí chování mod_rewrite.
</p>
	<h3>Podstrkávání</h3>
<p>Kdy¾ budu mít soubor .htaccess <b>s pøíkazem na podstrkávání</b> napøíklad v 
adresáøi adresar, tak se mi mù¾e stát, ¾e </p>
<ul>
	<li>zadám do prohlí¾eèe adresu http://priklad.cz/adresar/zadana-stranka.html </li>
	<li>dostanu <b>obsah</b> z URL 
	http://priklad.cz/adresar/podstrcena-stranka.html  
	</li>
	<li>ale v prohlí¾eèi stále <b>uvidím pùvodní adresu</b> 
	http://priklad.cz/adresar/zadana-stranka.html
	</li>
</ul>
<p>HTTP hlavièky (a vùbec v¹echno) vypadají zvenku tak, jako by soubor 
/adresar/zadana-stranka.html skuteènì existoval. Napøíklad http kód odpovìdi je 
"200 OK". Pøitom ten soubor zadana-stranka.html ve skuteènosti vùbec nemusí 
existovat (a vìt¹inou se taková vìc dìlá právì proto, ¾e neexistuje).</p>
<h3>Pøesmìrování místo podstrèení</h3>
<p>Kdy¾ v pøedchozím pøíkladu pøidám na konec øádku RewriteRule do hranatých 
závorek pravidlo [R=301], takto:</p>
<p class="code">RewriteRule (.*) /stranka.html <font color="#800000">[R=301]</font></p>
<p>tak se podstrèení zmìní na <font color="#800000">pøesmìrování</font>. </p>
<ul>
	<li>zadám tøeba adresu http://priklad.cz/adresar/dotaz.html </li>
	<li>pak v øádku prohlí¾eèe <b>uvidím jinou adresu</b>: 
	http://priklad.cz/adresar/vysledek.html  
	</li>
	<li>a dostanu i obsah této stránky vysledek.html</li>
</ul>
<p>Èili v tuto chvíli jde o pøesmìrování, nikoliv o podstrèení. Kdyby tam bylo 
jenom [R] bez =301, tak to taky bude fungovat, ale server vrátí kód odpovìdi 302 found 
(co¾ je vìt¹inou to samé, co 301, akorát 302 se bere jako doèasné pøesmìrování, 
301 jako trvalé).</p>
<h3>Kdy se podstrkává a kdy pøesmìrovává</h3>
<p><b>Výchozí chování serveru je podstrkávání.</b> V jakých pøípadech probíhá <b>
pøesmìrování:</b></p>
<ul>
	<li>existuje jasná instrukce, ¾e se má pøesmìrovávat (napø. to [R])</li>
	<li>nebo nelze podstrkávat -- jde o pøípady, kdy <font color="#008000">nová 
	adresa</font> zaèíná na http://. Pak server nedovolí stránku podstrèit, i 
	kdyby byla z jeho serveru. Následující zápis pøesmìrovává, i kdy¾ nemá to 
	[R]:</li>
</ul>
<p class="code">RewriteRule <font color="#ff0000">&nbsp;&nbsp; </font>(.*)&nbsp;&nbsp;&nbsp; 
http://www.jakpsatweb.cz</p>
<h2><a name="regular"></a>Pøíklad jednoduchého regulárního výrazu</h2>
	<p>Jednou z krás mod_rewrite je to, ¾e dovoluje ve svých direktivách 
	vyu¾ívat regulární výrazy.</p>
<p>Pravidlo, které <font color="#ff0000">v¹echno</font> z aktuálního adresáøe 
(ve kterém je .htaccess) <b>pøesmìruje</b> na hlavní stránku
<font color="#008000">www.jakpsatweb.cz</font>:</p>
<p class="code">RewriteEngine on<br>
RewriteRule <font color="#ff0000">&nbsp;&nbsp; (.*)</font> <font color="#008000">&nbsp;&nbsp; 
http://www.jakpsatweb.cz</font>&nbsp;&nbsp;&nbsp;&nbsp; [R]</p>
<p>Ten zápis <font color="#ff0000">(.*) </font> znamená<font color="#ff0000"> 
"cokoliv"</font> (pøesnìji 
øeèeno libovoný poèet (to je hvìzdièka) libovolných znakù (to je ta teèka)). 
	</p>
	<p>Pokud v tomto pøípadì u¾ivatel napí¹e <font color="#ff0000">libovolnou adresu</font>, 
která míøí do aktuálního adresáøe (to je adresáø, ve kterém mám .htaccess),
<font color="#008000">pøesmìruje ho to na http://www.jakpsatweb.cz</font>. Tím eRkem v závorce 
	opìt øíkám, ¾e se bude pøesmìrovávat. </p>
<p>Tento pøíklad není moc u¾iteèný (pøesnìji øeèeno není k nièemu), je ale 
relativnì jednoduchý, proto jím zaèínám výklad.</p>
<h2><a name="promenne"></a>Promìnné z regulárù</h2>
<p>Pøevádìní jednoho souboru na druhý není moc u¾iteèné. Mnohem lep¹í je v 
zavolaném url nìco najít a pou¾ít to na volání nìèeho jiného. To "nìco" bude 
promìnná.</p>
	<p>Tøeba najdu èíslo 
èlánku a pou¾iju ho na volání skrytého url. Následující pøíklad pøedpokládá, ¾e 
stránky jsou napsané v php a jejich adresy mají normálnì za otazníkem parametry. 
Èlánky mají tøeba toto url:</p>
<p>nìjakýweb.cz/skript.php?id=234</p>
<p>Já bych ale chtìl na tuto stránku odkazovat a zapisovat adresou bez otazníku, 
napøíklad</p>
<p>nìjakýweb.cz/clanek-234</p>
<p>Udìlám to tak, ¾e v pravidle pro mod_rewrite najdu èíslo èlánku jako promìnnou (bude se jmenovat $1) a 
tuto promìnnou pou¾iju ji pøi definici toho, co se má podstrèit. Zápis pravidla 
vypadá tato:</p>
<p class="code">RewriteRule&nbsp;&nbsp;&nbsp; <font color="#ff0000"> <span lang="en-us">^</span>clanek-</font><font color="#800080">(.*)</font>
<font color="#ff0000">&nbsp;</font>&nbsp; <font color="#009933">skript.php?id=</font><font color="#800080">$1</font></p>
<p>Vysvìtlení zápisu: </p>
<ul>
	<li>u¾ivatel si vy¾ádá url tøeba <font color="#ff0000">clanek-</font><font color="#800080">543</font> </li>
	<li>mod_rewrite to uvidí a v¹imne si, ¾e to odpovídá regulárnímu výrazu
	<font color="#ff0000">
	<span lang="en-us">^</span>clanek-</font><font color="#800080">(.*)</font>. Závorce 
	<font color="#800080">(.*)</font> toti¾ odpovídá libovolný 
	poèet znakù, a odpovídá mu tedy i øetìzec "<font color="#800080">543</font>". Závorka se ulo¾í do promìnné 
	<font color="#800080">$1</font> (jednièka, proto¾e je to první závorka).</li>
	<li>mod_rewrite dále podstrkává u¾ivateli obsah, který najde na adrese 
	<font color="#009933">skript.php?id=</font><font color="#800080">$1</font> </li>
	<li>co¾ nyní odpovídá adrese <font color="#009933">skript.php?id=</font><font color="#800080">543</font> 
	, proto¾e <font color="#800080">$1</font> se rovná <font color="#800080">543</font></li>
	<li>(tuto slo¾itou adresu s otazníkem a parametry u¾ivatel vùbec neuvidí, 
	jedná se o skryté url, i kdy¾ je funkèní)</li>
	<li>u¾ivatel dále vidí na konci adresy v prohlí¾eèi clanek-543 (je to tedy 
	podstrkávání)</li>
</ul>
<h3>Nebude to za vás mìnit odkazy</h3>
<p>Pøedchozí pøíklad úpravy o¹klivých dynamických adres (s otazníkem) na hezké 
adresy se hodí pouze v pøípadì, ¾e máte aplikaci, která u¾ ty hezké adresy 
pou¾ívá v odkazech. Pokud máte starou aplikaci, která na ka¾dém kroku odkazuje 
na skripty se spoustou parametrù, tak se to musí øe¹it mnohem slo¾itìji. 
(Dvojitì s nìjakým dummy parametrem. Podrobnosti
<a href="http://www.jakpsatweb.cz/server/mod_rewrite/mod-rewrite-priklady.html">v pokroèilých pøíkladech</a>.) </p>
<h2><a name="rewritecond"></a>Podmínky RewriteCond</h2>
<p>Samotný zápis pomocí regulárù umo¾òuje hodnì kouzel. Kdy¾ ale reguláry 
nestaèí, nastupují dal¹í mo¾nosti <b>podmínkování, kdy se má manipulace provést</b>, 
a kdy ne.</p>
	<h3>Pøesmìrování na doménu bez www</h3>
<p>Po¾adavky na mùj web mohou 
po¾adavky pøicházet s hostname "jakpsatweb.cz" nebo "www.jakpsatweb.cz". 
Preferuji, aby lidé i vyhledávaèe chodili jenom na verzi s www, a tak je 
pøesmìrovávám. </p>
	<p>Pøíklad: V¹echny po¾adavky, co míøí na jakpsatweb.cz bez www, pøesmìruju na 
verzi domény s www:</p>
<p class="code">RewriteCond <font color="#800080">%{HTTP_HOST}</font> <font color="#800000">
^jakpsatweb.cz</font><br>
RewriteRule (.*) http://www.jakpsatweb.cz/$1 [R=301,QSA,L]</p>
<p>S pravidlem RewriteRule se pracuje pouze v pøípadì, ¾e je splnìna podmínka 
RewriteCond. V tomto pøípadì jsem napøíklad testoval promìnnou %{HTTP_HOST}, ve 
které je hostname (doménová èást) vy¾ádaného url. Pokud hostname ("jakpsatweb.cz" 
nebo "www.jakpsatweb.cz") zaèíná (to je ta støí¹ka) rovnou øetìzcem "jakpsatweb.cz", 
tak se pravidlo provede.</p>
<p>A proto kdy¾ nìkdo po¾ádá o http://jakpsatweb.cz/cokoliv, je pøesmìrován na 
http://www.jakpsatweb.cz/cokoliv . Pøíznak QSA v hranatých závorkách je¹tì 
zaøídí, ¾e se do nové adresy pøenese i query-string (èást adresy za otazníkem).</p>
	<p>Vý¹e uvedený zápis musí být v rootu domény, proto¾e jinak by se to $1 
vyhodnocovalo relativnì k adresáøi (jméno adresáøe by se uøízlo, nevím proè). 
Toto asi nìjak souvisí s RewriteBase (nevím).</p>
	<h3>Podobný pøíklad: pøesmìrování staré domény na novou</h3>
	<p class="code">RewriteCond %{HTTP_HOST} <span lang="en-us">^</span>stara-domena.cz 
	[NC]<br>
	RewriteRule <span lang="en-us">^</span>(.*)$ http://www.nova-domena.cz/$1 
	[R=301,QSA,L]</p>
	<h3>Symbolický zápis RewriteCond</h3>
<p>RewriteCond se symbolicky zapisuje:</p>
<p class="code">RewriteCond <font color="#800080">testovaný-øetìzec</font>
<font color="#800000">regulár</font><br>
# pravidla RewriteRule</p>
<p>V testovaném øetìzci se dají pou¾ívat promìnné, a v reguárech zvlá¹tní znaky. 
Napø v pøíkladu: </p>
	<p class="code">RewriteCond <font color="#800080">%{HTTP_HOST}</font> <font color="#800000">
^jakpsatweb.cz</font></p>
	<p>%{HTTP_HOST} je hostname, tedy celé jméno 
domény. Støí¹ka v pøíkladu znamená zaèátek øetìzce.</p>
<p>Více podmínek se øetìzí operátory [OR] a pí¹ou se na více øádkù. Napøíklad:</p>
<p class="code">RewriteCond %{REMOTE_HOST}&nbsp; ^domena1.*&nbsp; [OR]<br>
RewriteCond %{REMOTE_HOST}&nbsp; ^domena2.*</p>
<h3>Pou¾ívané promìnné v RewriteRule</h3>
<p>%{REQUEST_FILENAME}, %{REQUEST_URI}, %{REQUEST_METHOD}, %{REMOTE_ADDR}, %{REMOTE_HOST}</p>
<p>%{PATH_INFO}</p>
<p>%{QUERY_STRING}, %{SERVER_PORT}, %{SERVER_NAME}, %{HTTPS} (s hodnotou on)</p>
<p>%{HTTP_USER_AGENT}, %{HTTP_COOKIE}, %{HTTP_ACCEPT_LANGUAGE}, %{HTTP_HOST}, 
%{HTTP_REFERER}</p>
<p>%{ENV:REDIRECT_STATUS}</p>
<p>%{DOCUMENT_ROOT}/ (pou¾ívá se spí¹e v druhém parametru, který øíká, kam to 
pùjde)</p>
<p>a mo¾ná je¹tì dal¹í</p>
	<h2><a name="flags"></a>Pøíznaky v hranatých závorkách</h2>
	<p>V pøíkladech pou¾ití mod_rewrite, které porùznu najdete na webu, se na 
	konci pravidel èasto pou¾ívají pøíznaky v hranatých závorkách. Anglicky se 
	jim øíká <i>flags</i>. Znám a pou¾ívám jich jenom pár:</p>
	<dl>
		<dt>[L]</dt>
		<dd>Poslední pravidlo, nic u¾ dál nepøepisuj</dd>
		<dt>[QSA]</dt>
		<dd>Do pøepsané / pøesmìrované adresy pøidej za otazník v¹e, co je za 
		otazníkem v pùvodním 
		po¾adavku&nbsp; (query string). Zkratka QSA znamená "query string 
		append". Jestli¾e naopak chcete query string useknout, ukonèete 
		druhý parametr otazníkem.</dd>
		<dt>[R]</dt>
		<dd>bude se pøesmìrovávat (s kódem 302), nikoli podstrkávat </dd>
		<dt>[R=301]</dt>
		<dd>pøesmìrování pùjde s http kódem 301</dd>
		<dt>[F]</dt>
		<dd>nastavuje kód 403 - zakázáno. V kombinaci s dobrou RewriteCond 
		umo¾òuje podmínìnì zakázat nìkterá URL.</dd>
		<dt>[T=mime-typ]</dt>
		<dd>umo¾òuje výsledek poslat s jiným mime-typem. Pou¾itelné zejména pøi 
		pøesmìrování na binární soubory.</dd>
		<dt>[NC]</dt>
		<dd>nezále¾í na velikosti písmen (vhodné zejména do øádku RewriteCond).</dd>
	</dl>
	<p>Více pøíznakù v hranatých závorkách se v oddìluje èárkou.</p>
	<h2><a name="varianty"></a>Varianty k mod_rewrite</h2>
	<p>Na Windowsovském serveru IIS prý taky existuje nìco, co funguje podobnì 
	jako mod_rewrite, ale nevím o tom nic víc ne¾ to, ¾e to prý je nìjaký ISAPI 
	modul nebo produkt nazvaný IIS Rewrite. Myslím, ¾e nic z toho není zadarmo. 
	Na Intervalu je èlánek o
	<a href="http://interval.cz/clanek.asp?article=4058" rel="nofollow">o HttpRequest.PathInfo 
	v ASP.NET</a>, s èím¾ se dá dosáhnout efektu jako-statických adres, vhodných 
	pro SEO.</p>
	<p>Pokud nemù¾ete pou¾ít mod_rewrite (tøeba na serveru nefunguje), v mnoha 
	pøípadech na pøesmìrování stejnì dobøe poslou¾í mod_alias. Jeho direktiva 
	RedirectMatch mi pomohla v mnoha situacích. (Vizte
	<a href="http://httpd.apache.org/docs/2.0/mod/mod_alias.html" rel="nofollow">dokumentaci 
	mod_alias</a> - anglicky.) Podobné vìci prý umí mod_redirect, ale s ním 
	nemám ¾ádnou zku¹enost.</p>
	<h2><a name="cesty"></a>Bacha na interpretaci cest</h2>
	<p>Kdy¾ prohlí¾eèi, který po¾aduje stránku A, podstrèíte stránku B, která na 
	svém pùvodním místì pou¾ívá relativní adresy (obrázky, styly, odkazy), tak 
	ty adresy nebudou fungovat. Uvìdomte si, ¾e prohlí¾eè (obecnì klient) 
	odvozuje cesty od adresy, kterou vidí (a u¾ivatel ji vidí ve stavovém 
	øádku). Jestli¾e stránky A a B le¾í ve stejném adresáøi (i virtuálním), tak 
	je to v pohodì, odkazy budou fungovat. Jestli ale le¾í jinde, musíte v 
	podstrèeném kódu pou¾ívat absolutní adresy (alespoò musejí zaèínat 
	lomítkem), nebo pøedem poèítat s budoucím umístìním na adrese A (to se ale 
	dost blbì ladí). </p>
	<p>To se týká podstrkávání. Pøi pøesmìrování tenhle problém samozøejmì není.</p>
	<h2><a name="koncim"></a>Konèím tam, kde jiní zaèínají</h2>
	<p>Rùzných návodù na mod_rewrite se po webu potuluje spousta, vìøím, ¾e 
	nìjaký naleznete a pustíte se do dal¹ího studia. V tomto textu jsem popsal 
	základy, které dìlaly problém mnì. Nic víc jsem tímto návodem nesledoval. </p>
	<p><a href="http://www.jakpsatweb.cz/server/mod_rewrite/mod-rewrite-priklady.html">Vy¹¹í dívèí pøíkladù na 
	mod_rewrite</a> sepsal Petr Neuman.</p>

	
	<p>&nbsp;</p>
	

<!--XXXwebbot bot="Include" U-Include="adsense-dole-zluta.html" TAG="BODY" -->


<h3>Reklama</h3>
<p><a href="http://www.webhosting-c4.cz/adv/jw1">
<img src="mod-rewrite_soubory/c4-01.gif" alt="www.c4.cz, hosting za 1.200 Kè na rok s doménou v cenì" border="0" height="60" width="468"></a></p>
<p>&nbsp;</p>

<p>&nbsp;</p>

</div>

<div id="navigace">
	
<h3>Dal¹í:</h3>
	<p><a id="next" href="http://www.jakpsatweb.cz/server/mod_rewrite/mod-rewrite-priklady.html">Mod_rewrite - 
	pøíklady</a></p>
	<h3>Vizte té¾:</h3>
	<ul>
		<li><a href="http://www.jakpsatweb.cz/server/htaccess.html">Pou¾ití souboru .htaccess</a></li>
		<li><a href="http://www.jakpsatweb.cz/presmerovani.html">Pøesmìrování stránky, rùzné mo¾nosti</a></li>
		<li><a href="http://www.jakpsatweb.cz/clanky/lomitka-tecky.html">Lomítka a teèka v adresách 
		souborù</a></li>
	</ul>
	<h3>Odkazy jinam</h3>
<p><a href="http://www.cmo.com.tw/manual/mod/mod_rewrite.html" rel="nofollow">Návod na mod_rewrite</a> 
(anglicky)</p>
	<p><a href="http://httpd.apache.org/docs/mod/mod_rewrite.html" rel="nofollow">Dokumentace k 
	mod_rewrite na Apache 1.3</a> (anglicky)</p>
<p><a href="http://httpd.apache.org/docs-2.1/mod/mod_rewrite.html" rel="nofollow">mod_rewrite 
na Apache 2</a>, funguje stejnì (anglicky) </p>
<p><a href="http://httpd.apache.org/docs-2.0/mod/mod_rewrite.html" rel="nofollow">Podobná 
dokumentace</a> (anglicky), 
ale na zaèátku jsou zajímavé kecy</p>
	<p>
	<a href="http://www.ilovejackdaniels.com/apache/mod_rewrite-cheat-sheet/" rel="nofollow">
	Taháky na mod_rewrite</a> (anglicky, PDF nebo PNG)</p>
	<p>
	<a href="http://www.sovavsiti.cz/2003/mod_rewrite.html" rel="nofollow">Mod_rewrite pro 
	lep¹í odkazy</a>, Sova v síti </p>
	
	


<script type="text/javascript"><!--
google_ad_client = "pub-4372514035999321";
google_ad_width = 125;
google_ad_height = 125;
google_ad_format = "125x125_as";
google_ad_type = "text";
//2006-12-16: jpw vpravo, ostatni jpw
google_ad_channel = "2626615486+9426052476";
google_color_border = "FFFFEE";
google_color_bg = "FFFFEE";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "000080";
//--></script>
<script type="text/javascript" src="mod-rewrite_soubory/show_ads.js">
</script><iframe name="google_ads_frame" src="mod-rewrite_soubory/ads.htm" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" frameborder="0" height="125" scrolling="no" width="125"></iframe>


</div>



<div id="hlavicka">


	<div id="logo">
		<a href="http://www.jakpsatweb.cz/index.html" id="logoa" accesskey="1">
		<img src="mod-rewrite_soubory/jakpw.gif" alt="Jak psát web" height="88" width="131"></a>
	</div>

	<div id="slogan">
		o tvorbì, údr¾bì a zlep¹ování internetových stránek
	</div>


<div id="hledani">
	<form action="http://www.google.com/custom">
		<p>
			<input name="cx" value="008997274925841959410:atrkgfnhjvc" type="hidden">	
			<input name="cof" value="LH:;CX:Jak%20ps%C3%A1t%20web;LW:0;FORID:1;S:http://www.jakpsatweb.cz;L:http://www.jakpsatweb.cz/images/jakpw-100.gif;LP:1" type="hidden">
			<input name="hl" value="cs" type="hidden">
			<input name="ie" value="iso-8859-2" type="hidden">
			<input name="client" value="pub-4372514035999321" type="hidden">
			<input name="channel" value="8759767026" type="hidden">
			<input name="q" class="text" size="12" type="text">
			<input name="sa" class="submit" value="Hledat" type="submit">
		</p>
	</form>

</div>
<div id="ouska">
		<a class="zak" href="http://www.jakpsatweb.cz/index.html">Návody</a>
		<a class="html" href="http://www.jakpsatweb.cz/html/index.html">HTML</a>
		<a class="css" href="http://www.jakpsatweb.cz/css/index.html">CSS</a>
		<a class="js" href="http://www.jakpsatweb.cz/javascript/index.html">JavaScript</a>
		<a class="clanky" href="http://www.jakpsatweb.cz/clanky/index.html">Èlánky</a>
		<a class="ost" href="http://www.jakpsatweb.cz/navigace/ostatni.html">Ostatní</a>
	</div>
	
<div id="prouzek">
		
			

<p><a href="http://www.jakpsatweb.cz/enc/encyklopedie.html">Encyklopedie</a>
<a href="http://www.jakpsatweb.cz/frontpage/index.html">FrontPage</a>
<a href="http://www.jakpsatweb.cz/reklama/index.html">Reklama</a> 
<a href="http://www.jakpsatweb.cz/php/index.html">PHP</a>
<a href="http://www.jakpsatweb.cz/server/index.html" id="sel">Server</a>

</p></div>
</div>


<div id="hrasek"><a href="http://www.jakpsatweb.cz/index.html">Jak psát web</a> <b>&gt;</b>  <a href="http://www.jakpsatweb.cz/navigace/ostatni.html">Ostatní</a> <b>&gt;</b>  <a href="http://www.jakpsatweb.cz/server/index.html">Server</a> <b>&gt;</b> Mod_rewrite</div>

<script type="text/javascript" src="mod-rewrite_soubory/patka.js"></script><div id="prevnexttop" class="panel"> <a href="http://www.jakpsatweb.cz/server/index.html" title="Obsah podsekce Server">^</a> <a href="http://www.jakpsatweb.cz/server/mod_rewrite/mod-rewrite-priklady.html" title="Dal¹í: Mod_rewrite - 
	pøíklady">&gt;</a></div><div id="prevnextbottom" class="panel"> <a href="http://www.jakpsatweb.cz/server/index.html" title="Obsah podsekce Server">^</a> <a href="http://www.jakpsatweb.cz/server/mod_rewrite/mod-rewrite-priklady.html" title="Dal¹í: Mod_rewrite - 
	pøíklady">&gt;</a></div><div id="wherenext"><a href="#navigace" onclick="navigaciDolu(); return false;">Kam dál?</a></div>

<p class="patka-global"><a href="http://www.jakpsatweb.cz/">Jak psát web</a> pí¹e Yuhù, 
Du¹an Janovský. <a href="http://www.jakpsatweb.cz/kontakt.html">Kontakt</a>. 
<a href="http://www.jakpsatweb.cz/archiv/pristupnost.html">Prohlá¹ení o pøístupnosti</a>. Poslední aktualizace
26. dubna 2008.

</p>

<script src="mod-rewrite_soubory/my-urchin.js" type="text/javascript"></script>





<div style="position: absolute; left: 1074px; top: 218px; z-index: 1000000000; visibility: hidden; opacity: 1; width: 0px;" id="linkalert-box"><img style="width: 0px;" src="mod-rewrite_soubory/none-icon.png" id="linkalert-icon-1"></div></body></html>
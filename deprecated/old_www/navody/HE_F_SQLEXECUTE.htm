<!doctype html public "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1250">
<title>Funkce SQL_execute</title>
<link rel='stylesheet' style='text/css' href='../function.css'>
</head>

<body bgcolor="#FFFFFF" text="#000000">



<h2 class=function>SQL_execute</h2>
<img src='../images/cpp.gif' width='44' height='16' border='0' alt='c/c++' align='middle' hspace='2'><img src='../images/pascal.gif' width='44' height='16' border='0' alt='pascal' align='middle' hspace='2'><img src='../images/sql.gif' width='44' height='16' border='0' alt='sql' align='middle' hspace='2'>


<br><br>
<div class='typ'>BOOL <b>[cd_]SQL_execute</b>([cdp_t cdp], const char * statement, uns32 * results);<br>
function <b>[cd_]SQL_execute</b>([cdp : cdp_t]; statement : Pchar; var results) : Boolean;<br>
FUNCTION <b>SQL_execute</b>(IN statement CLOB) RETURNS INT;
</div>


<p><b>Parametry</b></p>

<table border=1 cols=2>

<tr valign="top">
<td width=14%><i>statement </i></td>
<td width=86%>pøíkaz jazyka SQL</td>
</tr>

<tr valign="top">
<td width=14%><i>results </i></td>
<td width=86%>pole èísel, do nichž se zapíše informace o výsledku operace; pole musí mít svou první složku pøed zavoláním inicializovanou hodnotou nula</td>
</tr>

<tr valign="top">
<td width=14%>[<i>cdp </i></td>
<td width=86%><a href="HE_EXTCD.htm">kontextová promìnná</a> klienta]  </td>
</tr>
</table><br>

<p><b>Od verze:</b></p>

<p>5.0, úprava ve verzi 8.0</p>

<p><b>Popis</b></p>

<p>Funkce vykoná pøíkaz jazyka SQL zadaný v parametru <i>statement</i>. Pøi pøekladu volání této funkce se nekontroluje smysluplnost SQL pøíkazu - pøípadná syntaktická chyba pøíkazu se projeví až pøi bìhu, kdy SQL server ohlásí, že nemùže splnit požadavek. </p>
<p>Zadáte-li více pøíkazù oddìlených støedníkem, všechny se provedou v jedné transakci.</p>

<p><i>POZOR! Funkce má rùzné syntaxe pro rùzná prostøedí (klientské API a SQL)!</i></p>

<p>V parametru <i>statement</i> mùže být více SQL pøíkazù oddìlených støedníkem. </p>

<p>Pøi volání funkce z externího jazyka je nutné uvést výstupní parametr <i>results</i>. Tímto parametrem je pole 32-bitových celých èísel bez znaménka. Pole musí obsahovat nejménì tolik složek, kolik pøíkazù jazyka SQL je zadáno v parametru <i>statement</i>, maximálnì však 10. Volání procedury se nebere jako jeden pøíkaz, ale uvažují se jednotlivé pøíkazy v ní obsažené.  Pole musí mít svou první složku pøed zavoláním inicializovanou hodnotou nula. Parametr <i>results</i> slouží k získání informací o výsledku provádìní pøíkazù. Má relevantní hodnotu pouze v pøípadì, že funkce <b><code>SQL_execute</code></b> skonèila úspìšnì. Pokud byl proveden pøíkaz <a href="HE_SQL2_UPDATE.htm">UPDATE</a>, <a href="HE_SQL2_DELETE.htm">DELETE</a> nebo <a href="HE_SQL2_INSERT.htm">INSERT</a>, hodnotou pøíslušného prvku pole je poèet zpracovaných záznamù. Pokud byl proveden SELECT (není SQL pøíkaz, lze ho však zde použít pro otevøení dotazu), pak hodnotou pøíslušného prvku pole je èíslo otevøeného kurzoru a s tímto otevøeným kurzorem je možné dále pracovat (stejnì jako by byl otevøen pomocí funkce <a href="HE_F_OPENCURSORDIRECT.htm"><code>Open_cursor_direct</code></a>). Otevøený kurzor se zavírá pomocí funkce <a href="HE_F_CLOSECURSOR.htm"><code>Close_cursor</code></a>.</p>

<p><b>Hodnota funkce</b></p>

<p>Klientská funkce vrací hodnotu FALSE, pokud se akci podaøilo úspìšnì provést. V opaèném pøípadì vrací TRUE a povahu chyby lze zjistit voláním funkce <b><code>Signalize</code></b>. </p>

<p>Pøi použití této funkce v jazyce SQL se vrací buï èíslo <a href="../xml/html/comperrors.html">kompilaèní chyby</a>, pokud pøíkazy pøedané jako parametr nelze pøeložit, nebo 0, pokud bylo provedení pøíkazù úspìšné - použití viz  <a href="../xml/html/dynsql.html">Dynamické SQL pøíkazy uvnitø uložených procedur</a>. </p>

<p><b>Pøíklad v SQL:</b></p>

<p>mùže-li dojít ke kompilaèní chybì, je tøeba ji ošetøit v kódu (nelze zachytit handlerem):</p>

<pre><code>SET tabname="neex_tab" ;
SET pomstr="INSERT INTO "||tabname||" DEFAULT VALUES";
SET err=<b>SQL_execute</b>(pomstr);
IF err=1069 THEN 
  CALL Log_write("kompilaèní chyba: tabulka &gt;"|| tabname||"&lt; neexistuje!!");  
  SIGNAL user_except_1;
ELSEIF err&gt;0 THEN
  CALL Log_write("kompilaèní chyba:"||Int2str(err));  
ELSE ...</code></pre>

<p><b>Viz</b></p>

<ul class='viz'>
 <li><a href="HE_F_SQLPREPARE.htm">SQL_prepare</a> </li>
 <li><a href="HE_F_SQLEXECPREPARED.htm">SQL_exec_prepared</a> </li>
 <li><a href="HE_F_SQLDROP.htm">SQL_drop</a> </li>
 <li><a href="HE_F_SQLHOSTEXECUTE.htm">SQL_host_execute</a> </li>
</ul>

</body>
</html>

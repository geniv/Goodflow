<!doctype html public "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1250">
<title>Pøíkaz CASE v SQL</title>
<link rel='stylesheet' style='text/css' href='../function.css'>
</head>

<body bgcolor="#FFFFFF" text="#000000"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
	<td style="background-image: url(../images/bghead.jpg);
		background-position: right;
		background-repeat: no-repeat;">
	<table width="100%" border="0" cellpadding="0" cellspacing="0"
		style="background-image:none">
	<tr>
		<td style="background-image:none" height="46"
			width="15%"><img src="../images/title-cz.gif"
			width="255" height="33"
			alt="602SQL-Úplná dokumentace"
			title="602SQL - Úplná dokumentace"
			border="0"></td>
		<td width="33%" align="right"><a href="../xml/html/top.html"><img class="floatno"
			src="../images/index.gif"
			width="15" height="16"
			alt="Index" title="Zpìt na obsah"
			border="0" vspace="2"></a> &nbsp;
			 </td>
	</tr>
	</table>
	</td>
</tr>
</table><table class="navigace" border="0" width="100%"  bgcolor="#FFFFBF"><tr> <td
width="20" align="center"><img class="floatno" src="../images/prev.gif"
width="15" height="13" alt="&lt;&shy;" title="Pøedcházející téma"
border="0"></td><td width="25%"><a
href="HE_SQL2_IF.htm">Pøíkaz IF</a></td> <td width="25%"
align="right"><img class="floatno" src="../images/up.gif" width="13"
height="15" alt="Nahoru" title="O jednu úroveò výš" border="0"
align="middle"></td><td width="25%"><a href="HE_SQL2_RIDICIPRIKAZY.htm">Øídící pøíkazy</a></td>
<td width="25%" align="right"><a
href="HE_SQL2_LOOP.htm">Pøíkaz LOOP</a></td><td width="20"
align="center"><img class="floatno" src="../images/next.gif" width="15"
height="13" alt="&shy;&gt;" title="Následující téma" border="0"></td>
</tr></table>




<h1><a name="he_sql2_case"></a>Pøíkaz CASE (SQL)</h1>

<pre><code>pøíkaz_CASE ::= jednoduchý_pøíkaz_CASE | vyhledávací_pøíkaz_CASE
jednoduchý_pøíkaz_CASE ::= CASE výraz { WHEN výraz2 THEN pøíkaz… }… [ ELSE pøíkaz… ] END CASE;
vyhledávací_pøíkaz_CASE ::= CASE { WHEN podmínka THEN pøíkaz… }… [ ELSE pøíkaz… ] END CASE;</code></pre>

<p><a href="HE_SQL2_PRIKAZY.htm">Pøíkaz</a> CASE slouží k&nbsp;výbìru a provedení jedné z&nbsp;nìkolika možných posloupností pøíkazù. Jednotlivé posloupnosti jsou uvedeny ve vìtvích zaèínajících WHEN nebo ELSE.</p>

<p>V&nbsp;<i>jednoduchém pøíkazu CASE</i> se hodnota <a href="HE_SQL2_VYRAZY.htm"><i>výrazu</i></a> hledá po øadì ve vìtvích mezi hodnotami <i>výrazù2</i>. Ve <i>vyhledávacím pøíkazu CASE</i> se po øadì hledá vìtev, v&nbsp;níž je <a href="HE_SQL2_PODMINKA.htm"><i>podmínka</i></a> splnìná. Nalezne-li se taková vìtev, provedou se <i>pøíkazy</i> v&nbsp;této vìtvi následující za THEN.</p>

<p>Pokud není nalezena žádná vyhovující vìtev, pak obsahuje-li pøíkaz vìtev s ELSE, provedou se <i>pøíkazy</i> za ELSE. Jinak nastane chybový <a href="../xml/html/handlingcategories.html">sqlstate</a> 20000 (SQ_CASE_NOT_FOUND_STMT).</p>

<p>Dojde-li pøi provádìní posloupnosti <i>pøíkazù</i> k&nbsp;chybì, pokraèuje se dále v&nbsp;závislosti na dostupném <a href="HE_SQL2_DEKLARACEHANDLERU.htm">handleru</a> této chyby. Není-li nalezen CONTINUE handler, provádìní pøíkazù v&nbsp;posloupnosti se ukonèí.</p>

<p><b>Odlišnosti od normy</b>

<ul>
	<li>Na rozdíl od návrhu normy SQL 3 602SQL nevyžaduje, aby vyhodnocení <i>výrazu </i>bylo deterministické a bez vedlejších efektù. <i>Výraz</i> se vyhodnotí pouze jednou.</li>
</ul>

<p><b>Pøíklad použití:</b></p>

<p><i>vyhledávací CASE</i> (obdoba pøíkladu u IF)</p>

<pre><code>TRIGGER befupd BEFORE UPDATE OF CISLO ON Tab3
REFERENCING NEW ROW AS novaradka
FOR EACH ROW
BEGIN
  <b>CASE</b>
    <b>WHEN</b> novaradka.cislo &lt; 0 <b>THEN</b>
      SET novaradka.cislo=-novaradka.cislo;
  <b>END CASE</b>;
END</code></pre>

<p><i>jednoduchý CASE</i></p>

<p>Zmìòte cenu u položek ceníku takto: položky ceníku zaèínající na X +10%, zaèínající na A +100%, ostatní smazat (obdoba pøíkladu u FOR)</p>

<pre><code>PROCEDURE ZmenaCeniku();
BEGIN 
  FOR radek AS curcen SENSITIVE CURSOR FOR 
    SELECT id_pol, cena
    FROM Cenik
  DO 
    BEGIN
      <b>CASE</b> SUBSTRING(radek.id_pol FROM 1 FOR 1) 
        <b>WHEN 'X' THEN </b>
          UPDATE  SET cena = cena*1.1 WHERE CURRENT OF curcen;
        <b>WHEN 'A' THEN </b>
          UPDATE  SET cena = cena*2 WHERE CURRENT OF curcen;
        <b>ELSE</b>
          DELETE WHERE CURRENT OF curcen;
      <b>END CASE;</b>
    END;
  END FOR;
END;</code></pre>



<table class="navigace" border="0" width="100%"  bgcolor="#FFFFBF"><tr> <td
width="20" align="center"><img class="floatno" src="../images/prev.gif"
width="15" height="13" alt="&lt;&shy;" title="Pøedcházející téma"
border="0"></td><td width="25%"><a
href="HE_SQL2_IF.htm">Pøíkaz IF</a></td> <td width="25%"
align="right"><img class="floatno" src="../images/up.gif" width="13"
height="15" alt="Nahoru" title="O jednu úroveò výš" border="0"
align="middle"></td><td width="25%"><a href="HE_SQL2_RIDICIPRIKAZY.htm">Øídící pøíkazy</a></td>
<td width="25%" align="right"><a
href="HE_SQL2_LOOP.htm">Pøíkaz LOOP</a></td><td width="20"
align="center"><img class="floatno" src="../images/next.gif" width="15"
height="13" alt="&shy;&gt;" title="Následující téma" border="0"></td>
</tr></table>
</body>
</html>

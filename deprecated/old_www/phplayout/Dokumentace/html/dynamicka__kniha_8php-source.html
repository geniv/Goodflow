<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Novy vychozi PHP layout: Zdrojový soubor /var/www/phplayout/modules/dynamicka_navstevni_kniha/dynamicka_kniha.php</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generováno programem Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Hlavní&nbsp;stránka</span></a></li>
      <li><a href="annotated.html"><span>Třídy</span></a></li>
      <li class="current"><a href="files.html"><span>Soubory</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>Seznam&nbsp;souborů</span></a></li>
      <li><a href="globals.html"><span>Symboly&nbsp;v&nbsp;souborech</span></a></li>
    </ul>
  </div>
<h1>/var/www/phplayout/modules/dynamicka_navstevni_kniha/dynamicka_kniha.php</h1><a href="dynamicka__kniha_8php.html">Zobrazit dokumentaci tohoto souboru.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00015"></a><a class="code" href="classDynamicNavstevniKniha.html">00015</a> <span class="keyword">class </span><a class="code" href="classDynamicNavstevniKniha.html">DynamicNavstevniKniha</a> <span class="keyword">extends</span> <a class="code" href="classDefaultModule.html">DefaultModule</a>
<a name="l00016"></a>00016 {
<a name="l00017"></a><a class="code" href="classDynamicNavstevniKniha.html#bf36a803d9adb3d44fd723da882f43af">00017</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#bf36a803d9adb3d44fd723da882f43af">$var</a>, <a class="code" href="classDynamicNavstevniKniha.html#0d743a6a21c20fdcfe6a67d54c3e926b">$sqlite</a>, <a class="code" href="classDynamicNavstevniKniha.html#cc90eefb7439f034b267383a2a2c8760">$dbname</a>, <a class="code" href="classDynamicNavstevniKniha.html#ca7c7cd59bbb40117614280b3355ab37">$dirpath</a>, <a class="code" href="classDynamicNavstevniKniha.html#c4f2ba265e04996b039effcc9afe76d7">$absolutni_url</a>, <a class="code" href="classDynamicNavstevniKniha.html#d1348d0a979692040a2041e5c9798541">$unikatni</a>;
<a name="l00018"></a><a class="code" href="classDynamicNavstevniKniha.html#f75c75b35342b9bc451acdf9c900e378">00018</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#0891c80bd937a795719677cfe199ec91">$admincaptchakod</a>, <a class="code" href="classDynamicNavstevniKniha.html#f75c75b35342b9bc451acdf9c900e378">$captchakod</a>;
<a name="l00019"></a><a class="code" href="classDynamicNavstevniKniha.html#8938e7032dcc7149afd39b2e5c17be39">00019</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#8938e7032dcc7149afd39b2e5c17be39">$idmodul</a> = <span class="stringliteral">"dynkninav"</span>;  <span class="comment">//id pro rozliseni modulu v adminu</span>
<a name="l00020"></a><a class="code" href="classDynamicNavstevniKniha.html#cbc3da202c9964ad127c4ed408e01bc5">00020</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#cbc3da202c9964ad127c4ed408e01bc5">$povolit_pridani</a> = <span class="keyword">true</span>; <span class="comment">//true/false - povolit / zakazat, pridavani (i mazani) dalsich polozek</span>
<a name="l00021"></a><a class="code" href="classDynamicNavstevniKniha.html#acd90d50ef3de73ac6eeecaba696de06">00021</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#acd90d50ef3de73ac6eeecaba696de06">$vypis_chybu</a> = <span class="keyword">false</span>;
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="classDynamicNavstevniKniha.html#2f82892523501b095747c6ef473b1e83">00023</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#2f82892523501b095747c6ef473b1e83">$znacka_povinne</a> = <span class="stringliteral">"*"</span>;
<a name="l00024"></a>00024 
<a name="l00025"></a><a class="code" href="classDynamicNavstevniKniha.html#15a643c5d60e73087ce6fa2f028547ff">00025</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#15a643c5d60e73087ce6fa2f028547ff">$rsslink</a> = <span class="stringliteral">"rss"</span>;
<a name="l00026"></a>00026 
<a name="l00027"></a>00027                             <span class="comment">//index =&gt; slovní popis</span>
<a name="l00028"></a><a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">00028</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> = array (<span class="stringliteral">"nadpis"</span> =&gt;  <span class="stringliteral">"Napis"</span>,
<a name="l00029"></a>00029                             <span class="stringliteral">"popisek"</span> =&gt; <span class="stringliteral">"Krátký popisek"</span>,
<a name="l00030"></a>00030                             <span class="stringliteral">"text"</span> =&gt;    <span class="stringliteral">"Dlouhé texty"</span>,
<a name="l00031"></a>00031 
<a name="l00032"></a>00032                             <span class="stringliteral">"captcha"</span> =&gt; <span class="stringliteral">"Captcha kod - 1x"</span>,
<a name="l00033"></a>00033 
<a name="l00034"></a>00034                             <span class="stringliteral">"datum"</span> =&gt;   <span class="stringliteral">"Datum"</span>,
<a name="l00035"></a>00035                             <span class="stringliteral">"cas"</span> =&gt;     <span class="stringliteral">"Čas"</span>,
<a name="l00036"></a>00036                             <span class="stringliteral">"datumcas"</span> =&gt;<span class="stringliteral">"Datum a čas"</span>,
<a name="l00037"></a>00037 
<a name="l00038"></a>00038                             <span class="stringliteral">"checkbox"</span> =&gt; <span class="stringliteral">"Zaškrkávací políčko"</span>,
<a name="l00039"></a>00039                             );
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classDynamicNavstevniKniha.html#e398fa7def12a8676823a4d7bf9d6faf">00041</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#e398fa7def12a8676823a4d7bf9d6faf">$pocitadloporadi</a> = array (0 =&gt; 1,
<a name="l00042"></a>00042                                     1 =&gt; 1,
<a name="l00043"></a>00043                                     2 =&gt; 1,
<a name="l00044"></a>00044                                     3 =&gt; 1,
<a name="l00045"></a>00045                                     4 =&gt; 1,
<a name="l00046"></a>00046                                     5 =&gt; 1,
<a name="l00047"></a>00047                                     6 =&gt; 1,
<a name="l00048"></a>00048                                     7 =&gt; 1,
<a name="l00049"></a>00049                                     8 =&gt; 1);
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classDynamicNavstevniKniha.html#63d1d8d27c371b6668923fb77b863082">00051</a>   <span class="keyword">private</span> <a class="code" href="classDynamicNavstevniKniha.html#63d1d8d27c371b6668923fb77b863082">$vstupni_typ</a> = array (<span class="stringliteral">"text"</span>,
<a name="l00052"></a>00052                                 <span class="stringliteral">"integer"</span>,
<a name="l00053"></a>00053                                 <span class="stringliteral">"reg_exp"</span>);
<a name="l00054"></a>00054 
<a name="l00062"></a><a class="code" href="classDynamicNavstevniKniha.html#a6e9eeb57aa0c54503731219d3a2a2ff">00062</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#a6e9eeb57aa0c54503731219d3a2a2ff">__construct</a>(&amp;<a class="code" href="classDynamicNavstevniKniha.html#bf36a803d9adb3d44fd723da882f43af">$var</a>, $index) <span class="comment">//konstruktor</span>
<a name="l00063"></a>00063   {
<a name="l00064"></a>00064     $this-&gt;var = <a class="code" href="classDynamicNavstevniKniha.html#bf36a803d9adb3d44fd723da882f43af">$var</a>;
<a name="l00065"></a>00065     $this-&gt;dirpath = dirname($this-&gt;var-&gt;moduly[$index][<span class="stringliteral">"include"</span>]);
<a name="l00066"></a>00066     $this-&gt;dbname = $this-&gt;var-&gt;moduly[$index][<span class="stringliteral">"databaze"</span>];
<a name="l00067"></a>00067 
<a name="l00068"></a>00068     <span class="comment">//includovani unikatniho obsahu</span>
<a name="l00069"></a>00069     $this-&gt;unikatni = $this-&gt;<a class="code" href="classDefaultModule.html#f9bc13977b7099f00c4a74192ce85dce">NactiObsahSouboru</a>(<span class="stringliteral">"{$this-&gt;dirpath}/.unikatni_obsah.php"</span>);
<a name="l00070"></a>00070     $this-&gt;absolutni_url = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"Funkce"</span>, <span class="stringliteral">"AbsoluteUrl"</span>);
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     $this-&gt;znacka_povinne = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_znacka_povinne"</span>]);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     $this-&gt;povolit_pridani = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_povolit_pridani"</span>]);
<a name="l00075"></a>00075     $this-&gt;vypis_chybu = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_vypis_chybu"</span>]);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077     <span class="keywordflow">if</span> (!$this-&gt;sqlite = @<span class="keyword">new</span> SQLiteDatabase(<span class="stringliteral">"{$this-&gt;dirpath}/{$this-&gt;dbname}"</span>, 0777, $error))
<a name="l00078"></a>00078     {
<a name="l00079"></a>00079       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#5a7a9cbeccb103fa39a207926eee232c">Instalace</a>();
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     $this-&gt;<a class="code" href="classDefaultModule.html#de138416b3a548d72b50432499895bb7">NastavitAdresuMenu</a>($this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#bacb56e0b9c32905d2cf3f8e50ffa1f3">RozsiritAdminMenu</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu"</span>], $this-&gt;idmodul)));
<a name="l00085"></a>00085   }
<a name="l00086"></a>00086 
<a name="l00093"></a><a class="code" href="classDynamicNavstevniKniha.html#d3cf8a90dbfddb6de4dea080bbee3d46">00093</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#d3cf8a90dbfddb6de4dea080bbee3d46">AdminObsah</a>()
<a name="l00094"></a>00094   {
<a name="l00095"></a>00095     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu &amp;&amp;
<a name="l00096"></a>00096         $this-&gt;var-&gt;aktivniadmin)
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098       $adr = explode(<span class="stringliteral">"__"</span>, $_GET[$this-&gt;var-&gt;get_idmodul]); <span class="comment">//rozdeleni adresy</span>
<a name="l00099"></a>00099       <span class="keywordflow">switch</span> ($adr[0])
<a name="l00100"></a>00100       {
<a name="l00101"></a>00101         <span class="keywordflow">case</span> $this-&gt;idmodul:  <span class="comment">//id modul</span>
<a name="l00102"></a>00102           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = (!Empty($adr[1]) ? $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#bce8a9fa6361b55ca6a00198695eebde">AdminObsahSablony</a>($adr[1]) : $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#fd077b9d6beb149cf397bcaad70dcf3a">AdministraceObsahu</a>());
<a name="l00103"></a>00103         <span class="keywordflow">break</span>;
<a name="l00104"></a>00104       }
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109 
<a name="l00115"></a><a class="code" href="classDynamicNavstevniKniha.html#5a7a9cbeccb103fa39a207926eee232c">00115</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#5a7a9cbeccb103fa39a207926eee232c">Instalace</a>()
<a name="l00116"></a>00116   {
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (filesize(<span class="stringliteral">"{$this-&gt;dirpath}/{$this-&gt;dbname}"</span>) == 0)
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119       <span class="keywordflow">if</span> (!@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"CREATE TABLE sablona_kniha (</span>
<a name="l00120"></a>00120 <span class="stringliteral">                                      id INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span>
<a name="l00121"></a>00121 <span class="stringliteral">                                      adresa TEXT,</span>
<a name="l00122"></a>00122 <span class="stringliteral">                                      razeni VARCHAR(50),</span>
<a name="l00123"></a>00123 <span class="stringliteral">                                      nove_rss INTEGER UNSIGNED,</span>
<a name="l00124"></a>00124 <span class="stringliteral">                                      nazev VARCHAR(200),</span>
<a name="l00125"></a>00125 <span class="stringliteral">                                      popisek TEXT,</span>
<a name="l00126"></a>00126 <span class="stringliteral">                                      href_id VARCHAR(200),</span>
<a name="l00127"></a>00127 <span class="stringliteral">                                      href_class VARCHAR(200),</span>
<a name="l00128"></a>00128 <span class="stringliteral">                                      href_akce VARCHAR(500),</span>
<a name="l00129"></a>00129 <span class="stringliteral">                                      zobrazit BOOL);</span>
<a name="l00130"></a>00130 <span class="stringliteral"></span>
<a name="l00131"></a>00131 <span class="stringliteral">                                      CREATE TABLE obsah_sablony_kniha (</span>
<a name="l00132"></a>00132 <span class="stringliteral">                                      id INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span>
<a name="l00133"></a>00133 <span class="stringliteral">                                      sablona INTEGER UNSIGNED,</span>
<a name="l00134"></a>00134 <span class="stringliteral">                                      obsah TEXT,</span>
<a name="l00135"></a>00135 <span class="stringliteral">                                      pridano DATETIME,</span>
<a name="l00136"></a>00136 <span class="stringliteral">                                      zobrazit BOOL,</span>
<a name="l00137"></a>00137 <span class="stringliteral">                                      admin BOOL);</span>
<a name="l00138"></a>00138 <span class="stringliteral"></span>
<a name="l00139"></a>00139 <span class="stringliteral">                                      CREATE TABLE element_kniha (</span>
<a name="l00140"></a>00140 <span class="stringliteral">                                      id INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span>
<a name="l00141"></a>00141 <span class="stringliteral">                                      sablona INTEGER UNSIGNED,</span>
<a name="l00142"></a>00142 <span class="stringliteral">                                      typ INTEGER UNSIGNED,</span>
<a name="l00143"></a>00143 <span class="stringliteral">                                      nazev VARCHAR(200),</span>
<a name="l00144"></a>00144 <span class="stringliteral">                                      value VARCHAR(200),</span>
<a name="l00145"></a>00145 <span class="stringliteral">                                      input_id VARCHAR(200),</span>
<a name="l00146"></a>00146 <span class="stringliteral">                                      input_class VARCHAR(200),</span>
<a name="l00147"></a>00147 <span class="stringliteral">                                      input_akce VARCHAR(200),</span>
<a name="l00148"></a>00148 <span class="stringliteral">                                      povinne BOOL,</span>
<a name="l00149"></a>00149 <span class="stringliteral">                                      skryt_obsah BOOL,</span>
<a name="l00150"></a>00150 <span class="stringliteral">                                      vstupni_typ INTEGER UNSIGNED,</span>
<a name="l00151"></a>00151 <span class="stringliteral">                                      reg_exp VARCHAR(500),</span>
<a name="l00152"></a>00152 <span class="stringliteral">                                      vystupni_format VARCHAR(200),</span>
<a name="l00153"></a>00153 <span class="stringliteral">                                      min_val INTEGER UNSIGNED,</span>
<a name="l00154"></a>00154 <span class="stringliteral">                                      max_val INTEGER UNSIGNED,</span>
<a name="l00155"></a>00155 <span class="stringliteral">                                      poradi INTEGER UNSIGNED);</span>
<a name="l00156"></a>00156 <span class="stringliteral">                                      "</span>, $error))
<a name="l00157"></a>00157       {
<a name="l00158"></a>00158         $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00159"></a>00159       }
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161   }
<a name="l00162"></a>00162 
<a name="l00170"></a><a class="code" href="classDynamicNavstevniKniha.html#bacb56e0b9c32905d2cf3f8e50ffa1f3">00170</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#bacb56e0b9c32905d2cf3f8e50ffa1f3">RozsiritAdminMenu</a>($adresa)
<a name="l00171"></a>00171   {
<a name="l00172"></a>00172     $i = count($adresa);
<a name="l00173"></a>00173     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, nazev, href_id, href_class, href_akce, zobrazit FROM sablona_kniha ORDER BY LOWER(nazev);"</span>, NULL, $error))
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l00176"></a>00176       {
<a name="l00177"></a>00177         <span class="keywordflow">while</span> ($data = $res-&gt;fetchObject())
<a name="l00178"></a>00178         {
<a name="l00179"></a>00179           $adresa[$i][<span class="stringliteral">"main_href"</span>] = <span class="stringliteral">"{$this-&gt;idmodul}__{$data-&gt;id}"</span>;
<a name="l00180"></a>00180           $adresa[$i][<span class="stringliteral">"odkaz"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_tvar_menu_odkaz"</span>], $data-&gt;nazev);
<a name="l00181"></a>00181           $adresa[$i][<span class="stringliteral">"title"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_tvar_menu_title"</span>], $data-&gt;nazev);
<a name="l00182"></a>00182           $adresa[$i][<span class="stringliteral">"id"</span>] = $data-&gt;href_id;
<a name="l00183"></a>00183           $adresa[$i][<span class="stringliteral">"class"</span>] = $data-&gt;href_class;
<a name="l00184"></a>00184           $adresa[$i][<span class="stringliteral">"akce"</span>] = $data-&gt;href_akce;
<a name="l00185"></a>00185           $adresa[$i][<span class="stringliteral">"zobrazit"</span>] = $data-&gt;zobrazit;
<a name="l00186"></a>00186           $i++;
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188       }
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190       <span class="keywordflow">else</span>
<a name="l00191"></a>00191     {
<a name="l00192"></a>00192       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="keywordflow">return</span> $adresa;
<a name="l00196"></a>00196   }
<a name="l00197"></a>00197 
<a name="l00207"></a><a class="code" href="classDynamicNavstevniKniha.html#7e3751661bbaac54b32e4e881ff57d9d">00207</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#7e3751661bbaac54b32e4e881ff57d9d">ArrayVystupObsahu</a>($adr = NULL)
<a name="l00208"></a>00208   {
<a name="l00209"></a>00209     <span class="keywordflow">if</span> (!Empty($adr))
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211       $adresa = $adr;
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213       <span class="keywordflow">else</span>
<a name="l00214"></a>00214     {
<a name="l00215"></a>00215       $adresa = stripslashes(htmlspecialchars($_SERVER[<span class="stringliteral">"QUERY_STRING"</span>], ENT_QUOTES));
<a name="l00216"></a>00216     }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     $razeni = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#894df6032fe479f5db53ff92515077e8">VypisRazeni</a>($adresa);  <span class="comment">//vrati smer razeni</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     $sablona = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#39430f0524a7580d7e2189a259d327b7">ZjistiSablonuAdresy</a>($adresa);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00223"></a>00223     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT</span>
<a name="l00224"></a>00224 <span class="stringliteral">                                      obsah, pridano, zobrazit, admin</span>
<a name="l00225"></a>00225 <span class="stringliteral">                                      FROM obsah_sablony_kniha</span>
<a name="l00226"></a>00226 <span class="stringliteral">                                      WHERE</span>
<a name="l00227"></a>00227 <span class="stringliteral">                                      sablona={$sablona}</span>
<a name="l00228"></a>00228 <span class="stringliteral">                                      ORDER BY obsah_sablony_kniha.pridano {$razeni};"</span>, NULL, $error))  <span class="comment">//LIMIT 0,{$limit}</span>
<a name="l00229"></a>00229     {
<a name="l00230"></a>00230       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l00231"></a>00231       {
<a name="l00232"></a>00232         <span class="keywordflow">while</span>($data = $res-&gt;fetchObject())
<a name="l00233"></a>00233         {
<a name="l00234"></a>00234           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>[<span class="stringliteral">"obsah"</span>][] = $data-&gt;obsah;
<a name="l00235"></a>00235           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>[<span class="stringliteral">"pridano"</span>][] = $data-&gt;pridano;
<a name="l00236"></a>00236           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>[<span class="stringliteral">"zobrazit"</span>][] = $data-&gt;zobrazit;
<a name="l00237"></a>00237           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>[<span class="stringliteral">"admin"</span>][] = $data-&gt;admin;
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239       }
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241       <span class="keywordflow">else</span>
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00247"></a>00247   }
<a name="l00248"></a>00248 
<a name="l00256"></a><a class="code" href="classDynamicNavstevniKniha.html#894df6032fe479f5db53ff92515077e8">00256</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#894df6032fe479f5db53ff92515077e8">VypisRazeni</a>($adresa)
<a name="l00257"></a>00257   {
<a name="l00258"></a>00258     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00259"></a>00259     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT razeni</span>
<a name="l00260"></a>00260 <span class="stringliteral">                                      FROM sablona_kniha</span>
<a name="l00261"></a>00261 <span class="stringliteral">                                      WHERE</span>
<a name="l00262"></a>00262 <span class="stringliteral">                                      adresa='{$adresa}';"</span>, NULL, $error))
<a name="l00263"></a>00263     {
<a name="l00264"></a>00264       <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l00265"></a>00265       {
<a name="l00266"></a>00266         $data = $res-&gt;fetchObject();
<a name="l00267"></a>00267         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $data-&gt;razeni;
<a name="l00268"></a>00268       }
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270       <span class="keywordflow">else</span>
<a name="l00271"></a>00271     {
<a name="l00272"></a>00272       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00276"></a>00276   }
<a name="l00277"></a>00277 
<a name="l00285"></a><a class="code" href="classDynamicNavstevniKniha.html#1f17b8bb0643929130880e5b6bcde67f">00285</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#1f17b8bb0643929130880e5b6bcde67f">VypisLimitRSS</a>($adresa)
<a name="l00286"></a>00286   {
<a name="l00287"></a>00287     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = 0;
<a name="l00288"></a>00288     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT nove_rss</span>
<a name="l00289"></a>00289 <span class="stringliteral">                                      FROM sablona_kniha</span>
<a name="l00290"></a>00290 <span class="stringliteral">                                      WHERE</span>
<a name="l00291"></a>00291 <span class="stringliteral">                                      adresa='{$adresa}';"</span>, NULL, $error))
<a name="l00292"></a>00292     {
<a name="l00293"></a>00293       <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l00294"></a>00294       {
<a name="l00295"></a>00295         $data = $res-&gt;fetchObject();
<a name="l00296"></a>00296         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $data-&gt;nove_rss;
<a name="l00297"></a>00297       }
<a name="l00298"></a>00298     }
<a name="l00299"></a>00299       <span class="keywordflow">else</span>
<a name="l00300"></a>00300     {
<a name="l00301"></a>00301       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00302"></a>00302     }
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00305"></a>00305   }
<a name="l00306"></a>00306 
<a name="l00314"></a><a class="code" href="classDynamicNavstevniKniha.html#9da7bfa6d1729763a1ac5fbc07036e19">00314</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#9da7bfa6d1729763a1ac5fbc07036e19">VypisPopisku</a>($sablona)
<a name="l00315"></a>00315   {
<a name="l00316"></a>00316     settype($sablona, <span class="stringliteral">"integer"</span>);
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00319"></a>00319     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT popisek</span>
<a name="l00320"></a>00320 <span class="stringliteral">                                      FROM sablona_kniha</span>
<a name="l00321"></a>00321 <span class="stringliteral">                                      WHERE</span>
<a name="l00322"></a>00322 <span class="stringliteral">                                      id={$sablona};"</span>, NULL, $error))
<a name="l00323"></a>00323     {
<a name="l00324"></a>00324       <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l00325"></a>00325       {
<a name="l00326"></a>00326         $data = $res-&gt;fetchObject();
<a name="l00327"></a>00327         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $data-&gt;popisek;
<a name="l00328"></a>00328       }
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330       <span class="keywordflow">else</span>
<a name="l00331"></a>00331     {
<a name="l00332"></a>00332       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00333"></a>00333     }
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337 
<a name="l00347"></a><a class="code" href="classDynamicNavstevniKniha.html#58dd564cb5a9842db6c3be06580732ce">00347</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#58dd564cb5a9842db6c3be06580732ce">RSSLink</a>($tvar = 1)
<a name="l00348"></a>00348   {
<a name="l00349"></a>00349     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_once_link_rss_{$tvar}"</span>],
<a name="l00350"></a>00350                                         ($this-&gt;var-&gt;htaccess ? <span class="stringliteral">"{$this-&gt;absolutni_url}{$this-&gt;rsslink}"</span> : <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;rsslink}"</span>));
<a name="l00351"></a>00351 
<a name="l00352"></a>00352     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354 
<a name="l00364"></a><a class="code" href="classDynamicNavstevniKniha.html#f926d41290147c6394407d274cba5e9c">00364</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#f926d41290147c6394407d274cba5e9c">RSSLinkWeb</a>($tvar = 1)
<a name="l00365"></a>00365   {
<a name="l00366"></a>00366     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_once_link_rss_web_{$tvar}"</span>],
<a name="l00367"></a>00367                                         ($this-&gt;var-&gt;htaccess ? <span class="stringliteral">"{$this-&gt;absolutni_url}{$this-&gt;rsslink}"</span> : <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;rsslink}"</span>));
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00370"></a>00370   }
<a name="l00371"></a>00371 
<a name="l00383"></a><a class="code" href="classDynamicNavstevniKniha.html#f118d47ae6b0943bc3985062e06260d3">00383</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#f118d47ae6b0943bc3985062e06260d3">RSSVystup</a>($adr = NULL, $tvar = 1)
<a name="l00384"></a>00384   {
<a name="l00385"></a>00385     <span class="keywordflow">if</span> (!Empty($adr))
<a name="l00386"></a>00386     {
<a name="l00387"></a>00387       $adresa = $adr;
<a name="l00388"></a>00388     }
<a name="l00389"></a>00389       <span class="keywordflow">else</span>
<a name="l00390"></a>00390     {
<a name="l00391"></a>00391       $adresa = stripslashes(htmlspecialchars($_SERVER[<span class="stringliteral">"QUERY_STRING"</span>], ENT_QUOTES));
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     $razeni = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#894df6032fe479f5db53ff92515077e8">VypisRazeni</a>($adresa);  <span class="comment">//vrati smer razeni</span>
<a name="l00395"></a>00395     $limit = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#1f17b8bb0643929130880e5b6bcde67f">VypisLimitRSS</a>($adresa);  <span class="comment">//vrati pocet polozek v rychlo vypisu</span>
<a name="l00396"></a>00396 
<a name="l00397"></a>00397     $sablona = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#39430f0524a7580d7e2189a259d327b7">ZjistiSablonuAdresy</a>($adresa);
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     $this-&gt;rss_kodovani = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_kodovani_{$tvar}"</span>]);
<a name="l00400"></a>00400     $this-&gt;rss_title = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_title_{$tvar}"</span>]);
<a name="l00401"></a>00401     $this-&gt;rss_category = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_category_{$tvar}"</span>]);
<a name="l00402"></a>00402     $this-&gt;rss_description = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_description_{$tvar}"</span>]);
<a name="l00403"></a>00403     $this-&gt;rss_language = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_language_{$tvar}"</span>]);
<a name="l00404"></a>00404     $this-&gt;rss_copyright = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_copyright_{$tvar}"</span>]);
<a name="l00405"></a>00405     $this-&gt;rss_managingEditor = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_managingEditor_{$tvar}"</span>]);
<a name="l00406"></a>00406     $this-&gt;rss_webMaster = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_webMaster_{$tvar}"</span>]);
<a name="l00407"></a>00407     $this-&gt;rss_ttl = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_ttl_{$tvar}"</span>]);
<a name="l00408"></a>00408     $this-&gt;rss_image_title = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_image_title_{$tvar}"</span>]);
<a name="l00409"></a>00409     $this-&gt;rss_image_link = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_image_link_{$tvar}"</span>], $this-&gt;absolutni_url);
<a name="l00410"></a>00410     $this-&gt;rss_image_url = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_rss_image_url_{$tvar}"</span>], $this-&gt;absolutni_url);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;rsslink)  <span class="comment">//ceka na danou adresu</span>
<a name="l00413"></a>00413     {
<a name="l00414"></a>00414       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_rss_header_{$tvar}"</span>],
<a name="l00415"></a>00415                                           $this-&gt;rss_kodovani,
<a name="l00416"></a>00416                                           $this-&gt;rss_title,
<a name="l00417"></a>00417                                           $this-&gt;absolutni_url,
<a name="l00418"></a>00418                                           $this-&gt;rss_category,
<a name="l00419"></a>00419                                           $this-&gt;rss_description,
<a name="l00420"></a>00420                                           $this-&gt;rss_language,
<a name="l00421"></a>00421                                           $this-&gt;rss_copyright,
<a name="l00422"></a>00422                                           $this-&gt;rss_managingEditor,
<a name="l00423"></a>00423                                           $this-&gt;rss_webMaster,
<a name="l00424"></a>00424                                           $this-&gt;rss_ttl,
<a name="l00425"></a>00425                                           gmdate(<span class="stringliteral">"D, d M Y H:i:s \G\M\T"</span>),
<a name="l00426"></a>00426                                           $this-&gt;rss_image_url);
<a name="l00427"></a>00427 
<a name="l00428"></a>00428       <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT</span>
<a name="l00429"></a>00429 <span class="stringliteral">                                        obsah, pridano</span>
<a name="l00430"></a>00430 <span class="stringliteral">                                        FROM obsah_sablony_kniha</span>
<a name="l00431"></a>00431 <span class="stringliteral">                                        WHERE</span>
<a name="l00432"></a>00432 <span class="stringliteral">                                        sablona={$sablona}</span>
<a name="l00433"></a>00433 <span class="stringliteral">                                        ORDER BY obsah_sablony_kniha.pridano {$razeni}</span>
<a name="l00434"></a>00434 <span class="stringliteral">                                        LIMIT 0,{$limit};"</span>, NULL, $error))
<a name="l00435"></a>00435       {
<a name="l00436"></a>00436         <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l00437"></a>00437         {
<a name="l00438"></a>00438           $i = 0;
<a name="l00439"></a>00439           <span class="keywordflow">while</span> ($data = $res-&gt;fetchObject())
<a name="l00440"></a>00440           {
<a name="l00441"></a>00441             $obsahpole = explode(<span class="stringliteral">"|-x-|"</span>, $data-&gt;obsah);
<a name="l00442"></a>00442 
<a name="l00443"></a>00443             $vypis = array(<span class="stringliteral">"array_args"</span>,
<a name="l00444"></a>00444                           $this-&gt;absolutni_url,
<a name="l00445"></a>00445                           date(<span class="stringliteral">"D, d M Y H:i:s \G\M\T"</span>, strtotime($data-&gt;pridano)),
<a name="l00446"></a>00446                           $i);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448             <span class="keywordflow">for</span> ($j = 0; $j &lt; count($obsahpole); $j++)
<a name="l00449"></a>00449             {
<a name="l00450"></a>00450               <span class="keywordflow">if</span> (count(explode(<span class="stringliteral">"||--x--||"</span>, $obsahpole[$j])) == 2)
<a name="l00451"></a>00451               {
<a name="l00452"></a>00452                 $zobr = explode(<span class="stringliteral">"||--x--||"</span>, $obsahpole[$j]);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454                 <span class="keywordflow">if</span> (strpos($zobr[1], <span class="stringliteral">"@"</span>) &gt; 0)
<a name="l00455"></a>00455                 {
<a name="l00456"></a>00456                   $email = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>($zobr[1]);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458                   $vypis[] = (!$zobr[0] ? $email : <span class="stringliteral">""</span>);
<a name="l00459"></a>00459                   <span class="comment">//$this-&gt;NactiUnikatniObsah($this-&gt;unikatni["normal_visible_email_{$tvar}"], $email, $vypis[$this-&gt;NactiUnikatniObsah($this-&gt;unikatni["normal_num_jmeno_{$tvar}"])]) :</span>
<a name="l00460"></a>00460                   <span class="comment">//                        $this-&gt;NactiUnikatniObsah($this-&gt;unikatni["normal_invsible_email_{$tvar}"], $email, $vypis[$this-&gt;NactiUnikatniObsah($this-&gt;unikatni["normal_num_jmeno_{$tvar}"])]));</span>
<a name="l00461"></a>00461                 }
<a name="l00462"></a>00462                   <span class="keywordflow">else</span>
<a name="l00463"></a>00463                 {
<a name="l00464"></a>00464                   $vypis[] = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>(!$zobr[0] ? $zobr[1] : <span class="stringliteral">""</span>);
<a name="l00465"></a>00465                 }
<a name="l00466"></a>00466               }
<a name="l00467"></a>00467                 <span class="keywordflow">else</span>
<a name="l00468"></a>00468               {
<a name="l00469"></a>00469                 $vypis[] = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>($obsahpole[$j]);
<a name="l00470"></a>00470               }
<a name="l00471"></a>00471             }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473             <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_rss_item_{$tvar}"</span>], $vypis);
<a name="l00474"></a>00474             $i++;
<a name="l00475"></a>00475           }
<a name="l00476"></a>00476         }
<a name="l00477"></a>00477       }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_rss_end_{$tvar}"</span>]);
<a name="l00480"></a>00480 
<a name="l00481"></a>00481       echo <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00482"></a>00482       exit(0);
<a name="l00483"></a>00483     }
<a name="l00484"></a>00484   }
<a name="l00485"></a>00485 
<a name="l00493"></a><a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">00493</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>($text)
<a name="l00494"></a>00494   {
<a name="l00495"></a>00495     $prevod = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_prevod"</span>],
<a name="l00496"></a>00496                                         $this-&gt;absolutni_url);
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     <span class="keywordflow">return</span> strtr($text, $prevod);  <span class="comment">//prevede text dle prevadecoho pole</span>
<a name="l00499"></a>00499   }
<a name="l00500"></a>00500 
<a name="l00510"></a><a class="code" href="classDynamicNavstevniKniha.html#18c9b30240ed5eacfaf179ba7d1c9f09">00510</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#18c9b30240ed5eacfaf179ba7d1c9f09">PocetRadkuNavstevniKniha</a>($adr = NULL)
<a name="l00511"></a>00511   {
<a name="l00512"></a>00512     <span class="keywordflow">if</span> (!Empty($adr))
<a name="l00513"></a>00513     {
<a name="l00514"></a>00514       $adresa = $adr;
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516       <span class="keywordflow">else</span>
<a name="l00517"></a>00517     {
<a name="l00518"></a>00518       $adresa = stripslashes(htmlspecialchars($_SERVER[<span class="stringliteral">"QUERY_STRING"</span>], ENT_QUOTES));
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     $sablona = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#39430f0524a7580d7e2189a259d327b7">ZjistiSablonuAdresy</a>($adresa);
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = 0;
<a name="l00524"></a>00524     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT obsah, admin</span>
<a name="l00525"></a>00525 <span class="stringliteral">                                      FROM obsah_sablony_kniha</span>
<a name="l00526"></a>00526 <span class="stringliteral">                                      WHERE zobrazit=1 AND</span>
<a name="l00527"></a>00527 <span class="stringliteral">                                      sablona={$sablona}</span>
<a name="l00528"></a>00528 <span class="stringliteral">                                      ORDER BY obsah_sablony_kniha.pridano {$razeni};"</span>, NULL, $error))
<a name="l00529"></a>00529     {
<a name="l00530"></a>00530       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $res-&gt;numRows();
<a name="l00531"></a>00531     }
<a name="l00532"></a>00532       <span class="keywordflow">else</span>
<a name="l00533"></a>00533     {
<a name="l00534"></a>00534       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00538"></a>00538   }
<a name="l00539"></a>00539 
<a name="l00553"></a><a class="code" href="classDynamicNavstevniKniha.html#b00ce1e9903a4ee34e026fa23b41643d">00553</a>   <span class="keyword">public</span> function <a class="code" href="classDynamicNavstevniKniha.html#b00ce1e9903a4ee34e026fa23b41643d">NavstevniKniha</a>($adr = NULL, $kontrola = <span class="keyword">true</span>, $pridavek = NULL, $strankovani = NULL, $tvar = 1)
<a name="l00554"></a>00554   {
<a name="l00555"></a>00555     <span class="keywordflow">if</span> (!Empty($adr))
<a name="l00556"></a>00556     {
<a name="l00557"></a>00557       $adresa = $adr;
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559       <span class="keywordflow">else</span>
<a name="l00560"></a>00560     {
<a name="l00561"></a>00561       $adresa = stripslashes(htmlspecialchars($_SERVER[<span class="stringliteral">"QUERY_STRING"</span>], ENT_QUOTES));
<a name="l00562"></a>00562     }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     $limit = $str = <span class="stringliteral">""</span>;
<a name="l00565"></a>00565     <span class="keywordflow">if</span> (!Empty($strankovani))
<a name="l00566"></a>00566     {
<a name="l00567"></a>00567       list($str, $limit) = $strankovani;
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570     $sablona = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#39430f0524a7580d7e2189a259d327b7">ZjistiSablonuAdresy</a>($adresa);
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#5ee521db4249c023545ed604c1df64de">VypisPridavaciFormular</a>($sablona, $tvar); <span class="comment">//vypise pridavaci formular</span>
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     $prvni = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_prvni_{$tvar}"</span>]);
<a name="l00575"></a>00575     $posledni = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_posledni_{$tvar}"</span>]);
<a name="l00576"></a>00576     $ente_def_array = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_ente_def_array_{$tvar}"</span>]);
<a name="l00577"></a>00577     $ente_def = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_ente_def_{$tvar}"</span>]);
<a name="l00578"></a>00578     $ente_od = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_ente_od_{$tvar}"</span>]);
<a name="l00579"></a>00579     $ente_po = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_ente_po_{$tvar}"</span>]);
<a name="l00580"></a>00580     $ente = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_ente_{$tvar}"</span>]);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582     $razeni = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#894df6032fe479f5db53ff92515077e8">VypisRazeni</a>($adresa);  <span class="comment">//vrati smer razeni</span>
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT obsah, admin</span>
<a name="l00585"></a>00585 <span class="stringliteral">                                      FROM obsah_sablony_kniha</span>
<a name="l00586"></a>00586 <span class="stringliteral">                                      WHERE zobrazit=1 AND</span>
<a name="l00587"></a>00587 <span class="stringliteral">                                      sablona={$sablona}</span>
<a name="l00588"></a>00588 <span class="stringliteral">                                      ORDER BY obsah_sablony_kniha.pridano {$razeni}</span>
<a name="l00589"></a>00589 <span class="stringliteral">                                      {$limit};"</span>, NULL, $error))
<a name="l00590"></a>00590     {
<a name="l00591"></a>00591       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l00592"></a>00592       {
<a name="l00593"></a>00593         $i = 0;
<a name="l00594"></a>00594         <span class="keywordflow">while</span> ($data = $res-&gt;fetchObject())
<a name="l00595"></a>00595         {
<a name="l00596"></a>00596           $obsahpole = explode(<span class="stringliteral">"|-x-|"</span>, $data-&gt;obsah);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598           $vypis = array(<span class="stringliteral">"array_args"</span>,
<a name="l00599"></a>00599                         $this-&gt;absolutni_url,
<a name="l00600"></a>00600                         ($i == 0 ? $prvni : <span class="stringliteral">""</span>),
<a name="l00601"></a>00601                         ($i == ($res-&gt;numRows() - 1) ? $posledni : <span class="stringliteral">""</span>),
<a name="l00602"></a>00602                         (in_array($i, $ente_def_array) ? $ente_def : <span class="stringliteral">""</span>),
<a name="l00603"></a>00603                         ((($i + $ente_od) % $ente_po) == 0 ? $ente : <span class="stringliteral">""</span>));
<a name="l00604"></a>00604 
<a name="l00605"></a>00605           <span class="keywordflow">for</span> ($j = 0; $j &lt; count($obsahpole); $j++)
<a name="l00606"></a>00606           {
<a name="l00607"></a>00607             <span class="keywordflow">if</span> (count(explode(<span class="stringliteral">"||--x--||"</span>, $obsahpole[$j])) == 2)
<a name="l00608"></a>00608             {
<a name="l00609"></a>00609               $zobr = explode(<span class="stringliteral">"||--x--||"</span>, $obsahpole[$j]);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611               <span class="keywordflow">if</span> (strpos($zobr[1], <span class="stringliteral">"@"</span>) &gt; 0)
<a name="l00612"></a>00612               {
<a name="l00613"></a>00613                 $email = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>($zobr[1]);
<a name="l00614"></a>00614 
<a name="l00615"></a>00615                 $vypis[] = (!$zobr[0] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_visible_email_{$tvar}"</span>], $email, $vypis[$this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_num_jmeno_{$tvar}"</span>])]) :
<a name="l00616"></a>00616                                         $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_invsible_email_{$tvar}"</span>], $email, $vypis[$this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_num_jmeno_{$tvar}"</span>])]));
<a name="l00617"></a>00617               }
<a name="l00618"></a>00618                 <span class="keywordflow">else</span>
<a name="l00619"></a>00619               {
<a name="l00620"></a>00620                 $vypis[] = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>(!$zobr[0] ? $zobr[1] : <span class="stringliteral">""</span>);
<a name="l00621"></a>00621               }
<a name="l00622"></a>00622             }
<a name="l00623"></a>00623               <span class="keywordflow">else</span>
<a name="l00624"></a>00624             {
<a name="l00625"></a>00625               $vypis[] = $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#eff4335a7d9ac61aa231592bcf745c2e">OsetreniTextu</a>(($kontrola ? htmlspecialchars_decode(html_entity_decode($obsahpole[$j])) : $obsahpole[$j]));
<a name="l00626"></a>00626             }
<a name="l00627"></a>00627           }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629           $vypis[] = ($data-&gt;admin ? <span class="stringliteral">"_admin"</span> : <span class="stringliteral">""</span>);  <span class="comment">//detekce admin prispevku</span>
<a name="l00630"></a>00630 
<a name="l00631"></a>00631           <span class="comment">//$dalsi[] = $this-&gt;absolutni_url;</span>
<a name="l00632"></a>00632           <span class="keywordflow">for</span> ($j = 0; $j &lt; count($pridavek); $j++)
<a name="l00633"></a>00633           {
<a name="l00634"></a>00634             $dalsi[] = $pridavek[$j]; <span class="comment">//naplneni pole pro doplnkove %% parametry</span>
<a name="l00635"></a>00635           }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637           <span class="keywordflow">if</span> (!Empty($dalsi)) <span class="comment">//pokud je pridavek pouzit</span>
<a name="l00638"></a>00638           {
<a name="l00639"></a>00639             $vypis = array_merge($vypis, $dalsi); <span class="comment">//slouceni pole</span>
<a name="l00640"></a>00640           }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_{$tvar}"</span>],
<a name="l00643"></a>00643                                               $vypis);
<a name="l00644"></a>00644           $i++;
<a name="l00645"></a>00645         }
<a name="l00646"></a>00646       }
<a name="l00647"></a>00647         <span class="keywordflow">else</span>
<a name="l00648"></a>00648       {
<a name="l00649"></a>00649         <span class="keywordflow">if</span> ($this-&gt;vypis_chybu)
<a name="l00650"></a>00650         {
<a name="l00651"></a>00651           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_vypis_null_{$tvar}"</span>]);
<a name="l00652"></a>00652         }
<a name="l00653"></a>00653       }
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655       <span class="keywordflow">else</span>
<a name="l00656"></a>00656     {
<a name="l00657"></a>00657       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00658"></a>00658     }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $str;  <span class="comment">//vlozeni strankovani</span>
<a name="l00661"></a>00661 
<a name="l00662"></a>00662     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00663"></a>00663   }
<a name="l00664"></a>00664 
<a name="l00672"></a><a class="code" href="classDynamicNavstevniKniha.html#39430f0524a7580d7e2189a259d327b7">00672</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#39430f0524a7580d7e2189a259d327b7">ZjistiSablonuAdresy</a>($adresa)
<a name="l00673"></a>00673   {
<a name="l00674"></a>00674     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = 0;
<a name="l00675"></a>00675     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id</span>
<a name="l00676"></a>00676 <span class="stringliteral">                                      FROM sablona_kniha</span>
<a name="l00677"></a>00677 <span class="stringliteral">                                      WHERE adresa='{$adresa}';"</span>, NULL, $error))
<a name="l00678"></a>00678     {
<a name="l00679"></a>00679       <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l00680"></a>00680       {
<a name="l00681"></a>00681         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $res-&gt;fetchObject()-&gt;id;
<a name="l00682"></a>00682       }
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684       <span class="keywordflow">else</span>
<a name="l00685"></a>00685     {
<a name="l00686"></a>00686       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     settype(<a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>, <span class="stringliteral">"integer"</span>);
<a name="l00690"></a>00690 
<a name="l00691"></a>00691     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00692"></a>00692   }
<a name="l00693"></a>00693 
<a name="l00701"></a><a class="code" href="classDynamicNavstevniKniha.html#5ee521db4249c023545ed604c1df64de">00701</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#5ee521db4249c023545ed604c1df64de">VypisPridavaciFormular</a>($sablona, $tvar)
<a name="l00702"></a>00702   {
<a name="l00703"></a>00703     $typelementu = array_keys($this-&gt;element);
<a name="l00704"></a>00704 
<a name="l00705"></a>00705     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, sablona, typ, nazev, value,</span>
<a name="l00706"></a>00706 <span class="stringliteral">                                      input_id, input_class, input_akce,</span>
<a name="l00707"></a>00707 <span class="stringliteral">                                      povinne, skryt_obsah, vstupni_typ,</span>
<a name="l00708"></a>00708 <span class="stringliteral">                                      reg_exp, vystupni_format, min_val,</span>
<a name="l00709"></a>00709 <span class="stringliteral">                                      max_val, poradi</span>
<a name="l00710"></a>00710 <span class="stringliteral">                                      FROM element_kniha</span>
<a name="l00711"></a>00711 <span class="stringliteral">                                      WHERE</span>
<a name="l00712"></a>00712 <span class="stringliteral">                                      sablona={$sablona}</span>
<a name="l00713"></a>00713 <span class="stringliteral">                                      ORDER BY poradi ASC;"</span>, NULL, $error))
<a name="l00714"></a>00714     {
<a name="l00715"></a>00715       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l00716"></a>00716       {
<a name="l00717"></a>00717         $i = 0;
<a name="l00718"></a>00718         $pocetelem = $res-&gt;numRows();
<a name="l00719"></a>00719 
<a name="l00720"></a>00720         $vypis = array(<span class="stringliteral">"array_args"</span>,
<a name="l00721"></a>00721                       $this-&gt;absolutni_url,
<a name="l00722"></a>00722                       $this-&gt;dirpath,
<a name="l00723"></a>00723                       $sablona);
<a name="l00724"></a>00724 
<a name="l00725"></a>00725         <span class="keywordflow">while</span>($data = $res-&gt;fetchObject())
<a name="l00726"></a>00726         {
<a name="l00727"></a>00727           $povinne = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l00728"></a>00728 
<a name="l00729"></a>00729           $podminka[$i][<span class="stringliteral">"id"</span>] = $data-&gt;id;
<a name="l00730"></a>00730           $podminka[$i][<span class="stringliteral">"name"</span>] = <span class="stringliteral">"elem_{$data-&gt;id}"</span>; <span class="comment">//name elementu</span>
<a name="l00731"></a>00731           $podminka[$i][<span class="stringliteral">"nazev"</span>] = $data-&gt;nazev; <span class="comment">//nazev elementu</span>
<a name="l00732"></a>00732           $podminka[$i][<span class="stringliteral">"blok"</span>] = $data-&gt;value; <span class="comment">//jmeno elementu</span>
<a name="l00733"></a>00733           $podminka[$i][<span class="stringliteral">"typ"</span>] = $typelementu[$data-&gt;typ];  <span class="comment">//textove oznaceni typu</span>
<a name="l00734"></a>00734           $podminka[$i][<span class="stringliteral">"povinne"</span>] = $data-&gt;povinne;  <span class="comment">//bool vyraz povinne</span>
<a name="l00735"></a>00735           $podminka[$i][<span class="stringliteral">"vstup"</span>] = $this-&gt;vstupni_typ[$data-&gt;vstupni_typ];  <span class="comment">//typ vstupu</span>
<a name="l00736"></a>00736           $podminka[$i][<span class="stringliteral">"reg_exp"</span>] = $data-&gt;reg_exp;  <span class="comment">//regularni vyraz</span>
<a name="l00737"></a>00737           $podminka[$i][<span class="stringliteral">"min"</span>] = $data-&gt;min_val;  <span class="comment">//minimalni pocet</span>
<a name="l00738"></a>00738           $podminka[$i][<span class="stringliteral">"max"</span>] = $data-&gt;max_val;  <span class="comment">//maximalni pocet</span>
<a name="l00739"></a>00739           $podminka[$i][<span class="stringliteral">"chyba"</span>] = <span class="stringliteral">""</span>;
<a name="l00740"></a>00740           $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = <span class="stringliteral">""</span>;
<a name="l00741"></a>00741 
<a name="l00742"></a>00742           $input_id = (!Empty($data-&gt;input_id) ? $data-&gt;input_id : <span class="stringliteral">""</span>);
<a name="l00743"></a>00743           $input_class = (!Empty($data-&gt;input_id) ? $data-&gt;input_class : <span class="stringliteral">""</span>);
<a name="l00744"></a>00744           $input_akce = (!Empty($data-&gt;input_id) ? $data-&gt;input_akce : <span class="stringliteral">""</span>);
<a name="l00745"></a>00745 
<a name="l00746"></a>00746           <span class="keywordflow">switch</span> ($typelementu[$data-&gt;typ])
<a name="l00747"></a>00747           {
<a name="l00748"></a>00748             <span class="keywordflow">case</span> <span class="stringliteral">"nadpis"</span>: <span class="comment">//nadpis</span>
<a name="l00749"></a>00749             <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>: <span class="comment">//text</span>
<a name="l00750"></a>00750               $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden_{$tvar}"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l00751"></a>00751               $value = (!Empty($_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]) ? $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>] : $data-&gt;value);
<a name="l00752"></a>00752 
<a name="l00753"></a>00753               $vypis[] = $data-&gt;id;
<a name="l00754"></a>00754               $vypis[] = <span class="stringliteral">" name=\"elem_{$data-&gt;id}\""</span>;
<a name="l00755"></a>00755               $vypis[] = $value;
<a name="l00756"></a>00756               $vypis[] = <span class="stringliteral">" onfocus=\"this.value=(this.value == '{$value}' ? '' : this.value);\" onblur=\"this.value=(this.value == '' ? '{$value}' : this.value);\""</span>;
<a name="l00757"></a>00757               $vypis[] = $input_id;
<a name="l00758"></a>00758               $vypis[] = $input_class;
<a name="l00759"></a>00759               $vypis[] = $input_akce;
<a name="l00760"></a>00760               $vypis[] = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l00761"></a>00761             <span class="keywordflow">break</span>;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763             <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>: <span class="comment">//popisek</span>
<a name="l00764"></a>00764               $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden_{$tvar}"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l00765"></a>00765               $value = (!Empty($_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]) ? $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>] : $data-&gt;value);
<a name="l00766"></a>00766 
<a name="l00767"></a>00767               $vypis[] = $data-&gt;id;
<a name="l00768"></a>00768               $vypis[] = <span class="stringliteral">" name=\"elem_{$data-&gt;id}\""</span>;
<a name="l00769"></a>00769               $vypis[] = $value;
<a name="l00770"></a>00770               $vypis[] = <span class="stringliteral">" onfocus=\"this.value=(this.value == '{$value}' ? '' : this.value);\" onblur=\"this.value=(this.value == '' ? '{$value}' : this.value);\""</span>;
<a name="l00771"></a>00771               $vypis[] = $input_id;
<a name="l00772"></a>00772               $vypis[] = $input_class;
<a name="l00773"></a>00773               $vypis[] = $input_akce;
<a name="l00774"></a>00774               $vypis[] = ($data-&gt;skryt_obsah ? <span class="stringliteral">" name=\"skryt_elem_{$data-&gt;id}\""</span> : <span class="stringliteral">""</span>);
<a name="l00775"></a>00775               $vypis[] = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l00776"></a>00776             <span class="keywordflow">break</span>;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778             <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>: <span class="comment">//captcha kod</span>
<a name="l00779"></a>00779               <span class="keywordflow">if</span> (!$this-&gt;var-&gt;aktivniadmin)
<a name="l00780"></a>00780               {
<a name="l00781"></a>00781                 $slovo = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"CaptchaCode"</span>, <span class="stringliteral">"GenerujNahodneSlovo"</span>, $data-&gt;value); <span class="comment">//pro id 1</span>
<a name="l00782"></a>00782                 $captcha = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"CaptchaCode"</span>, <span class="stringliteral">"CaptchaKod"</span>, $data-&gt;value, $slovo);  <span class="comment">//pro id 1 se slovem</span>
<a name="l00783"></a>00783 
<a name="l00784"></a>00784                 $slovo = (is_array($slovo) ? $slovo[1] : $slovo);
<a name="l00785"></a>00785 
<a name="l00786"></a>00786                 $this-&gt;captchakod[$sablona][<span class="stringliteral">"id"</span>] = $data-&gt;value;
<a name="l00787"></a>00787                 $this-&gt;captchakod[$sablona][<span class="stringliteral">"captcha"</span>] = $captcha;
<a name="l00788"></a>00788                 $this-&gt;captchakod[$sablona][<span class="stringliteral">"slovo"</span>] = $slovo;
<a name="l00789"></a>00789               }
<a name="l00790"></a>00790 
<a name="l00791"></a>00791               $vypis[] = $data-&gt;id;
<a name="l00792"></a>00792               $vypis[] = <span class="stringliteral">" name=\"elem_{$data-&gt;id}\""</span>;
<a name="l00793"></a>00793               $vypis[] = $data-&gt;value;
<a name="l00794"></a>00794               $vypis[] = $captcha;
<a name="l00795"></a>00795               $vypis[] = $slovo;
<a name="l00796"></a>00796               $vypis[] = $input_id;
<a name="l00797"></a>00797               $vypis[] = $input_class;
<a name="l00798"></a>00798               $vypis[] = $input_akce;
<a name="l00799"></a>00799               $vypis[] = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l00800"></a>00800             <span class="keywordflow">break</span>;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802             <span class="keywordflow">case</span> <span class="stringliteral">"datum"</span>: <span class="comment">//datum</span>
<a name="l00803"></a>00803             <span class="keywordflow">case</span> <span class="stringliteral">"cas"</span>: <span class="comment">//cas</span>
<a name="l00804"></a>00804             <span class="keywordflow">case</span> <span class="stringliteral">"datumcas"</span>: <span class="comment">//datumcas</span>
<a name="l00805"></a>00805               $vypis[] = $data-&gt;id;
<a name="l00806"></a>00806               $vypis[] = <span class="stringliteral">" name=\"elem_{$data-&gt;id}\""</span>;
<a name="l00807"></a>00807               $vypis[] = date($data-&gt;vystupni_format);
<a name="l00808"></a>00808               $vypis[] = $input_id;
<a name="l00809"></a>00809               $vypis[] = $input_class;
<a name="l00810"></a>00810               $vypis[] = $input_akce;
<a name="l00811"></a>00811               $vypis[] = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l00812"></a>00812             <span class="keywordflow">break</span>;
<a name="l00813"></a>00813 
<a name="l00814"></a>00814             <span class="keywordflow">case</span> <span class="stringliteral">"checkbox"</span>: <span class="comment">//checkbox</span>
<a name="l00815"></a>00815               $val = htmlspecialchars_decode(html_entity_decode($data-&gt;value));
<a name="l00816"></a>00816 
<a name="l00817"></a>00817               $vypis[] = $data-&gt;id;
<a name="l00818"></a>00818               $vypis[] = <span class="stringliteral">" name=\"elem_{$data-&gt;id}\""</span>;
<a name="l00819"></a>00819               $vypis[] = $val;
<a name="l00820"></a>00820               $vypis[] = (!Empty($data-&gt;value) ? <span class="stringliteral">" value=\"{$val}\""</span> : <span class="stringliteral">""</span>);
<a name="l00821"></a>00821               $vypis[] = $input_id;
<a name="l00822"></a>00822               $vypis[] = $input_class;
<a name="l00823"></a>00823               $vypis[] = $input_akce;
<a name="l00824"></a>00824               $vypis[] = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l00825"></a>00825             <span class="keywordflow">break</span>;
<a name="l00826"></a>00826           }
<a name="l00827"></a>00827 
<a name="l00828"></a>00828           $i++;
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830       }
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832       <span class="keywordflow">else</span>
<a name="l00833"></a>00833     {
<a name="l00834"></a>00834       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l00835"></a>00835     }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837     $vypis[] = <span class="stringliteral">" name=\"tlacitko_kniha\""</span>;
<a name="l00838"></a>00838     $vypis[] = (!Empty($_POST[<span class="stringliteral">"tlacitko_kniha"</span>]) ? <span class="stringliteral">" disabled=\"disabled\""</span> : <span class="stringliteral">""</span>);
<a name="l00839"></a>00839     $vypis[] = (!Empty($_POST[<span class="stringliteral">"tlacitko_kniha"</span>]) ? <span class="stringliteral">"_disabled"</span> : <span class="stringliteral">""</span>);
<a name="l00840"></a>00840 
<a name="l00841"></a>00841     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_addobsah_form_{$tvar}"</span>],
<a name="l00842"></a>00842                                         $vypis);
<a name="l00843"></a>00843 
<a name="l00844"></a>00844     $poc = 0;
<a name="l00845"></a>00845     $check = <span class="keyword">true</span>;
<a name="l00846"></a>00846     <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++) <span class="comment">//kontrola vyplneni</span>
<a name="l00847"></a>00847     {
<a name="l00848"></a>00848       $zpost = $_POST[$podminka[$i][<span class="stringliteral">"name"</span>]];
<a name="l00849"></a>00849 
<a name="l00850"></a>00850       <span class="comment">//jmeno pro error hlasku</span>
<a name="l00851"></a>00851       $error_nazev = ($podminka[$i][<span class="stringliteral">"nazev"</span>][strlen($podminka[$i][<span class="stringliteral">"nazev"</span>]) - 1] == <span class="stringliteral">":"</span> ? substr($podminka[$i][<span class="stringliteral">"nazev"</span>], 0, -1) : $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l00852"></a>00852 
<a name="l00853"></a>00853       <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"typ"</span>]) <span class="comment">//rozliseni kontroly podle typu</span>
<a name="l00854"></a>00854       {
<a name="l00855"></a>00855         <span class="keywordflow">case</span> <span class="stringliteral">"nadpis"</span>:
<a name="l00856"></a>00856         <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>:
<a name="l00857"></a>00857         <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>:
<a name="l00858"></a>00858           <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"vstup"</span>])
<a name="l00859"></a>00859           {
<a name="l00860"></a>00860             <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>:  <span class="comment">//konvert textu</span>
<a name="l00861"></a>00861               settype($zpost, <span class="stringliteral">"string"</span>);
<a name="l00862"></a>00862 
<a name="l00863"></a>00863               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l00864"></a>00864               {
<a name="l00865"></a>00865                 $zpost = <span class="stringliteral">""</span>;
<a name="l00866"></a>00866                 $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty_{$tvar}"</span>], $error_nazev) : <span class="stringliteral">""</span>);
<a name="l00867"></a>00867               }
<a name="l00868"></a>00868                 <span class="keywordflow">else</span>
<a name="l00869"></a>00869               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0 &amp;&amp;
<a name="l00870"></a>00870                   $podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)
<a name="l00871"></a>00871               {
<a name="l00872"></a>00872                 <span class="keywordflow">if</span> (strlen($zpost) &lt; $podminka[$i][<span class="stringliteral">"min"</span>] ||
<a name="l00873"></a>00873                     strlen($zpost) &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l00874"></a>00874                 {
<a name="l00875"></a>00875                   $zpost = <span class="stringliteral">""</span>;
<a name="l00876"></a>00876                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_max_{$tvar}"</span>], $error_nazev);
<a name="l00877"></a>00877                 }
<a name="l00878"></a>00878               }
<a name="l00879"></a>00879                 <span class="keywordflow">else</span>
<a name="l00880"></a>00880               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0)  <span class="comment">//kontrola minina</span>
<a name="l00881"></a>00881               {
<a name="l00882"></a>00882                 <span class="keywordflow">if</span> (strlen($zpost) &lt; $podminka[$i][<span class="stringliteral">"min"</span>])
<a name="l00883"></a>00883                 {
<a name="l00884"></a>00884                   $zpost = <span class="stringliteral">""</span>;
<a name="l00885"></a>00885                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_{$tvar}"</span>], $error_nazev);
<a name="l00886"></a>00886                 }
<a name="l00887"></a>00887               }
<a name="l00888"></a>00888                 <span class="keywordflow">else</span>
<a name="l00889"></a>00889               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)  <span class="comment">//kontrola maxima</span>
<a name="l00890"></a>00890               {
<a name="l00891"></a>00891                 <span class="keywordflow">if</span> (strlen($zpost) &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l00892"></a>00892                 {
<a name="l00893"></a>00893                   $zpost = <span class="stringliteral">""</span>;
<a name="l00894"></a>00894                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_max_{$tvar}"</span>], $error_nazev);
<a name="l00895"></a>00895                 }
<a name="l00896"></a>00896               }
<a name="l00897"></a>00897             <span class="keywordflow">break</span>;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899             <span class="keywordflow">case</span> <span class="stringliteral">"integer"</span>: <span class="comment">//konvert cisla</span>
<a name="l00900"></a>00900               settype($zpost, <span class="stringliteral">"integer"</span>);
<a name="l00901"></a>00901 
<a name="l00902"></a>00902               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l00903"></a>00903               {
<a name="l00904"></a>00904                 $zpost = <span class="stringliteral">""</span>;
<a name="l00905"></a>00905                 $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty_{$tvar}"</span>], $error_nazev) : <span class="stringliteral">""</span>);
<a name="l00906"></a>00906               }
<a name="l00907"></a>00907                 <span class="keywordflow">else</span>
<a name="l00908"></a>00908               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0 &amp;&amp;
<a name="l00909"></a>00909                   $podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)
<a name="l00910"></a>00910               {
<a name="l00911"></a>00911                 <span class="keywordflow">if</span> ($zpost &lt; $podminka[$i][<span class="stringliteral">"min"</span>] ||  <span class="comment">//kontrola hodnoty cisel</span>
<a name="l00912"></a>00912                     $zpost &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l00913"></a>00913                 {
<a name="l00914"></a>00914                   $zpost = <span class="stringliteral">""</span>;
<a name="l00915"></a>00915                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_max_{$tvar}"</span>], $error_nazev);
<a name="l00916"></a>00916                 }
<a name="l00917"></a>00917               }
<a name="l00918"></a>00918                 <span class="keywordflow">else</span>
<a name="l00919"></a>00919               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0)  <span class="comment">//kontrola minina</span>
<a name="l00920"></a>00920               {
<a name="l00921"></a>00921                 <span class="keywordflow">if</span> ($zpost &lt; $podminka[$i][<span class="stringliteral">"min"</span>])
<a name="l00922"></a>00922                 {
<a name="l00923"></a>00923                   $zpost = <span class="stringliteral">""</span>;
<a name="l00924"></a>00924                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_{$tvar}"</span>], $error_nazev);
<a name="l00925"></a>00925                 }
<a name="l00926"></a>00926               }
<a name="l00927"></a>00927                 <span class="keywordflow">else</span>
<a name="l00928"></a>00928               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)  <span class="comment">//kontrola maxima</span>
<a name="l00929"></a>00929               {
<a name="l00930"></a>00930                 <span class="keywordflow">if</span> ($zpost &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l00931"></a>00931                 {
<a name="l00932"></a>00932                   $zpost = <span class="stringliteral">""</span>;
<a name="l00933"></a>00933                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_max_{$tvar}"</span>], $error_nazev);
<a name="l00934"></a>00934                 }
<a name="l00935"></a>00935               }
<a name="l00936"></a>00936             <span class="keywordflow">break</span>;
<a name="l00937"></a>00937 
<a name="l00938"></a>00938             <span class="keywordflow">case</span> <span class="stringliteral">"reg_exp"</span>: <span class="comment">//konrola reg_exp</span>
<a name="l00939"></a>00939               <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l00940"></a>00940               {
<a name="l00941"></a>00941                 $zpost = <span class="stringliteral">""</span>;
<a name="l00942"></a>00942                 $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty_{$tvar}"</span>], $error_nazev) : <span class="stringliteral">""</span>);
<a name="l00943"></a>00943                 <span class="keywordflow">break</span>;
<a name="l00944"></a>00944               }
<a name="l00945"></a>00945                 <span class="keywordflow">else</span>
<a name="l00946"></a>00946               {
<a name="l00947"></a>00947                 preg_match($podminka[$i][<span class="stringliteral">"reg_exp"</span>], $zpost, $ret);
<a name="l00948"></a>00948                 $zpost = $ret[0];  <span class="comment">//vybere nulty index</span>
<a name="l00949"></a>00949 
<a name="l00950"></a>00950                 <span class="keywordflow">if</span> (Empty($zpost))
<a name="l00951"></a>00951                 {
<a name="l00952"></a>00952                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_reg_exp_{$tvar}"</span>], $error_nazev);
<a name="l00953"></a>00953                 }
<a name="l00954"></a>00954               }
<a name="l00955"></a>00955             <span class="keywordflow">break</span>;
<a name="l00956"></a>00956           }
<a name="l00957"></a>00957 
<a name="l00958"></a>00958           <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l00959"></a>00959           {
<a name="l00960"></a>00960             $check = <span class="keyword">false</span>;
<a name="l00961"></a>00961           }
<a name="l00962"></a>00962             <span class="keywordflow">else</span>
<a name="l00963"></a>00963           {
<a name="l00964"></a>00964             $poc++;
<a name="l00965"></a>00965           }
<a name="l00966"></a>00966         <span class="keywordflow">break</span>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968         <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>: <span class="comment">//kontrola $_POST</span>
<a name="l00969"></a>00969           $pridavek = (is_array($_SESSION[<span class="stringliteral">"slovo_{$this-&gt;captchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}"</span>]) ? <span class="stringliteral">"_solve"</span> : <span class="stringliteral">""</span>);
<a name="l00970"></a>00970 
<a name="l00971"></a>00971           <span class="keywordflow">if</span> (count($_POST) == 0 || $zpost != $_SESSION[<span class="stringliteral">"slovo_{$this-&gt;captchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>])
<a name="l00972"></a>00972           {
<a name="l00973"></a>00973             $_SESSION[<span class="stringliteral">"slovo_{$this-&gt;captchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>] = $_SESSION[<span class="stringliteral">"slovo_{$this-&gt;captchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}"</span>];
<a name="l00974"></a>00974           }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976           <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l00977"></a>00977           {
<a name="l00978"></a>00978             $check = <span class="keyword">false</span>;
<a name="l00979"></a>00979             $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty_captcha_{$tvar}"</span>]);  <span class="comment">//prazdna</span>
<a name="l00980"></a>00980           }
<a name="l00981"></a>00981             <span class="keywordflow">else</span>
<a name="l00982"></a>00982           {
<a name="l00983"></a>00983             <span class="keywordflow">if</span> ($zpost == $_SESSION[<span class="stringliteral">"slovo_{$this-&gt;captchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>])  <span class="comment">//turinguv stroj rozliseni cloveka</span>
<a name="l00984"></a>00984             {
<a name="l00985"></a>00985               $poc++;
<a name="l00986"></a>00986             }
<a name="l00987"></a>00987               <span class="keywordflow">else</span>
<a name="l00988"></a>00988             {
<a name="l00989"></a>00989               $check = <span class="keyword">false</span>;
<a name="l00990"></a>00990               $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_wrong_captcha_{$tvar}"</span>]);  <span class="comment">//spatne</span>
<a name="l00991"></a>00991             }
<a name="l00992"></a>00992           }
<a name="l00993"></a>00993         <span class="keywordflow">break</span>;
<a name="l00994"></a>00994 
<a name="l00995"></a>00995         <span class="keywordflow">default</span>:  <span class="comment">//kontrola $_POST</span>
<a name="l00996"></a>00996           <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l00997"></a>00997           {
<a name="l00998"></a>00998             $check = <span class="keyword">false</span>;
<a name="l00999"></a>00999             $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_unkown_{$tvar}"</span>], $podminka[$i][<span class="stringliteral">"name"</span>]);
<a name="l01000"></a>01000           }
<a name="l01001"></a>01001             <span class="keywordflow">else</span>
<a name="l01002"></a>01002           {
<a name="l01003"></a>01003             $poc++;
<a name="l01004"></a>01004           }
<a name="l01005"></a>01005         <span class="keywordflow">break</span>;
<a name="l01006"></a>01006       }
<a name="l01007"></a>01007     }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009     <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l01010"></a>01010         isset($_POST[$podminka[0][<span class="stringliteral">"name"</span>]]) &amp;&amp;
<a name="l01011"></a>01011         !$this-&gt;var-&gt;aktivniadmin &amp;&amp;
<a name="l01012"></a>01012         $poc == $pocetelem)
<a name="l01013"></a>01013     {
<a name="l01014"></a>01014       $ukladani[] = <span class="stringliteral">""</span>;
<a name="l01015"></a>01015       <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++)
<a name="l01016"></a>01016       {
<a name="l01017"></a>01017         <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"typ"</span>])
<a name="l01018"></a>01018         {
<a name="l01019"></a>01019           <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>:
<a name="l01020"></a>01020             $ukl = array((!Empty($_POST[<span class="stringliteral">"skryt_{$podminka[$i]["</span>name<span class="stringliteral">"]}"</span>]) ? 1 : 0),
<a name="l01021"></a>01021                           stripslashes(htmlspecialchars($_POST[$podminka[$i][<span class="stringliteral">"name"</span>]], ENT_QUOTES)));
<a name="l01022"></a>01022 
<a name="l01023"></a>01023             $ukladani[$i] = implode(<span class="stringliteral">"||--x--||"</span>, $ukl);
<a name="l01024"></a>01024           <span class="keywordflow">break</span>;
<a name="l01025"></a>01025 
<a name="l01026"></a>01026           <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>:
<a name="l01027"></a>01027             $ukladani[$i] = $this-&gt;captchakod[$sablona][<span class="stringliteral">"id"</span>]; <span class="comment">//ulozi ID captchy a ne hodnotu!</span>
<a name="l01028"></a>01028           <span class="keywordflow">break</span>;
<a name="l01029"></a>01029 
<a name="l01030"></a>01030           <span class="keywordflow">default</span>:  <span class="comment">//rozdeleni hodnot</span>
<a name="l01031"></a>01031             $ukladani[$i] = stripslashes(htmlspecialchars($_POST[$podminka[$i][<span class="stringliteral">"name"</span>]], ENT_QUOTES));  <span class="comment">//osetreni textu!!</span>
<a name="l01032"></a>01032           <span class="keywordflow">break</span>;
<a name="l01033"></a>01033         }
<a name="l01034"></a>01034       }
<a name="l01035"></a>01035 
<a name="l01036"></a>01036       $ulozit = implode(<span class="stringliteral">"|-x-|"</span>, $ukladani);  <span class="comment">//ulozit do DB</span>
<a name="l01037"></a>01037       $datum = date(<span class="stringliteral">"Y-m-d H:i:s"</span>);
<a name="l01038"></a>01038 
<a name="l01039"></a>01039       <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"INSERT INTO obsah_sablony_kniha (id, sablona, obsah, pridano, zobrazit, admin) VALUES</span>
<a name="l01040"></a>01040 <span class="stringliteral">                                    (NULL, {$sablona}, '{$ulozit}', '{$datum}', 1, 0);"</span>, $error))
<a name="l01041"></a>01041       {
<a name="l01042"></a>01042         $rozdel = explode(<span class="stringliteral">"|-x-|"</span>, $ulozit);
<a name="l01043"></a>01043 
<a name="l01044"></a>01044         $vypis = array(<span class="stringliteral">"array_args"</span>,
<a name="l01045"></a>01045                       $this-&gt;absolutni_url,
<a name="l01046"></a>01046                       <span class="stringliteral">"{$this-&gt;absolutni_url}{$_GET[$this-&gt;var-&gt;get_kam]}"</span>);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048         <span class="keywordflow">for</span> ($j = 0; $j &lt; count($rozdel); $j++)
<a name="l01049"></a>01049         {
<a name="l01050"></a>01050           <span class="keywordflow">if</span> (count(explode(<span class="stringliteral">"||--x--||"</span>, $rozdel[$j])) == 2)
<a name="l01051"></a>01051           {
<a name="l01052"></a>01052             $zobr = explode(<span class="stringliteral">"||--x--||"</span>, $rozdel[$j]);
<a name="l01053"></a>01053 
<a name="l01054"></a>01054             $vypis[] = $zobr[1];
<a name="l01055"></a>01055           }
<a name="l01056"></a>01056             <span class="keywordflow">else</span>
<a name="l01057"></a>01057           {
<a name="l01058"></a>01058             $vypis[] = ($kontrola ? htmlspecialchars_decode(html_entity_decode($rozdel[$j])) : $rozdel[$j]);
<a name="l01059"></a>01059           }
<a name="l01060"></a>01060         }
<a name="l01061"></a>01061 
<a name="l01062"></a>01062         $dokonceno = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_addobsah_form_hlaska_{$tvar}"</span>],
<a name="l01063"></a>01063                                               $vypis);
<a name="l01064"></a>01064 
<a name="l01065"></a>01065         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_show_form_{$tvar}"</span>]))
<a name="l01066"></a>01066         {
<a name="l01067"></a>01067           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $dokonceno;  <span class="comment">//prida na konec</span>
<a name="l01068"></a>01068         }
<a name="l01069"></a>01069           <span class="keywordflow">else</span>
<a name="l01070"></a>01070         {
<a name="l01071"></a>01071           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $dokonceno; <span class="comment">//nahradi misto formulare</span>
<a name="l01072"></a>01072         }
<a name="l01073"></a>01073 
<a name="l01074"></a>01074         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_autoklik_{$tvar}"</span>]))
<a name="l01075"></a>01075         {
<a name="l01076"></a>01076           $this-&gt;var-&gt;main[0]-&gt;AutoClick($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_time_autoklik_{$tvar}"</span>]), <span class="stringliteral">"{$this-&gt;absolutni_url}{$_GET[$this-&gt;var-&gt;get_kam]}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l01077"></a>01077         }
<a name="l01078"></a>01078       }
<a name="l01079"></a>01079         <span class="keywordflow">else</span>
<a name="l01080"></a>01080       {
<a name="l01081"></a>01081         $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l01082"></a>01082       }
<a name="l01083"></a>01083     }
<a name="l01084"></a>01084       <span class="keywordflow">else</span>
<a name="l01085"></a>01085     {
<a name="l01086"></a>01086       <span class="keywordflow">if</span> (count($_POST) &gt; 0)
<a name="l01087"></a>01087       {
<a name="l01088"></a>01088         $chyba = <span class="stringliteral">""</span>;
<a name="l01089"></a>01089         $chyba_form = <span class="stringliteral">""</span>;
<a name="l01090"></a>01090         <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++)
<a name="l01091"></a>01091         {
<a name="l01092"></a>01092           $chyba .= $podminka[$i][<span class="stringliteral">"chyba"</span>];
<a name="l01093"></a>01093           $chyba_form .= $podminka[$i][<span class="stringliteral">"chyba_form"</span>];
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096         <span class="keywordflow">if</span> (Empty($_POST[<span class="stringliteral">"error_tlacitko"</span>]))
<a name="l01097"></a>01097         {
<a name="l01098"></a>01098           $error_button = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_button_{$tvar}"</span>]);
<a name="l01099"></a>01099         }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_end_{$tvar}"</span>],
<a name="l01102"></a>01102                                             $chyba,
<a name="l01103"></a>01103                                             $chyba_form,
<a name="l01104"></a>01104                                             $error_button,
<a name="l01105"></a>01105                                             <span class="stringliteral">"{$this-&gt;absolutni_url}{$_GET[$this-&gt;var-&gt;get_kam]}"</span>);
<a name="l01106"></a>01106 
<a name="l01107"></a>01107         <span class="comment">//$this-&gt;var-&gt;main[0]-&gt;AutoClick(5, "?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}");  //auto kliknuti</span>
<a name="l01108"></a>01108       }
<a name="l01109"></a>01109     }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01112"></a>01112   }
<a name="l01113"></a>01113 
<a name="l01121"></a><a class="code" href="classDynamicNavstevniKniha.html#bce8a9fa6361b55ca6a00198695eebde">01121</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#bce8a9fa6361b55ca6a00198695eebde">AdminObsahSablony</a>($sablona)
<a name="l01122"></a>01122   {
<a name="l01123"></a>01123     settype($sablona, <span class="stringliteral">"integer"</span>);
<a name="l01124"></a>01124 
<a name="l01125"></a>01125     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_obsah_sablony"</span>],
<a name="l01126"></a>01126                                         <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}&amp;amp;co=addobsah"</span>,
<a name="l01127"></a>01127                                         $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#9da7bfa6d1729763a1ac5fbc07036e19">VypisPopisku</a>($sablona),
<a name="l01128"></a>01128                                         $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#67f4f0ad390f56983f84d4d7953cb3c4">AdminVypisObsahSablony</a>($sablona));
<a name="l01129"></a>01129 
<a name="l01130"></a>01130     $typelementu = array_keys($this-&gt;element);
<a name="l01131"></a>01131 
<a name="l01132"></a>01132     $co = $_GET[<span class="stringliteral">"co"</span>];
<a name="l01133"></a>01133 
<a name="l01134"></a>01134     <span class="keywordflow">if</span> (!Empty($co))
<a name="l01135"></a>01135     {
<a name="l01136"></a>01136       <span class="keywordflow">switch</span> ($co)
<a name="l01137"></a>01137       {
<a name="l01138"></a>01138         <span class="keywordflow">case</span> <span class="stringliteral">"addobsah"</span>:  <span class="comment">//pridavani obsahu</span>
<a name="l01139"></a>01139           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, sablona, typ, nazev, value,</span>
<a name="l01140"></a>01140 <span class="stringliteral">                                            input_id, input_class, input_akce,</span>
<a name="l01141"></a>01141 <span class="stringliteral">                                            povinne, skryt_obsah, vstupni_typ,</span>
<a name="l01142"></a>01142 <span class="stringliteral">                                            reg_exp, vystupni_format, min_val,</span>
<a name="l01143"></a>01143 <span class="stringliteral">                                            max_val, poradi</span>
<a name="l01144"></a>01144 <span class="stringliteral">                                            FROM element_kniha</span>
<a name="l01145"></a>01145 <span class="stringliteral">                                            WHERE sablona={$sablona}</span>
<a name="l01146"></a>01146 <span class="stringliteral">                                            ORDER BY poradi ASC;"</span>, NULL, $error))
<a name="l01147"></a>01147           {
<a name="l01148"></a>01148             <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l01149"></a>01149             {
<a name="l01150"></a>01150               <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> = <span class="stringliteral">""</span>;
<a name="l01151"></a>01151               $i = 0;
<a name="l01152"></a>01152               $pocetelem = $res-&gt;numRows();
<a name="l01153"></a>01153               $poradielem = 7;  <span class="comment">//+7</span>
<a name="l01154"></a>01154               <span class="keywordflow">while</span>($data = $res-&gt;fetchObject())
<a name="l01155"></a>01155               {
<a name="l01156"></a>01156                 $povinne = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l01157"></a>01157 
<a name="l01158"></a>01158                 $podminka[$i][<span class="stringliteral">"id"</span>] = $data-&gt;id;
<a name="l01159"></a>01159                 $podminka[$i][<span class="stringliteral">"name"</span>] = <span class="stringliteral">"elem_{$data-&gt;id}"</span>; <span class="comment">//name elementu</span>
<a name="l01160"></a>01160                 $podminka[$i][<span class="stringliteral">"nazev"</span>] = $data-&gt;nazev; <span class="comment">//nazev elementu</span>
<a name="l01161"></a>01161                 $podminka[$i][<span class="stringliteral">"blok"</span>] = $data-&gt;value; <span class="comment">//jmeno elementu</span>
<a name="l01162"></a>01162                 $podminka[$i][<span class="stringliteral">"typ"</span>] = $typelementu[$data-&gt;typ];  <span class="comment">//textove oznaceni typu</span>
<a name="l01163"></a>01163                 $podminka[$i][<span class="stringliteral">"povinne"</span>] = $data-&gt;povinne;  <span class="comment">//bool vyraz povinne</span>
<a name="l01164"></a>01164                 $podminka[$i][<span class="stringliteral">"vstup"</span>] = $this-&gt;vstupni_typ[$data-&gt;vstupni_typ];  <span class="comment">//typ vstupu</span>
<a name="l01165"></a>01165                 $podminka[$i][<span class="stringliteral">"reg_exp"</span>] = $data-&gt;reg_exp;  <span class="comment">//regularni vyraz</span>
<a name="l01166"></a>01166                 $podminka[$i][<span class="stringliteral">"min"</span>] = $data-&gt;min_val;  <span class="comment">//minimalni pocet</span>
<a name="l01167"></a>01167                 $podminka[$i][<span class="stringliteral">"max"</span>] = $data-&gt;max_val;  <span class="comment">//maximalni pocet</span>
<a name="l01168"></a>01168                 $podminka[$i][<span class="stringliteral">"chyba"</span>] = <span class="stringliteral">""</span>;
<a name="l01169"></a>01169                 $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = <span class="stringliteral">""</span>;
<a name="l01170"></a>01170 
<a name="l01171"></a>01171                 $input_id = (!Empty($data-&gt;input_id) ? $data-&gt;input_id : <span class="stringliteral">""</span>);
<a name="l01172"></a>01172                 $input_class = (!Empty($data-&gt;input_id) ? $data-&gt;input_class : <span class="stringliteral">""</span>);
<a name="l01173"></a>01173                 $input_akce = (!Empty($data-&gt;input_id) ? $data-&gt;input_akce : <span class="stringliteral">""</span>);
<a name="l01174"></a>01174 
<a name="l01175"></a>01175                 <span class="keywordflow">switch</span> ($typelementu[$data-&gt;typ])
<a name="l01176"></a>01176                 {
<a name="l01177"></a>01177                   <span class="keywordflow">case</span> <span class="stringliteral">"nadpis"</span>: <span class="comment">//nadpis</span>
<a name="l01178"></a>01178                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01179"></a>01179                     $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l01180"></a>01180                     $value = (!Empty($_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]) ? $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>] : $data-&gt;value);
<a name="l01181"></a>01181 
<a name="l01182"></a>01182                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_nadpis"</span>],
<a name="l01183"></a>01183                                                           $data-&gt;nazev,
<a name="l01184"></a>01184                                                           $data-&gt;id,
<a name="l01185"></a>01185                                                           $value,
<a name="l01186"></a>01186                                                           <span class="stringliteral">" onfocus=\"this.value=(this.value == '{$value}' ? '' : this.value);\" onblur=\"this.value=(this.value == '' ? '{$value}' : this.value);\""</span>,
<a name="l01187"></a>01187                                                           $input_id,
<a name="l01188"></a>01188                                                           $input_class,
<a name="l01189"></a>01189                                                           $input_akce,
<a name="l01190"></a>01190                                                           $povinne,
<a name="l01191"></a>01191                                                           $poradielem);
<a name="l01192"></a>01192                   <span class="keywordflow">break</span>;
<a name="l01193"></a>01193 
<a name="l01194"></a>01194                   <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>: <span class="comment">//popisek</span>
<a name="l01195"></a>01195                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01196"></a>01196                     $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l01197"></a>01197                     $value = (!Empty($_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]) ? $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>] : $data-&gt;value);
<a name="l01198"></a>01198 
<a name="l01199"></a>01199                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_popisek"</span>],
<a name="l01200"></a>01200                                                           $data-&gt;nazev,
<a name="l01201"></a>01201                                                           $data-&gt;id,
<a name="l01202"></a>01202                                                           $value,
<a name="l01203"></a>01203                                                           <span class="stringliteral">" onfocus=\"this.value=(this.value == '{$value}' ? '' : this.value);\" onblur=\"this.value=(this.value == '' ? '{$value}' : this.value);\""</span>,
<a name="l01204"></a>01204                                                           $input_id,
<a name="l01205"></a>01205                                                           $input_class,
<a name="l01206"></a>01206                                                           $input_akce,
<a name="l01207"></a>01207                                                           $povinne,
<a name="l01208"></a>01208                                                           $poradielem,
<a name="l01209"></a>01209                                                           ($data-&gt;skryt_obsah ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_skryt_obsah"</span>],
<a name="l01210"></a>01210                                                                                                           $data-&gt;id,
<a name="l01211"></a>01211                                                                                                           <span class="stringliteral">""</span>) : <span class="stringliteral">""</span>),
<a name="l01212"></a>01212                                                           $sablona);
<a name="l01213"></a>01213                   <span class="keywordflow">break</span>;
<a name="l01214"></a>01214 
<a name="l01215"></a>01215                   <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>: <span class="comment">//text</span>
<a name="l01216"></a>01216                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01217"></a>01217                     $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l01218"></a>01218                     $value = (!Empty($_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]) ? $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>] : $data-&gt;value);
<a name="l01219"></a>01219 
<a name="l01220"></a>01220                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_text"</span>],
<a name="l01221"></a>01221                                                           $data-&gt;nazev,
<a name="l01222"></a>01222                                                           $data-&gt;id,
<a name="l01223"></a>01223                                                           $value,
<a name="l01224"></a>01224                                                           <span class="stringliteral">" onfocus=\"this.value=(this.value == '{$value}' ? '' : this.value);\" onblur=\"this.value=(this.value == '' ? '{$value}' : this.value);\""</span>,
<a name="l01225"></a>01225                                                           $input_id,
<a name="l01226"></a>01226                                                           $input_class,
<a name="l01227"></a>01227                                                           $input_akce,
<a name="l01228"></a>01228                                                           $povinne,
<a name="l01229"></a>01229                                                           $poradielem);
<a name="l01230"></a>01230                   <span class="keywordflow">break</span>;
<a name="l01231"></a>01231 
<a name="l01232"></a>01232                   <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>: <span class="comment">//captcha kod</span>
<a name="l01233"></a>01233                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01234"></a>01234 
<a name="l01235"></a>01235                     <span class="keywordflow">if</span> ($this-&gt;var-&gt;aktivniadmin)
<a name="l01236"></a>01236                     {
<a name="l01237"></a>01237                       $slovo = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"CaptchaCode"</span>, <span class="stringliteral">"GenerujNahodneSlovo"</span>, $data-&gt;value); <span class="comment">//pro id 1</span>
<a name="l01238"></a>01238                       $captcha = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"CaptchaCode"</span>, <span class="stringliteral">"CaptchaKod"</span>, $data-&gt;value, $slovo);  <span class="comment">//pro id 1 se slovem</span>
<a name="l01239"></a>01239 
<a name="l01240"></a>01240                       $slovo = (is_array($slovo) ? $slovo[1] : $slovo);
<a name="l01241"></a>01241 
<a name="l01242"></a>01242                       $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"id"</span>] = $data-&gt;value;
<a name="l01243"></a>01243                       $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"captcha"</span>] = $captcha;
<a name="l01244"></a>01244                       $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"slovo"</span>] = $slovo;
<a name="l01245"></a>01245                     }
<a name="l01246"></a>01246 
<a name="l01247"></a>01247                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_captcha"</span>],
<a name="l01248"></a>01248                                                           $data-&gt;nazev,
<a name="l01249"></a>01249                                                           $data-&gt;id,
<a name="l01250"></a>01250                                                           $data-&gt;value,
<a name="l01251"></a>01251                                                           $slovo,
<a name="l01252"></a>01252                                                           $captcha,
<a name="l01253"></a>01253                                                           $input_id,
<a name="l01254"></a>01254                                                           $input_class,
<a name="l01255"></a>01255                                                           $input_akce,
<a name="l01256"></a>01256                                                           $povinne,
<a name="l01257"></a>01257                                                           $poradielem);
<a name="l01258"></a>01258                   <span class="keywordflow">break</span>;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260                   <span class="keywordflow">case</span> <span class="stringliteral">"datum"</span>: <span class="comment">//datum</span>
<a name="l01261"></a>01261                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01262"></a>01262                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_datum"</span>],
<a name="l01263"></a>01263                                                           $data-&gt;nazev,
<a name="l01264"></a>01264                                                           $data-&gt;id,
<a name="l01265"></a>01265                                                           date($data-&gt;vystupni_format),<span class="comment">//$data-&gt;value,</span>
<a name="l01266"></a>01266                                                           $input_id,
<a name="l01267"></a>01267                                                           $input_class,
<a name="l01268"></a>01268                                                           $input_akce,
<a name="l01269"></a>01269                                                           $povinne,
<a name="l01270"></a>01270                                                           $data-&gt;vystupni_format,
<a name="l01271"></a>01271                                                           date($data-&gt;vystupni_format),
<a name="l01272"></a>01272                                                           $poradielem);
<a name="l01273"></a>01273                   <span class="keywordflow">break</span>;
<a name="l01274"></a>01274 
<a name="l01275"></a>01275                   <span class="keywordflow">case</span> <span class="stringliteral">"cas"</span>: <span class="comment">//cas</span>
<a name="l01276"></a>01276                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01277"></a>01277                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_cas"</span>],
<a name="l01278"></a>01278                                                           $data-&gt;nazev,
<a name="l01279"></a>01279                                                           $data-&gt;id,
<a name="l01280"></a>01280                                                           date($data-&gt;vystupni_format),<span class="comment">//$data-&gt;value,</span>
<a name="l01281"></a>01281                                                           $input_id,
<a name="l01282"></a>01282                                                           $input_class,
<a name="l01283"></a>01283                                                           $input_akce,
<a name="l01284"></a>01284                                                           $povinne,
<a name="l01285"></a>01285                                                           $data-&gt;vystupni_format,
<a name="l01286"></a>01286                                                           date($data-&gt;vystupni_format),
<a name="l01287"></a>01287                                                           $poradielem);
<a name="l01288"></a>01288                   <span class="keywordflow">break</span>;
<a name="l01289"></a>01289 
<a name="l01290"></a>01290                   <span class="keywordflow">case</span> <span class="stringliteral">"datumcas"</span>: <span class="comment">//datumcas</span>
<a name="l01291"></a>01291                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01292"></a>01292                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_datumcas"</span>],
<a name="l01293"></a>01293                                                           $data-&gt;nazev,
<a name="l01294"></a>01294                                                           $data-&gt;id,
<a name="l01295"></a>01295                                                           date($data-&gt;vystupni_format),<span class="comment">//$data-&gt;value,</span>
<a name="l01296"></a>01296                                                           $input_id,
<a name="l01297"></a>01297                                                           $input_class,
<a name="l01298"></a>01298                                                           $input_akce,
<a name="l01299"></a>01299                                                           $povinne,
<a name="l01300"></a>01300                                                           $data-&gt;vystupni_format,
<a name="l01301"></a>01301                                                           date($data-&gt;vystupni_format),
<a name="l01302"></a>01302                                                           $poradielem);
<a name="l01303"></a>01303                   <span class="keywordflow">break</span>;
<a name="l01304"></a>01304 
<a name="l01305"></a>01305                   <span class="keywordflow">case</span> <span class="stringliteral">"checkbox"</span>: <span class="comment">//checkbox</span>
<a name="l01306"></a>01306                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01307"></a>01307                     $val = htmlspecialchars_decode(html_entity_decode($data-&gt;value));
<a name="l01308"></a>01308                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_checkbox"</span>],
<a name="l01309"></a>01309                                                           $data-&gt;nazev,
<a name="l01310"></a>01310                                                           $data-&gt;id,
<a name="l01311"></a>01311                                                           (!Empty($data-&gt;value) ? <span class="stringliteral">" value=\"{$val}\""</span> : <span class="stringliteral">""</span>),
<a name="l01312"></a>01312                                                           $input_id,
<a name="l01313"></a>01313                                                           $input_class,
<a name="l01314"></a>01314                                                           $input_akce,
<a name="l01315"></a>01315                                                           $povinne,
<a name="l01316"></a>01316                                                           <span class="stringliteral">""</span>,
<a name="l01317"></a>01317                                                           $poradielem);
<a name="l01318"></a>01318                   <span class="keywordflow">break</span>;
<a name="l01319"></a>01319                 }
<a name="l01320"></a>01320 
<a name="l01321"></a>01321                 $i++;
<a name="l01322"></a>01322               }
<a name="l01323"></a>01323             }
<a name="l01324"></a>01324           }
<a name="l01325"></a>01325             <span class="keywordflow">else</span>
<a name="l01326"></a>01326           {
<a name="l01327"></a>01327             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l01328"></a>01328           }
<a name="l01329"></a>01329 
<a name="l01330"></a>01330           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addobsah_form"</span>],
<a name="l01331"></a>01331                                               <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a>,
<a name="l01332"></a>01332                                               $this-&gt;dirpath,
<a name="l01333"></a>01333                                               (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) ? <span class="stringliteral">" disabled=\"disabled\""</span> : <span class="stringliteral">""</span>));
<a name="l01334"></a>01334 
<a name="l01335"></a>01335           $poc = 0;
<a name="l01336"></a>01336           $check = <span class="keyword">true</span>;
<a name="l01337"></a>01337           <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++) <span class="comment">//kontrola vyplneni</span>
<a name="l01338"></a>01338           {
<a name="l01339"></a>01339             $zpost = $_POST[$podminka[$i][<span class="stringliteral">"name"</span>]];
<a name="l01340"></a>01340 
<a name="l01341"></a>01341             <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"typ"</span>]) <span class="comment">//rozliseni kontroly podle typu</span>
<a name="l01342"></a>01342             {
<a name="l01343"></a>01343               <span class="keywordflow">case</span> <span class="stringliteral">"nadpis"</span>:
<a name="l01344"></a>01344               <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>:
<a name="l01345"></a>01345               <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>:
<a name="l01346"></a>01346                 <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"vstup"</span>])
<a name="l01347"></a>01347                 {
<a name="l01348"></a>01348                   <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>:  <span class="comment">//konvert textu</span>
<a name="l01349"></a>01349                     settype($zpost, <span class="stringliteral">"string"</span>);
<a name="l01350"></a>01350 
<a name="l01351"></a>01351                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l01352"></a>01352                     {
<a name="l01353"></a>01353                       $zpost = <span class="stringliteral">""</span>;
<a name="l01354"></a>01354                       $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]) : <span class="stringliteral">""</span>);
<a name="l01355"></a>01355                     }
<a name="l01356"></a>01356                       <span class="keywordflow">else</span>
<a name="l01357"></a>01357                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0 &amp;&amp;
<a name="l01358"></a>01358                         $podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)
<a name="l01359"></a>01359                     {
<a name="l01360"></a>01360                       <span class="keywordflow">if</span> (strlen($zpost) &lt; $podminka[$i][<span class="stringliteral">"min"</span>] ||
<a name="l01361"></a>01361                           strlen($zpost) &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01362"></a>01362                       {
<a name="l01363"></a>01363                         $zpost = <span class="stringliteral">""</span>;
<a name="l01364"></a>01364                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01365"></a>01365                       }
<a name="l01366"></a>01366                     }
<a name="l01367"></a>01367                       <span class="keywordflow">else</span>
<a name="l01368"></a>01368                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0)  <span class="comment">//kontrola minina</span>
<a name="l01369"></a>01369                     {
<a name="l01370"></a>01370                       <span class="keywordflow">if</span> (strlen($zpost) &lt; $podminka[$i][<span class="stringliteral">"min"</span>])
<a name="l01371"></a>01371                       {
<a name="l01372"></a>01372                         $zpost = <span class="stringliteral">""</span>;
<a name="l01373"></a>01373                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01374"></a>01374                       }
<a name="l01375"></a>01375                     }
<a name="l01376"></a>01376                       <span class="keywordflow">else</span>
<a name="l01377"></a>01377                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)  <span class="comment">//kontrola maxima</span>
<a name="l01378"></a>01378                     {
<a name="l01379"></a>01379                       <span class="keywordflow">if</span> (strlen($zpost) &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01380"></a>01380                       {
<a name="l01381"></a>01381                         $zpost = <span class="stringliteral">""</span>;
<a name="l01382"></a>01382                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01383"></a>01383                       }
<a name="l01384"></a>01384                     }
<a name="l01385"></a>01385                   <span class="keywordflow">break</span>;
<a name="l01386"></a>01386 
<a name="l01387"></a>01387                   <span class="keywordflow">case</span> <span class="stringliteral">"integer"</span>: <span class="comment">//konvert cisla</span>
<a name="l01388"></a>01388                     settype($zpost, <span class="stringliteral">"integer"</span>);
<a name="l01389"></a>01389 
<a name="l01390"></a>01390                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l01391"></a>01391                     {
<a name="l01392"></a>01392                       $zpost = <span class="stringliteral">""</span>;
<a name="l01393"></a>01393                       $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]) : <span class="stringliteral">""</span>);
<a name="l01394"></a>01394                     }
<a name="l01395"></a>01395                       <span class="keywordflow">else</span>
<a name="l01396"></a>01396                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0 &amp;&amp;
<a name="l01397"></a>01397                         $podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)
<a name="l01398"></a>01398                     {
<a name="l01399"></a>01399                       <span class="keywordflow">if</span> ($zpost &lt; $podminka[$i][<span class="stringliteral">"min"</span>] ||  <span class="comment">//kontrola hodnoty cisel</span>
<a name="l01400"></a>01400                           $zpost &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01401"></a>01401                       {
<a name="l01402"></a>01402                         $zpost = <span class="stringliteral">""</span>;
<a name="l01403"></a>01403                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01404"></a>01404                       }
<a name="l01405"></a>01405                     }
<a name="l01406"></a>01406                       <span class="keywordflow">else</span>
<a name="l01407"></a>01407                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0)  <span class="comment">//kontrola minina</span>
<a name="l01408"></a>01408                     {
<a name="l01409"></a>01409                       <span class="keywordflow">if</span> ($zpost &lt; $podminka[$i][<span class="stringliteral">"min"</span>])
<a name="l01410"></a>01410                       {
<a name="l01411"></a>01411                         $zpost = <span class="stringliteral">""</span>;
<a name="l01412"></a>01412                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01413"></a>01413                       }
<a name="l01414"></a>01414                     }
<a name="l01415"></a>01415                       <span class="keywordflow">else</span>
<a name="l01416"></a>01416                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)  <span class="comment">//kontrola maxima</span>
<a name="l01417"></a>01417                     {
<a name="l01418"></a>01418                       <span class="keywordflow">if</span> ($zpost &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01419"></a>01419                       {
<a name="l01420"></a>01420                         $zpost = <span class="stringliteral">""</span>;
<a name="l01421"></a>01421                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01422"></a>01422                       }
<a name="l01423"></a>01423                     }
<a name="l01424"></a>01424                   <span class="keywordflow">break</span>;
<a name="l01425"></a>01425 
<a name="l01426"></a>01426                   <span class="keywordflow">case</span> <span class="stringliteral">"reg_exp"</span>: <span class="comment">//konrola reg_exp</span>
<a name="l01427"></a>01427                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l01428"></a>01428                     {
<a name="l01429"></a>01429                       $zpost = <span class="stringliteral">""</span>;
<a name="l01430"></a>01430                       $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]) : <span class="stringliteral">""</span>);
<a name="l01431"></a>01431                       <span class="keywordflow">break</span>;
<a name="l01432"></a>01432                     }
<a name="l01433"></a>01433                       <span class="keywordflow">else</span>
<a name="l01434"></a>01434                     {
<a name="l01435"></a>01435                       preg_match($podminka[$i][<span class="stringliteral">"reg_exp"</span>], $zpost, $ret);
<a name="l01436"></a>01436                       $zpost = $ret[0];  <span class="comment">//vybere nulty index</span>
<a name="l01437"></a>01437 
<a name="l01438"></a>01438                       <span class="keywordflow">if</span> (Empty($zpost))
<a name="l01439"></a>01439                       {
<a name="l01440"></a>01440                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_reg_exp"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01441"></a>01441                       }
<a name="l01442"></a>01442                     }
<a name="l01443"></a>01443                   <span class="keywordflow">break</span>;
<a name="l01444"></a>01444                 }
<a name="l01445"></a>01445 
<a name="l01446"></a>01446                 <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l01447"></a>01447                 {
<a name="l01448"></a>01448                   $check = <span class="keyword">false</span>;
<a name="l01449"></a>01449                 }
<a name="l01450"></a>01450                   <span class="keywordflow">else</span>
<a name="l01451"></a>01451                 {
<a name="l01452"></a>01452                   $poc++;
<a name="l01453"></a>01453                 }
<a name="l01454"></a>01454               <span class="keywordflow">break</span>;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456               <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>: <span class="comment">//kontrola $_POST</span>
<a name="l01457"></a>01457                 $pridavek = (is_array($_SESSION[<span class="stringliteral">"slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}"</span>]) ? <span class="stringliteral">"_solve"</span> : <span class="stringliteral">""</span>);
<a name="l01458"></a>01458 
<a name="l01459"></a>01459                 <span class="keywordflow">if</span> (count($_POST) == 0 || $zpost != $_SESSION[<span class="stringliteral">"admin_slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>])
<a name="l01460"></a>01460                 {
<a name="l01461"></a>01461                   $_SESSION[<span class="stringliteral">"admin_slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>] = $_SESSION[<span class="stringliteral">"slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}"</span>];
<a name="l01462"></a>01462                 }
<a name="l01463"></a>01463 
<a name="l01464"></a>01464                 <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l01465"></a>01465                 {
<a name="l01466"></a>01466                   $check = <span class="keyword">false</span>;
<a name="l01467"></a>01467                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty_captcha"</span>]);  <span class="comment">//prazdna</span>
<a name="l01468"></a>01468                 }
<a name="l01469"></a>01469                   <span class="keywordflow">else</span>
<a name="l01470"></a>01470                 {
<a name="l01471"></a>01471                   <span class="keywordflow">if</span> ($zpost == $_SESSION[<span class="stringliteral">"admin_slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>])  <span class="comment">//turinguv stroj rozliseni cloveka</span>
<a name="l01472"></a>01472                   {
<a name="l01473"></a>01473                     $poc++;
<a name="l01474"></a>01474                   }
<a name="l01475"></a>01475                     <span class="keywordflow">else</span>
<a name="l01476"></a>01476                   {
<a name="l01477"></a>01477                     $check = <span class="keyword">false</span>;
<a name="l01478"></a>01478                     $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_wrong_captcha"</span>]);  <span class="comment">//spatne</span>
<a name="l01479"></a>01479                   }
<a name="l01480"></a>01480                 }
<a name="l01481"></a>01481               <span class="keywordflow">break</span>;
<a name="l01482"></a>01482 
<a name="l01483"></a>01483               <span class="keywordflow">default</span>:  <span class="comment">//kontrola $_POST</span>
<a name="l01484"></a>01484                 <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l01485"></a>01485                 {
<a name="l01486"></a>01486                   $check = <span class="keyword">false</span>;
<a name="l01487"></a>01487                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_unkown"</span>], $podminka[$i][<span class="stringliteral">"name"</span>]);
<a name="l01488"></a>01488                 }
<a name="l01489"></a>01489                   <span class="keywordflow">else</span>
<a name="l01490"></a>01490                 {
<a name="l01491"></a>01491                   $poc++;
<a name="l01492"></a>01492                 }
<a name="l01493"></a>01493               <span class="keywordflow">break</span>;
<a name="l01494"></a>01494             }
<a name="l01495"></a>01495           }
<a name="l01496"></a>01496 
<a name="l01497"></a>01497           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l01498"></a>01498               $poc == $pocetelem)
<a name="l01499"></a>01499           {
<a name="l01500"></a>01500             $ukladani[] = <span class="stringliteral">""</span>;
<a name="l01501"></a>01501             <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++)
<a name="l01502"></a>01502             {
<a name="l01503"></a>01503               <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"typ"</span>])
<a name="l01504"></a>01504               {
<a name="l01505"></a>01505                 <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>:
<a name="l01506"></a>01506                   $ukl = array((!Empty($_POST[<span class="stringliteral">"skryt_{$podminka[$i]["</span>name<span class="stringliteral">"]}"</span>]) ? 1 : 0),
<a name="l01507"></a>01507                                 stripslashes(htmlspecialchars($_POST[$podminka[$i][<span class="stringliteral">"name"</span>]], ENT_QUOTES)));
<a name="l01508"></a>01508 
<a name="l01509"></a>01509                   $ukladani[$i] = implode(<span class="stringliteral">"||--x--||"</span>, $ukl);
<a name="l01510"></a>01510                 <span class="keywordflow">break</span>;
<a name="l01511"></a>01511 
<a name="l01512"></a>01512                 <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>:
<a name="l01513"></a>01513                   $ukladani[$i] = $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"id"</span>]; <span class="comment">//ulozi ID captchy a ne hodnotu!</span>
<a name="l01514"></a>01514                 <span class="keywordflow">break</span>;
<a name="l01515"></a>01515 
<a name="l01516"></a>01516                 <span class="keywordflow">default</span>:  <span class="comment">//rozdeleni hodnot</span>
<a name="l01517"></a>01517                   $ukladani[$i] = stripslashes(htmlspecialchars($_POST[$podminka[$i][<span class="stringliteral">"name"</span>]], ENT_QUOTES));  <span class="comment">//osetreni textu!!</span>
<a name="l01518"></a>01518                 <span class="keywordflow">break</span>;
<a name="l01519"></a>01519               }
<a name="l01520"></a>01520             }
<a name="l01521"></a>01521 
<a name="l01522"></a>01522             $ulozit = implode(<span class="stringliteral">"|-x-|"</span>, $ukladani);  <span class="comment">//ulozit do DB</span>
<a name="l01523"></a>01523             $zobrazit = (!Empty($_POST[<span class="stringliteral">"zobrazit"</span>]) ? 1 : 0);
<a name="l01524"></a>01524             $datum = date(<span class="stringliteral">"Y-m-d H:i:s"</span>);
<a name="l01525"></a>01525 
<a name="l01526"></a>01526             <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"INSERT INTO obsah_sablony_kniha (id, sablona, obsah, pridano, zobrazit, admin) VALUES</span>
<a name="l01527"></a>01527 <span class="stringliteral">                                          (NULL, {$sablona}, '{$ulozit}', '{$datum}', {$zobrazit}, 1);"</span>, $error))
<a name="l01528"></a>01528             {
<a name="l01529"></a>01529               $rozdel = explode(<span class="stringliteral">"|-x-|"</span>, $ulozit);
<a name="l01530"></a>01530               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addobsah_hlaska"</span>], $rozdel[0]);
<a name="l01531"></a>01531             }
<a name="l01532"></a>01532               <span class="keywordflow">else</span>
<a name="l01533"></a>01533             {
<a name="l01534"></a>01534               $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l01535"></a>01535             }
<a name="l01536"></a>01536 
<a name="l01537"></a>01537             $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l01538"></a>01538           }
<a name="l01539"></a>01539             <span class="keywordflow">else</span>
<a name="l01540"></a>01540           {
<a name="l01541"></a>01541             <span class="keywordflow">if</span> (count($_POST) &gt; 0)
<a name="l01542"></a>01542             {
<a name="l01543"></a>01543               $chyba = <span class="stringliteral">""</span>;
<a name="l01544"></a>01544               $chyba_form = <span class="stringliteral">""</span>;
<a name="l01545"></a>01545               <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++)
<a name="l01546"></a>01546               {
<a name="l01547"></a>01547                 $chyba .= $podminka[$i][<span class="stringliteral">"chyba"</span>];
<a name="l01548"></a>01548                 $chyba_form .= $podminka[$i][<span class="stringliteral">"chyba_form"</span>];
<a name="l01549"></a>01549               }
<a name="l01550"></a>01550 
<a name="l01551"></a>01551               <span class="keywordflow">if</span> (Empty($_POST[<span class="stringliteral">"error_tlacitko"</span>]))
<a name="l01552"></a>01552               {
<a name="l01553"></a>01553                 $error_button = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_button"</span>]);
<a name="l01554"></a>01554               }
<a name="l01555"></a>01555 
<a name="l01556"></a>01556               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_end"</span>],
<a name="l01557"></a>01557                                                   $chyba,
<a name="l01558"></a>01558                                                   $chyba_form,
<a name="l01559"></a>01559                                                   $error_button,
<a name="l01560"></a>01560                                                   <span class="stringliteral">"{$this-&gt;absolutni_url}?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}"</span>);
<a name="l01561"></a>01561 
<a name="l01562"></a>01562               <span class="comment">//$this-&gt;var-&gt;main[0]-&gt;AutoClick(5, "?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}");  //auto kliknuti</span>
<a name="l01563"></a>01563             }
<a name="l01564"></a>01564           }
<a name="l01565"></a>01565         <span class="keywordflow">break</span>;
<a name="l01566"></a>01566 
<a name="l01567"></a>01567         <span class="keywordflow">case</span> <span class="stringliteral">"editobsah"</span>: <span class="comment">//uprava obsahu</span>
<a name="l01568"></a>01568           $id = $_GET[<span class="stringliteral">"id"</span>];  <span class="comment">//cislo sekce</span>
<a name="l01569"></a>01569           settype($id, <span class="stringliteral">"integer"</span>);
<a name="l01570"></a>01570 
<a name="l01571"></a>01571           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT sablona, obsah, pridano, zobrazit FROM obsah_sablony_kniha WHERE id={$id};"</span>, NULL, $error))
<a name="l01572"></a>01572           {
<a name="l01573"></a>01573             <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l01574"></a>01574             {
<a name="l01575"></a>01575               $data = $res-&gt;fetchObject();
<a name="l01576"></a>01576               $obsah = $data-&gt;obsah;
<a name="l01577"></a>01577               $zobrazit = $data-&gt;zobrazit;
<a name="l01578"></a>01578             }
<a name="l01579"></a>01579           }
<a name="l01580"></a>01580             <span class="keywordflow">else</span>
<a name="l01581"></a>01581           {
<a name="l01582"></a>01582             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l01583"></a>01583           }
<a name="l01584"></a>01584 
<a name="l01585"></a>01585           $nacist = explode(<span class="stringliteral">"|-x-|"</span>, $obsah); <span class="comment">//znovu rozdeleni</span>
<a name="l01586"></a>01586 
<a name="l01587"></a>01587           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, sablona, typ, nazev, value,</span>
<a name="l01588"></a>01588 <span class="stringliteral">                                            input_id, input_class, input_akce,</span>
<a name="l01589"></a>01589 <span class="stringliteral">                                            povinne, skryt_obsah, vstupni_typ,</span>
<a name="l01590"></a>01590 <span class="stringliteral">                                            reg_exp, vystupni_format, min_val,</span>
<a name="l01591"></a>01591 <span class="stringliteral">                                            max_val, poradi</span>
<a name="l01592"></a>01592 <span class="stringliteral">                                            FROM element_kniha</span>
<a name="l01593"></a>01593 <span class="stringliteral">                                            WHERE sablona={$sablona}</span>
<a name="l01594"></a>01594 <span class="stringliteral">                                            ORDER BY poradi ASC;"</span>, NULL, $error))
<a name="l01595"></a>01595           {
<a name="l01596"></a>01596             <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l01597"></a>01597             {
<a name="l01598"></a>01598               <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> = <span class="stringliteral">""</span>;
<a name="l01599"></a>01599               $i = 0;
<a name="l01600"></a>01600               $pocetelem = $res-&gt;numRows();
<a name="l01601"></a>01601               $poradielem = 7;  <span class="comment">//+7</span>
<a name="l01602"></a>01602               <span class="keywordflow">while</span>($data = $res-&gt;fetchObject())
<a name="l01603"></a>01603               {
<a name="l01604"></a>01604                 $povinne = ($data-&gt;povinne ? $this-&gt;znacka_povinne : <span class="stringliteral">""</span>);
<a name="l01605"></a>01605 
<a name="l01606"></a>01606                 $podminka[$i][<span class="stringliteral">"id"</span>] = $data-&gt;id;
<a name="l01607"></a>01607                 $podminka[$i][<span class="stringliteral">"name"</span>] = <span class="stringliteral">"elem_{$data-&gt;id}"</span>; <span class="comment">//name elementu</span>
<a name="l01608"></a>01608                 $podminka[$i][<span class="stringliteral">"nazev"</span>] = $data-&gt;nazev; <span class="comment">//nazev elementu</span>
<a name="l01609"></a>01609                 $podminka[$i][<span class="stringliteral">"blok"</span>] = $data-&gt;value; <span class="comment">//jmeno elementu</span>
<a name="l01610"></a>01610                 $podminka[$i][<span class="stringliteral">"typ"</span>] = $typelementu[$data-&gt;typ];  <span class="comment">//textove oznaceni typu</span>
<a name="l01611"></a>01611                 $podminka[$i][<span class="stringliteral">"povinne"</span>] = $data-&gt;povinne;  <span class="comment">//bool vyraz povinne</span>
<a name="l01612"></a>01612                 $podminka[$i][<span class="stringliteral">"vstup"</span>] = $this-&gt;vstupni_typ[$data-&gt;vstupni_typ];  <span class="comment">//typ vstupu</span>
<a name="l01613"></a>01613                 $podminka[$i][<span class="stringliteral">"reg_exp"</span>] = $data-&gt;reg_exp;  <span class="comment">//regularni vyraz</span>
<a name="l01614"></a>01614                 $podminka[$i][<span class="stringliteral">"min"</span>] = $data-&gt;min_val;  <span class="comment">//minimalni pocet</span>
<a name="l01615"></a>01615                 $podminka[$i][<span class="stringliteral">"max"</span>] = $data-&gt;max_val;  <span class="comment">//maximalni pocet</span>
<a name="l01616"></a>01616                 $podminka[$i][<span class="stringliteral">"chyba"</span>] = <span class="stringliteral">""</span>;
<a name="l01617"></a>01617                 $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = <span class="stringliteral">""</span>;
<a name="l01618"></a>01618 
<a name="l01619"></a>01619                 $input_id = (!Empty($data-&gt;input_id) ? $data-&gt;input_id : <span class="stringliteral">""</span>);
<a name="l01620"></a>01620                 $input_class = (!Empty($data-&gt;input_id) ? $data-&gt;input_class : <span class="stringliteral">""</span>);
<a name="l01621"></a>01621                 $input_akce = (!Empty($data-&gt;input_id) ? $data-&gt;input_akce : <span class="stringliteral">""</span>);
<a name="l01622"></a>01622 
<a name="l01623"></a>01623                 <span class="keywordflow">switch</span> ($typelementu[$data-&gt;typ])
<a name="l01624"></a>01624                 {
<a name="l01625"></a>01625                   <span class="keywordflow">case</span> <span class="stringliteral">"nadpis"</span>: <span class="comment">//nadpis</span>
<a name="l01626"></a>01626                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01627"></a>01627                     $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l01628"></a>01628 
<a name="l01629"></a>01629                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_nadpis"</span>],
<a name="l01630"></a>01630                                                           $data-&gt;nazev,
<a name="l01631"></a>01631                                                           $data-&gt;id,
<a name="l01632"></a>01632                                                           $nacist[$i],
<a name="l01633"></a>01633                                                           <span class="stringliteral">""</span>,
<a name="l01634"></a>01634                                                           $input_id,
<a name="l01635"></a>01635                                                           $input_class,
<a name="l01636"></a>01636                                                           $input_akce,
<a name="l01637"></a>01637                                                           $povinne,
<a name="l01638"></a>01638                                                           $poradielem);
<a name="l01639"></a>01639                   <span class="keywordflow">break</span>;
<a name="l01640"></a>01640 
<a name="l01641"></a>01641                   <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>: <span class="comment">//popisek</span>
<a name="l01642"></a>01642                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01643"></a>01643                     $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l01644"></a>01644                     $value = explode(<span class="stringliteral">"||--x--||"</span>, $nacist[$i]);
<a name="l01645"></a>01645 
<a name="l01646"></a>01646                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_popisek"</span>],
<a name="l01647"></a>01647                                                           $data-&gt;nazev,
<a name="l01648"></a>01648                                                           $data-&gt;id,
<a name="l01649"></a>01649                                                           $value[1],
<a name="l01650"></a>01650                                                           <span class="stringliteral">""</span>,
<a name="l01651"></a>01651                                                           $input_id,
<a name="l01652"></a>01652                                                           $input_class,
<a name="l01653"></a>01653                                                           $input_akce,
<a name="l01654"></a>01654                                                           $povinne,
<a name="l01655"></a>01655                                                           $poradielem,
<a name="l01656"></a>01656                                                           ($data-&gt;skryt_obsah ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_skryt_obsah"</span>],
<a name="l01657"></a>01657                                                                                                           $data-&gt;id,
<a name="l01658"></a>01658                                                                                                           ($value[0] ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>)) : <span class="stringliteral">""</span>),
<a name="l01659"></a>01659                                                           $sablona);
<a name="l01660"></a>01660                   <span class="keywordflow">break</span>;
<a name="l01661"></a>01661 
<a name="l01662"></a>01662                   <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>: <span class="comment">//text</span>
<a name="l01663"></a>01663                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01664"></a>01664                     $podminka[$i][<span class="stringliteral">"chyba_form"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_hidden"</span>], $data-&gt;id, $_POST[<span class="stringliteral">"elem_{$data-&gt;id}"</span>]);
<a name="l01665"></a>01665 
<a name="l01666"></a>01666                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_text"</span>],
<a name="l01667"></a>01667                                                           $data-&gt;nazev,
<a name="l01668"></a>01668                                                           $data-&gt;id,
<a name="l01669"></a>01669                                                           $nacist[$i],
<a name="l01670"></a>01670                                                           <span class="stringliteral">""</span>,
<a name="l01671"></a>01671                                                           $input_id,
<a name="l01672"></a>01672                                                           $input_class,
<a name="l01673"></a>01673                                                           $input_akce,
<a name="l01674"></a>01674                                                           $povinne,
<a name="l01675"></a>01675                                                           $poradielem);
<a name="l01676"></a>01676                   <span class="keywordflow">break</span>;
<a name="l01677"></a>01677 
<a name="l01678"></a>01678                   <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>: <span class="comment">//captcha kod</span>
<a name="l01679"></a>01679                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01680"></a>01680 
<a name="l01681"></a>01681                     <span class="keywordflow">if</span> ($this-&gt;var-&gt;aktivniadmin)
<a name="l01682"></a>01682                     {
<a name="l01683"></a>01683                       $slovo = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"CaptchaCode"</span>, <span class="stringliteral">"GenerujNahodneSlovo"</span>, $nacist[$i]); <span class="comment">//pro id 1</span>
<a name="l01684"></a>01684                       $captcha = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"CaptchaCode"</span>, <span class="stringliteral">"CaptchaKod"</span>, $nacist[$i], $slovo);  <span class="comment">//pro id 1 se slovem</span>
<a name="l01685"></a>01685 
<a name="l01686"></a>01686                       $slovo = (is_array($slovo) ? $slovo[1] : $slovo);
<a name="l01687"></a>01687 
<a name="l01688"></a>01688                       $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"id"</span>] = $nacist[$i];
<a name="l01689"></a>01689                       $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"captcha"</span>] = $captcha;
<a name="l01690"></a>01690                       $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"slovo"</span>] = $slovo;
<a name="l01691"></a>01691                     }
<a name="l01692"></a>01692 
<a name="l01693"></a>01693                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_captcha"</span>],
<a name="l01694"></a>01694                                                           $data-&gt;nazev,
<a name="l01695"></a>01695                                                           $data-&gt;id,
<a name="l01696"></a>01696                                                           $nacist[$i],
<a name="l01697"></a>01697                                                           $slovo,
<a name="l01698"></a>01698                                                           $captcha,
<a name="l01699"></a>01699                                                           $input_id,
<a name="l01700"></a>01700                                                           $input_class,
<a name="l01701"></a>01701                                                           $input_akce,
<a name="l01702"></a>01702                                                           $povinne,
<a name="l01703"></a>01703                                                           $poradielem);
<a name="l01704"></a>01704                   <span class="keywordflow">break</span>;
<a name="l01705"></a>01705 
<a name="l01706"></a>01706                   <span class="keywordflow">case</span> <span class="stringliteral">"datum"</span>: <span class="comment">//datum</span>
<a name="l01707"></a>01707                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01708"></a>01708                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_datum"</span>],
<a name="l01709"></a>01709                                                           $data-&gt;nazev,
<a name="l01710"></a>01710                                                           $data-&gt;id,
<a name="l01711"></a>01711                                                           $nacist[$i],
<a name="l01712"></a>01712                                                           $input_id,
<a name="l01713"></a>01713                                                           $input_class,
<a name="l01714"></a>01714                                                           $input_akce,
<a name="l01715"></a>01715                                                           $povinne,
<a name="l01716"></a>01716                                                           $data-&gt;vystupni_format,
<a name="l01717"></a>01717                                                           date($data-&gt;vystupni_format),
<a name="l01718"></a>01718                                                           $poradielem);
<a name="l01719"></a>01719                   <span class="keywordflow">break</span>;
<a name="l01720"></a>01720 
<a name="l01721"></a>01721                   <span class="keywordflow">case</span> <span class="stringliteral">"cas"</span>: <span class="comment">//cas</span>
<a name="l01722"></a>01722                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01723"></a>01723                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_cas"</span>],
<a name="l01724"></a>01724                                                           $data-&gt;nazev,
<a name="l01725"></a>01725                                                           $data-&gt;id,
<a name="l01726"></a>01726                                                           $nacist[$i],
<a name="l01727"></a>01727                                                           $input_id,
<a name="l01728"></a>01728                                                           $input_class,
<a name="l01729"></a>01729                                                           $input_akce,
<a name="l01730"></a>01730                                                           $povinne,
<a name="l01731"></a>01731                                                           $data-&gt;vystupni_format,
<a name="l01732"></a>01732                                                           date($data-&gt;vystupni_format),
<a name="l01733"></a>01733                                                           $poradielem);
<a name="l01734"></a>01734                   <span class="keywordflow">break</span>;
<a name="l01735"></a>01735 
<a name="l01736"></a>01736                   <span class="keywordflow">case</span> <span class="stringliteral">"datumcas"</span>: <span class="comment">//datumcas</span>
<a name="l01737"></a>01737                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01738"></a>01738                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_datumcas"</span>],
<a name="l01739"></a>01739                                                           $data-&gt;nazev,
<a name="l01740"></a>01740                                                           $data-&gt;id,
<a name="l01741"></a>01741                                                           $nacist[$i],
<a name="l01742"></a>01742                                                           $input_id,
<a name="l01743"></a>01743                                                           $input_class,
<a name="l01744"></a>01744                                                           $input_akce,
<a name="l01745"></a>01745                                                           $povinne,
<a name="l01746"></a>01746                                                           $data-&gt;vystupni_format,
<a name="l01747"></a>01747                                                           date($data-&gt;vystupni_format),
<a name="l01748"></a>01748                                                           $poradielem);
<a name="l01749"></a>01749                   <span class="keywordflow">break</span>;
<a name="l01750"></a>01750 
<a name="l01751"></a>01751                   <span class="keywordflow">case</span> <span class="stringliteral">"checkbox"</span>: <span class="comment">//checkbox</span>
<a name="l01752"></a>01752                     $poradielem += $this-&gt;pocitadloporadi[$data-&gt;typ];
<a name="l01753"></a>01753                     $val = htmlspecialchars_decode(html_entity_decode($nacist[$i]));
<a name="l01754"></a>01754                     <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditobsah_checkbox"</span>],
<a name="l01755"></a>01755                                                           $data-&gt;nazev,
<a name="l01756"></a>01756                                                           $data-&gt;id,
<a name="l01757"></a>01757                                                           (!Empty($nacist[$i]) ? <span class="stringliteral">" value=\"{$val}\""</span> : <span class="stringliteral">""</span>),
<a name="l01758"></a>01758                                                           $input_id,
<a name="l01759"></a>01759                                                           $input_class,
<a name="l01760"></a>01760                                                           $input_akce,
<a name="l01761"></a>01761                                                           $povinne,
<a name="l01762"></a>01762                                                           (!Empty($nacist[$i]) ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l01763"></a>01763                                                           $poradielem);
<a name="l01764"></a>01764                   <span class="keywordflow">break</span>;
<a name="l01765"></a>01765                 }
<a name="l01766"></a>01766 
<a name="l01767"></a>01767                 $i++;
<a name="l01768"></a>01768               }
<a name="l01769"></a>01769             }
<a name="l01770"></a>01770           }
<a name="l01771"></a>01771             <span class="keywordflow">else</span>
<a name="l01772"></a>01772           {
<a name="l01773"></a>01773             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l01774"></a>01774           }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_editobsah_form"</span>],
<a name="l01777"></a>01777                                               <a class="code" href="classDynamicNavstevniKniha.html#e0e77f1547dd1775c24ccd50aa05ab51">$element</a>,
<a name="l01778"></a>01778                                               ($zobrazit ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l01779"></a>01779                                               $this-&gt;dirpath);
<a name="l01780"></a>01780 
<a name="l01781"></a>01781           $poc = 0;
<a name="l01782"></a>01782           $check = <span class="keyword">true</span>;
<a name="l01783"></a>01783           <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++) <span class="comment">//kontrola vyplneni</span>
<a name="l01784"></a>01784           {
<a name="l01785"></a>01785             $zpost = $_POST[$podminka[$i][<span class="stringliteral">"name"</span>]];
<a name="l01786"></a>01786 
<a name="l01787"></a>01787             <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"typ"</span>]) <span class="comment">//rozliseni kontroly podle typu</span>
<a name="l01788"></a>01788             {
<a name="l01789"></a>01789               <span class="keywordflow">case</span> <span class="stringliteral">"nadpis"</span>:
<a name="l01790"></a>01790               <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>:
<a name="l01791"></a>01791               <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>:
<a name="l01792"></a>01792                 <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"vstup"</span>])
<a name="l01793"></a>01793                 {
<a name="l01794"></a>01794                   <span class="keywordflow">case</span> <span class="stringliteral">"text"</span>:  <span class="comment">//konvert textu</span>
<a name="l01795"></a>01795                     settype($zpost, <span class="stringliteral">"string"</span>);
<a name="l01796"></a>01796 
<a name="l01797"></a>01797                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l01798"></a>01798                     {
<a name="l01799"></a>01799                       $zpost = <span class="stringliteral">""</span>;
<a name="l01800"></a>01800                       $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]) : <span class="stringliteral">""</span>);
<a name="l01801"></a>01801                     }
<a name="l01802"></a>01802                       <span class="keywordflow">else</span>
<a name="l01803"></a>01803                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0 &amp;&amp;
<a name="l01804"></a>01804                         $podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)
<a name="l01805"></a>01805                     {
<a name="l01806"></a>01806                       <span class="keywordflow">if</span> (strlen($zpost) &lt; $podminka[$i][<span class="stringliteral">"min"</span>] ||
<a name="l01807"></a>01807                           strlen($zpost) &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01808"></a>01808                       {
<a name="l01809"></a>01809                         $zpost = <span class="stringliteral">""</span>;
<a name="l01810"></a>01810                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01811"></a>01811                       }
<a name="l01812"></a>01812                     }
<a name="l01813"></a>01813                       <span class="keywordflow">else</span>
<a name="l01814"></a>01814                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0)  <span class="comment">//kontrola minina</span>
<a name="l01815"></a>01815                     {
<a name="l01816"></a>01816                       <span class="keywordflow">if</span> (strlen($zpost) &lt; $podminka[$i][<span class="stringliteral">"min"</span>])
<a name="l01817"></a>01817                       {
<a name="l01818"></a>01818                         $zpost = <span class="stringliteral">""</span>;
<a name="l01819"></a>01819                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01820"></a>01820                       }
<a name="l01821"></a>01821                     }
<a name="l01822"></a>01822                       <span class="keywordflow">else</span>
<a name="l01823"></a>01823                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)  <span class="comment">//kontrola maxima</span>
<a name="l01824"></a>01824                     {
<a name="l01825"></a>01825                       <span class="keywordflow">if</span> (strlen($zpost) &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01826"></a>01826                       {
<a name="l01827"></a>01827                         $zpost = <span class="stringliteral">""</span>;
<a name="l01828"></a>01828                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01829"></a>01829                       }
<a name="l01830"></a>01830                     }
<a name="l01831"></a>01831                   <span class="keywordflow">break</span>;
<a name="l01832"></a>01832 
<a name="l01833"></a>01833                   <span class="keywordflow">case</span> <span class="stringliteral">"integer"</span>: <span class="comment">//konvert cisla</span>
<a name="l01834"></a>01834                     settype($zpost, <span class="stringliteral">"integer"</span>);
<a name="l01835"></a>01835 
<a name="l01836"></a>01836                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l01837"></a>01837                     {
<a name="l01838"></a>01838                       $zpost = <span class="stringliteral">""</span>;
<a name="l01839"></a>01839                       $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]) : <span class="stringliteral">""</span>);
<a name="l01840"></a>01840                     }
<a name="l01841"></a>01841                       <span class="keywordflow">else</span>
<a name="l01842"></a>01842                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0 &amp;&amp;
<a name="l01843"></a>01843                         $podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)
<a name="l01844"></a>01844                     {
<a name="l01845"></a>01845                       <span class="keywordflow">if</span> ($zpost &lt; $podminka[$i][<span class="stringliteral">"min"</span>] ||  <span class="comment">//kontrola hodnoty cisel</span>
<a name="l01846"></a>01846                           $zpost &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01847"></a>01847                       {
<a name="l01848"></a>01848                         $zpost = <span class="stringliteral">""</span>;
<a name="l01849"></a>01849                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01850"></a>01850                       }
<a name="l01851"></a>01851                     }
<a name="l01852"></a>01852                       <span class="keywordflow">else</span>
<a name="l01853"></a>01853                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"min"</span>] &gt; 0)  <span class="comment">//kontrola minina</span>
<a name="l01854"></a>01854                     {
<a name="l01855"></a>01855                       <span class="keywordflow">if</span> ($zpost &lt; $podminka[$i][<span class="stringliteral">"min"</span>])
<a name="l01856"></a>01856                       {
<a name="l01857"></a>01857                         $zpost = <span class="stringliteral">""</span>;
<a name="l01858"></a>01858                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_min"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01859"></a>01859                       }
<a name="l01860"></a>01860                     }
<a name="l01861"></a>01861                       <span class="keywordflow">else</span>
<a name="l01862"></a>01862                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"max"</span>] &gt; 0)  <span class="comment">//kontrola maxima</span>
<a name="l01863"></a>01863                     {
<a name="l01864"></a>01864                       <span class="keywordflow">if</span> ($zpost &gt; $podminka[$i][<span class="stringliteral">"max"</span>])
<a name="l01865"></a>01865                       {
<a name="l01866"></a>01866                         $zpost = <span class="stringliteral">""</span>;
<a name="l01867"></a>01867                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_max"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01868"></a>01868                       }
<a name="l01869"></a>01869                     }
<a name="l01870"></a>01870                   <span class="keywordflow">break</span>;
<a name="l01871"></a>01871 
<a name="l01872"></a>01872                   <span class="keywordflow">case</span> <span class="stringliteral">"reg_exp"</span>: <span class="comment">//konrola reg_exp</span>
<a name="l01873"></a>01873                     <span class="keywordflow">if</span> ($podminka[$i][<span class="stringliteral">"blok"</span>] == $zpost)  <span class="comment">//znacknuto bez rozmyslu</span>
<a name="l01874"></a>01874                     {
<a name="l01875"></a>01875                       $zpost = <span class="stringliteral">""</span>;
<a name="l01876"></a>01876                       $podminka[$i][<span class="stringliteral">"chyba"</span>] = ($podminka[$i][<span class="stringliteral">"povinne"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]) : <span class="stringliteral">""</span>);
<a name="l01877"></a>01877                       <span class="keywordflow">break</span>;
<a name="l01878"></a>01878                     }
<a name="l01879"></a>01879                       <span class="keywordflow">else</span>
<a name="l01880"></a>01880                     {
<a name="l01881"></a>01881                       preg_match($podminka[$i][<span class="stringliteral">"reg_exp"</span>], $zpost, $ret);
<a name="l01882"></a>01882                       $zpost = $ret[0];  <span class="comment">//vybere nulty index</span>
<a name="l01883"></a>01883 
<a name="l01884"></a>01884                       <span class="keywordflow">if</span> (Empty($zpost))
<a name="l01885"></a>01885                       {
<a name="l01886"></a>01886                         $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_reg_exp"</span>], $podminka[$i][<span class="stringliteral">"nazev"</span>]);
<a name="l01887"></a>01887                       }
<a name="l01888"></a>01888                     }
<a name="l01889"></a>01889                   <span class="keywordflow">break</span>;
<a name="l01890"></a>01890                 }
<a name="l01891"></a>01891 
<a name="l01892"></a>01892                 <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l01893"></a>01893                 {
<a name="l01894"></a>01894                   $check = <span class="keyword">false</span>;
<a name="l01895"></a>01895                 }
<a name="l01896"></a>01896                   <span class="keywordflow">else</span>
<a name="l01897"></a>01897                 {
<a name="l01898"></a>01898                   $poc++;
<a name="l01899"></a>01899                 }
<a name="l01900"></a>01900               <span class="keywordflow">break</span>;
<a name="l01901"></a>01901 
<a name="l01902"></a>01902               <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>: <span class="comment">//kontrola $_POST</span>
<a name="l01903"></a>01903                 $pridavek = (is_array($_SESSION[<span class="stringliteral">"slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}"</span>]) ? <span class="stringliteral">"_solve"</span> : <span class="stringliteral">""</span>);
<a name="l01904"></a>01904 
<a name="l01905"></a>01905                 <span class="keywordflow">if</span> (count($_POST) == 0 || $zpost != $_SESSION[<span class="stringliteral">"admin_slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>])
<a name="l01906"></a>01906                 {
<a name="l01907"></a>01907                   $_SESSION[<span class="stringliteral">"admin_slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>] = $_SESSION[<span class="stringliteral">"slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}"</span>];
<a name="l01908"></a>01908                 }
<a name="l01909"></a>01909 
<a name="l01910"></a>01910                 <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l01911"></a>01911                 {
<a name="l01912"></a>01912                   $check = <span class="keyword">false</span>;
<a name="l01913"></a>01913                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_empty_captcha"</span>]);  <span class="comment">//prazdna</span>
<a name="l01914"></a>01914                 }
<a name="l01915"></a>01915                   <span class="keywordflow">else</span>
<a name="l01916"></a>01916                 {
<a name="l01917"></a>01917                   <span class="keywordflow">if</span> ($zpost == $_SESSION[<span class="stringliteral">"admin_slovo_{$this-&gt;admincaptchakod[$sablona]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$pridavek}_vysledek"</span>])  <span class="comment">//turinguv stroj rozliseni cloveka</span>
<a name="l01918"></a>01918                   {
<a name="l01919"></a>01919                     $poc++;
<a name="l01920"></a>01920                   }
<a name="l01921"></a>01921                     <span class="keywordflow">else</span>
<a name="l01922"></a>01922                   {
<a name="l01923"></a>01923                     $check = <span class="keyword">false</span>;
<a name="l01924"></a>01924                     $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_wrong_captcha"</span>]);  <span class="comment">//spatne</span>
<a name="l01925"></a>01925                   }
<a name="l01926"></a>01926                 }
<a name="l01927"></a>01927               <span class="keywordflow">break</span>;
<a name="l01928"></a>01928 
<a name="l01929"></a>01929               <span class="keywordflow">default</span>:  <span class="comment">//kontrola $_POST</span>
<a name="l01930"></a>01930                 <span class="keywordflow">if</span> (Empty($zpost) &amp;&amp; $podminka[$i][<span class="stringliteral">"povinne"</span>])
<a name="l01931"></a>01931                 {
<a name="l01932"></a>01932                   $check = <span class="keyword">false</span>;
<a name="l01933"></a>01933                   $podminka[$i][<span class="stringliteral">"chyba"</span>] = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_unkown"</span>], $podminka[$i][<span class="stringliteral">"name"</span>]);
<a name="l01934"></a>01934                 }
<a name="l01935"></a>01935                   <span class="keywordflow">else</span>
<a name="l01936"></a>01936                 {
<a name="l01937"></a>01937                   $poc++;
<a name="l01938"></a>01938                 }
<a name="l01939"></a>01939               <span class="keywordflow">break</span>;
<a name="l01940"></a>01940             }
<a name="l01941"></a>01941           }
<a name="l01942"></a>01942 
<a name="l01943"></a>01943           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l01944"></a>01944               $poc == $pocetelem &amp;&amp;
<a name="l01945"></a>01945               $id != 0)
<a name="l01946"></a>01946           {
<a name="l01947"></a>01947             $ukladani[] = <span class="stringliteral">""</span>;
<a name="l01948"></a>01948             <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++)
<a name="l01949"></a>01949             {
<a name="l01950"></a>01950               <span class="keywordflow">switch</span> ($podminka[$i][<span class="stringliteral">"typ"</span>])
<a name="l01951"></a>01951               {
<a name="l01952"></a>01952                 <span class="keywordflow">case</span> <span class="stringliteral">"popisek"</span>:
<a name="l01953"></a>01953                   $ukl = array((!Empty($_POST[<span class="stringliteral">"skryt_{$podminka[$i]["</span>name<span class="stringliteral">"]}"</span>]) ? 1 : 0),
<a name="l01954"></a>01954                                 stripslashes(htmlspecialchars($_POST[$podminka[$i][<span class="stringliteral">"name"</span>]], ENT_QUOTES)));
<a name="l01955"></a>01955 
<a name="l01956"></a>01956                   $ukladani[$i] = implode(<span class="stringliteral">"||--x--||"</span>, $ukl);
<a name="l01957"></a>01957                 <span class="keywordflow">break</span>;
<a name="l01958"></a>01958 
<a name="l01959"></a>01959                 <span class="keywordflow">case</span> <span class="stringliteral">"captcha"</span>:
<a name="l01960"></a>01960                   $ukladani[$i] = $this-&gt;admincaptchakod[$sablona][<span class="stringliteral">"id"</span>]; <span class="comment">//ulozi ID captchy a ne hodnotu!</span>
<a name="l01961"></a>01961                 <span class="keywordflow">break</span>;
<a name="l01962"></a>01962 
<a name="l01963"></a>01963                 <span class="keywordflow">default</span>:  <span class="comment">//rozdeleni hodnot</span>
<a name="l01964"></a>01964                   $ukladani[$i] = stripslashes(htmlspecialchars($_POST[$podminka[$i][<span class="stringliteral">"name"</span>]], ENT_QUOTES));  <span class="comment">//osetreni textu!!</span>
<a name="l01965"></a>01965                 <span class="keywordflow">break</span>;
<a name="l01966"></a>01966               }
<a name="l01967"></a>01967             }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969             $ulozit = implode(<span class="stringliteral">"|-x-|"</span>, $ukladani);  <span class="comment">//ulozit do DB</span>
<a name="l01970"></a>01970             $zobrazit = (!Empty($_POST[<span class="stringliteral">"zobrazit"</span>]) ? 1 : 0);
<a name="l01971"></a>01971 
<a name="l01972"></a>01972             <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"UPDATE obsah_sablony_kniha SET sablona={$sablona},</span>
<a name="l01973"></a>01973 <span class="stringliteral">                                                                          obsah='{$ulozit}',</span>
<a name="l01974"></a>01974 <span class="stringliteral">                                                                          zobrazit={$zobrazit}</span>
<a name="l01975"></a>01975 <span class="stringliteral">                                                                          WHERE id={$id};"</span>, $error))
<a name="l01976"></a>01976             {
<a name="l01977"></a>01977               $rozdel = explode(<span class="stringliteral">"|-x-|"</span>, $ulozit);
<a name="l01978"></a>01978               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_editobsah_hlaska"</span>], $rozdel[0]);
<a name="l01979"></a>01979             }
<a name="l01980"></a>01980               <span class="keywordflow">else</span>
<a name="l01981"></a>01981             {
<a name="l01982"></a>01982               $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l01983"></a>01983             }
<a name="l01984"></a>01984 
<a name="l01985"></a>01985             $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l01986"></a>01986           }
<a name="l01987"></a>01987             <span class="keywordflow">else</span>
<a name="l01988"></a>01988           {
<a name="l01989"></a>01989             <span class="keywordflow">if</span> (count($_POST) &gt; 0)
<a name="l01990"></a>01990             {
<a name="l01991"></a>01991               $chyba = <span class="stringliteral">""</span>;
<a name="l01992"></a>01992               $chyba_form = <span class="stringliteral">""</span>;
<a name="l01993"></a>01993               <span class="keywordflow">for</span> ($i = 0; $i &lt; $pocetelem; $i++)
<a name="l01994"></a>01994               {
<a name="l01995"></a>01995                 $chyba .= $podminka[$i][<span class="stringliteral">"chyba"</span>];
<a name="l01996"></a>01996                 $chyba_form .= $podminka[$i][<span class="stringliteral">"chyba_form"</span>];
<a name="l01997"></a>01997               }
<a name="l01998"></a>01998 
<a name="l01999"></a>01999               <span class="keywordflow">if</span> (Empty($_POST[<span class="stringliteral">"error_tlacitko"</span>]))
<a name="l02000"></a>02000               {
<a name="l02001"></a>02001                 $error_button = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_button"</span>]);
<a name="l02002"></a>02002               }
<a name="l02003"></a>02003 
<a name="l02004"></a>02004               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"normal_error_end"</span>],
<a name="l02005"></a>02005                                                   $chyba,
<a name="l02006"></a>02006                                                   $chyba_form,
<a name="l02007"></a>02007                                                   $error_button,
<a name="l02008"></a>02008                                                   <span class="stringliteral">"{$this-&gt;absolutni_url}?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}"</span>);
<a name="l02009"></a>02009 
<a name="l02010"></a>02010               <span class="comment">//$this-&gt;var-&gt;main[0]-&gt;AutoClick(5, "?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}");  //auto kliknuti</span>
<a name="l02011"></a>02011             }
<a name="l02012"></a>02012           }
<a name="l02013"></a>02013         <span class="keywordflow">break</span>;
<a name="l02014"></a>02014 
<a name="l02015"></a>02015         <span class="keywordflow">case</span> <span class="stringliteral">"delobsah"</span>: <span class="comment">//mazani podle id obsahu</span>
<a name="l02016"></a>02016           $id = $_GET[<span class="stringliteral">"id"</span>];  <span class="comment">//cislo sekce</span>
<a name="l02017"></a>02017           settype($id, <span class="stringliteral">"integer"</span>);
<a name="l02018"></a>02018 
<a name="l02019"></a>02019           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT obsah FROM obsah_sablony_kniha WHERE id={$id};"</span>, NULL, $error))
<a name="l02020"></a>02020           {
<a name="l02021"></a>02021             <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l02022"></a>02022             {
<a name="l02023"></a>02023               $data = $res-&gt;fetchObject();
<a name="l02024"></a>02024 
<a name="l02025"></a>02025               <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"DELETE FROM obsah_sablony_kniha WHERE id={$id};"</span>, $error)) <span class="comment">//provedeni dotazu</span>
<a name="l02026"></a>02026               {
<a name="l02027"></a>02027                 $rozdel = explode(<span class="stringliteral">"|-x-|"</span>, $data-&gt;obsah);
<a name="l02028"></a>02028                 <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_delobsah_hlaska"</span>], $rozdel[0]);
<a name="l02029"></a>02029               }
<a name="l02030"></a>02030                 <span class="keywordflow">else</span>
<a name="l02031"></a>02031               {
<a name="l02032"></a>02032                 $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02033"></a>02033               }
<a name="l02034"></a>02034 
<a name="l02035"></a>02035               $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02036"></a>02036             }
<a name="l02037"></a>02037           }
<a name="l02038"></a>02038             <span class="keywordflow">else</span>
<a name="l02039"></a>02039           {
<a name="l02040"></a>02040             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02041"></a>02041           }
<a name="l02042"></a>02042         <span class="keywordflow">break</span>;
<a name="l02043"></a>02043       }
<a name="l02044"></a>02044     }
<a name="l02045"></a>02045 
<a name="l02046"></a>02046     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02047"></a>02047   }
<a name="l02048"></a>02048 
<a name="l02056"></a><a class="code" href="classDynamicNavstevniKniha.html#67f4f0ad390f56983f84d4d7953cb3c4">02056</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#67f4f0ad390f56983f84d4d7953cb3c4">AdminVypisObsahSablony</a>($sablona)
<a name="l02057"></a>02057   {
<a name="l02058"></a>02058     settype($sablona, <span class="stringliteral">"integer"</span>);
<a name="l02059"></a>02059 
<a name="l02060"></a>02060     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l02061"></a>02061     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, sablona, obsah, pridano, zobrazit, admin</span>
<a name="l02062"></a>02062 <span class="stringliteral">                                      FROM obsah_sablony_kniha</span>
<a name="l02063"></a>02063 <span class="stringliteral">                                      WHERE sablona={$sablona}</span>
<a name="l02064"></a>02064 <span class="stringliteral">                                      ORDER BY obsah_sablony_kniha.pridano DESC;"</span>, NULL, $error))
<a name="l02065"></a>02065     {
<a name="l02066"></a>02066       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l02067"></a>02067       {
<a name="l02068"></a>02068         <span class="keywordflow">while</span>($data = $res-&gt;fetchObject())
<a name="l02069"></a>02069         {
<a name="l02070"></a>02070           $rozdel = explode(<span class="stringliteral">"|-x-|"</span>, $data-&gt;obsah);
<a name="l02071"></a>02071           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_obsah"</span>],
<a name="l02072"></a>02072                                               $data-&gt;obsah,
<a name="l02073"></a>02073                                               $rozdel[0],
<a name="l02074"></a>02074                                               $data-&gt;pridano,
<a name="l02075"></a>02075                                               ($data-&gt;zobrazit ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02076"></a>02076                                               ($data-&gt;admin ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02077"></a>02077                                               <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}&amp;amp;co=editobsah&amp;amp;id={$data-&gt;id}"</span>,
<a name="l02078"></a>02078                                               <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}__{$sablona}&amp;amp;co=delobsah&amp;amp;id={$data-&gt;id}"</span>);
<a name="l02079"></a>02079         }
<a name="l02080"></a>02080       }
<a name="l02081"></a>02081     }
<a name="l02082"></a>02082       <span class="keywordflow">else</span>
<a name="l02083"></a>02083     {
<a name="l02084"></a>02084       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02085"></a>02085     }
<a name="l02086"></a>02086 
<a name="l02087"></a>02087     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02088"></a>02088   }
<a name="l02089"></a>02089 
<a name="l02097"></a><a class="code" href="classDynamicNavstevniKniha.html#e87f7ecb2c9c4a08632873e9f09c2563">02097</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#e87f7ecb2c9c4a08632873e9f09c2563">ExistujeSablona</a>($adresa)
<a name="l02098"></a>02098   {
<a name="l02099"></a>02099     <span class="keywordflow">if</span> (!Empty($adresa))
<a name="l02100"></a>02100     {
<a name="l02101"></a>02101       <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id FROM sablona_kniha WHERE adresa='{$adresa}';"</span>, NULL, $error))
<a name="l02102"></a>02102       {
<a name="l02103"></a>02103         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = ($res-&gt;numRows() == 1 ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l02104"></a>02104       }
<a name="l02105"></a>02105         <span class="keywordflow">else</span>
<a name="l02106"></a>02106       {
<a name="l02107"></a>02107         $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02108"></a>02108       }
<a name="l02109"></a>02109     }
<a name="l02110"></a>02110 
<a name="l02111"></a>02111     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02112"></a>02112   }
<a name="l02113"></a>02113 
<a name="l02121"></a><a class="code" href="classDynamicNavstevniKniha.html#6e8f6df8063b666e27cd2b36499e06c8">02121</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#6e8f6df8063b666e27cd2b36499e06c8">VyberSablony</a>($id = NULL)
<a name="l02122"></a>02122   {
<a name="l02123"></a>02123     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l02124"></a>02124     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, adresa, nazev</span>
<a name="l02125"></a>02125 <span class="stringliteral">                                      FROM sablona_kniha;"</span>, NULL, $error))
<a name="l02126"></a>02126     {
<a name="l02127"></a>02127       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l02128"></a>02128       {
<a name="l02129"></a>02129         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vyber_sablony_begin"</span>]);
<a name="l02130"></a>02130         <span class="keywordflow">while</span> ($data = $res-&gt;fetchObject())
<a name="l02131"></a>02131         {
<a name="l02132"></a>02132           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vyber_sablony"</span>],
<a name="l02133"></a>02133                                               $data-&gt;id,
<a name="l02134"></a>02134                                               (!Empty($id) &amp;&amp; $id == $data-&gt;id ? <span class="stringliteral">" selected=\"selected\""</span> : <span class="stringliteral">""</span>),
<a name="l02135"></a>02135                                               $data-&gt;nazev,
<a name="l02136"></a>02136                                               $data-&gt;adresa);
<a name="l02137"></a>02137         }
<a name="l02138"></a>02138         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vyber_sablony_end"</span>]);
<a name="l02139"></a>02139       }
<a name="l02140"></a>02140         <span class="keywordflow">else</span>
<a name="l02141"></a>02141       {
<a name="l02142"></a>02142         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vyber_sablony_null"</span>]);
<a name="l02143"></a>02143       }
<a name="l02144"></a>02144     }
<a name="l02145"></a>02145       <span class="keywordflow">else</span>
<a name="l02146"></a>02146     {
<a name="l02147"></a>02147       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02148"></a>02148     }
<a name="l02149"></a>02149 
<a name="l02150"></a>02150     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02151"></a>02151   }
<a name="l02152"></a>02152 
<a name="l02161"></a><a class="code" href="classDynamicNavstevniKniha.html#a6d900f45ed85511a07df96d3cb22456">02161</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#a6d900f45ed85511a07df96d3cb22456">VyberTypu</a>($id = NULL, $adresa = NULL)
<a name="l02162"></a>02162   {
<a name="l02163"></a>02163     $typ = array_keys($this-&gt;element);
<a name="l02164"></a>02164 
<a name="l02165"></a>02165     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_typ_select_begin"</span>], $adresa);
<a name="l02166"></a>02166     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($typ); $i++)
<a name="l02167"></a>02167     {
<a name="l02168"></a>02168       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_typ_select"</span>],
<a name="l02169"></a>02169                                           $i,
<a name="l02170"></a>02170                                           ($id == $i ? <span class="stringliteral">" selected=\"selected\""</span> : <span class="stringliteral">""</span>),
<a name="l02171"></a>02171                                           $typ[$i],
<a name="l02172"></a>02172                                           $this-&gt;element[$typ[$i]]);
<a name="l02173"></a>02173     }
<a name="l02174"></a>02174     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_typ_select_end"</span>]);
<a name="l02175"></a>02175 
<a name="l02176"></a>02176     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02177"></a>02177   }
<a name="l02178"></a>02178 
<a name="l02187"></a><a class="code" href="classDynamicNavstevniKniha.html#041011da2ed8d6ed66ae88eb4fce4f8d">02187</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#041011da2ed8d6ed66ae88eb4fce4f8d">VyberVstupu</a>($id = NULL, $adresa = NULL)
<a name="l02188"></a>02188   {
<a name="l02189"></a>02189     $typ = $this-&gt;vstupni_typ;
<a name="l02190"></a>02190 
<a name="l02191"></a>02191     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vstupni_typ_select_begin"</span>], $adresa);
<a name="l02192"></a>02192     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($typ); $i++)
<a name="l02193"></a>02193     {
<a name="l02194"></a>02194       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vstupni_typ_select"</span>],
<a name="l02195"></a>02195                                           $i,
<a name="l02196"></a>02196                                           ($id == $i ? <span class="stringliteral">" selected=\"selected\""</span> : <span class="stringliteral">""</span>),
<a name="l02197"></a>02197                                           $typ[$i]);
<a name="l02198"></a>02198       ;
<a name="l02199"></a>02199     }
<a name="l02200"></a>02200     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vstupni_typ_select_end"</span>]);
<a name="l02201"></a>02201 
<a name="l02202"></a>02202     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02203"></a>02203   }
<a name="l02204"></a>02204 
<a name="l02213"></a><a class="code" href="classDynamicNavstevniKniha.html#9ec112d03928d348f8ce9b3f1d3635e5">02213</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#9ec112d03928d348f8ce9b3f1d3635e5">PocetRadku</a>($sablona, $inc = 0)
<a name="l02214"></a>02214   {
<a name="l02215"></a>02215     settype($sablona, <span class="stringliteral">"integer"</span>);
<a name="l02216"></a>02216     settype($inc, <span class="stringliteral">"integer"</span>);
<a name="l02217"></a>02217 
<a name="l02218"></a>02218     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = 0;
<a name="l02219"></a>02219     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT COUNT(id) pocet FROM element_kniha WHERE sablona={$sablona};"</span>, NULL, $error))
<a name="l02220"></a>02220     {
<a name="l02221"></a>02221       <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l02222"></a>02222       {
<a name="l02223"></a>02223         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $res-&gt;fetchObject()-&gt;pocet + $inc;
<a name="l02224"></a>02224       }
<a name="l02225"></a>02225     }
<a name="l02226"></a>02226       <span class="keywordflow">else</span>
<a name="l02227"></a>02227     {
<a name="l02228"></a>02228       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02229"></a>02229     }
<a name="l02230"></a>02230 
<a name="l02231"></a>02231     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02232"></a>02232   }
<a name="l02233"></a>02233 
<a name="l02240"></a><a class="code" href="classDynamicNavstevniKniha.html#fd077b9d6beb149cf397bcaad70dcf3a">02240</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#fd077b9d6beb149cf397bcaad70dcf3a">AdministraceObsahu</a>()
<a name="l02241"></a>02241   {
<a name="l02242"></a>02242     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_obsah"</span>],
<a name="l02243"></a>02243                                         <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=test_rv"</span>,
<a name="l02244"></a>02244                                         ($this-&gt;povolit_pridani ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_obsah_add_link"</span>],
<a name="l02245"></a>02245                                                                                             <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addsab"</span>,
<a name="l02246"></a>02246                                                                                             <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addelem"</span>) : <span class="stringliteral">""</span>),
<a name="l02247"></a>02247                                         $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#04a19d40c474d6b4ece8f068ed4d953b">AdminVypisObsahu</a>());
<a name="l02248"></a>02248 
<a name="l02249"></a>02249     $co = $_GET[<span class="stringliteral">"co"</span>];
<a name="l02250"></a>02250 
<a name="l02251"></a>02251     <span class="keywordflow">if</span> (!Empty($co))
<a name="l02252"></a>02252     {
<a name="l02253"></a>02253       <span class="keywordflow">switch</span> ($co)
<a name="l02254"></a>02254       {
<a name="l02255"></a>02255         <span class="keywordflow">case</span> <span class="stringliteral">"test_rv"</span>:
<a name="l02256"></a>02256           $vstup = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"vstup"</span>], ENT_QUOTES));
<a name="l02257"></a>02257           <span class="comment">//prepinani podle webu/lokalu</span>
<a name="l02258"></a>02258           $reg_exp = (!in_array($_SERVER[<span class="stringliteral">"REMOTE_ADDR"</span>], $this-&gt;var-&gt;ipblok) ? $_POST[<span class="stringliteral">"reg_exp"</span>] : stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"reg_exp"</span>], ENT_QUOTES)));
<a name="l02259"></a>02259 
<a name="l02260"></a>02260           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_test_rv"</span>],
<a name="l02261"></a>02261                                               $vstup,
<a name="l02262"></a>02262                                               $reg_exp);
<a name="l02263"></a>02263 
<a name="l02264"></a>02264           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l02265"></a>02265               !Empty($vstup) &amp;&amp;
<a name="l02266"></a>02266               !Empty($reg_exp))
<a name="l02267"></a>02267           {
<a name="l02268"></a>02268             preg_match($reg_exp, $vstup, $ret);
<a name="l02269"></a>02269             <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= (!Empty($ret[0]) ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_test_rv_out"</span>], $ret[0]) : <span class="stringliteral">"NULL"</span>);  <span class="comment">//vybere nulty index</span>
<a name="l02270"></a>02270           }
<a name="l02271"></a>02271         <span class="keywordflow">break</span>;
<a name="l02272"></a>02272 
<a name="l02273"></a>02273         <span class="keywordflow">case</span> <span class="stringliteral">"addsab"</span>: <span class="comment">//pridavani sablony</span>
<a name="l02274"></a>02274           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addsab"</span>], $this-&gt;dirpath);
<a name="l02275"></a>02275 
<a name="l02276"></a>02276           $adresa = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"adresa"</span>], ENT_QUOTES));
<a name="l02277"></a>02277           $razeni = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"razeni"</span>], ENT_QUOTES));
<a name="l02278"></a>02278           $nove_rss = $_POST[<span class="stringliteral">"nove_rss"</span>];
<a name="l02279"></a>02279           settype($nove_rss, <span class="stringliteral">"integer"</span>);
<a name="l02280"></a>02280           $nazev = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"nazev"</span>], ENT_QUOTES));
<a name="l02281"></a>02281           $popisek = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"popisek"</span>], ENT_QUOTES));
<a name="l02282"></a>02282           $href_id = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"href_id"</span>], ENT_QUOTES));
<a name="l02283"></a>02283           $href_class = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"href_class"</span>], ENT_QUOTES));
<a name="l02284"></a>02284           $href_akce = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"href_akce"</span>], ENT_QUOTES));
<a name="l02285"></a>02285           $zobrazit = (!Empty($_POST[<span class="stringliteral">"zobrazit"</span>]) ? 1 : 0);
<a name="l02286"></a>02286 
<a name="l02287"></a>02287           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l02288"></a>02288               !Empty($adresa) &amp;&amp;
<a name="l02289"></a>02289               !Empty($nazev) &amp;&amp;
<a name="l02290"></a>02290               !$this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#e87f7ecb2c9c4a08632873e9f09c2563">ExistujeSablona</a>($adresa) &amp;&amp;
<a name="l02291"></a>02291               $this-&gt;povolit_pridani)
<a name="l02292"></a>02292           {
<a name="l02293"></a>02293             <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"INSERT INTO sablona_kniha (id, adresa, razeni, nove_rss, nazev, popisek, href_id, href_class, href_akce, zobrazit) VALUES</span>
<a name="l02294"></a>02294 <span class="stringliteral">                                          (NULL, '{$adresa}', '{$razeni}', {$nove_rss}, '{$nazev}', '{$popisek}', '{$href_id}', '{$href_class}', '{$href_akce}', {$zobrazit});"</span>, $error))
<a name="l02295"></a>02295             {
<a name="l02296"></a>02296               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addsab_hlaska"</span>], $nazev);
<a name="l02297"></a>02297 
<a name="l02298"></a>02298               $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02299"></a>02299             }
<a name="l02300"></a>02300               <span class="keywordflow">else</span>
<a name="l02301"></a>02301             {
<a name="l02302"></a>02302               $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02303"></a>02303             }
<a name="l02304"></a>02304           }
<a name="l02305"></a>02305         <span class="keywordflow">break</span>;
<a name="l02306"></a>02306 
<a name="l02307"></a>02307         <span class="keywordflow">case</span> <span class="stringliteral">"editsab"</span>:  <span class="comment">//uprava skupiny</span>
<a name="l02308"></a>02308           $id = $_GET[<span class="stringliteral">"id"</span>];  <span class="comment">//cislo sekce</span>
<a name="l02309"></a>02309           settype($id, <span class="stringliteral">"integer"</span>);
<a name="l02310"></a>02310 
<a name="l02311"></a>02311           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT adresa, razeni, nove_rss, nazev, popisek, href_id, href_class, href_akce, zobrazit FROM sablona_kniha WHERE id={$id};"</span>, NULL, $error))
<a name="l02312"></a>02312           {
<a name="l02313"></a>02313             <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l02314"></a>02314             {
<a name="l02315"></a>02315               $data = $res-&gt;fetchObject();
<a name="l02316"></a>02316 
<a name="l02317"></a>02317               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_editsab"</span>],
<a name="l02318"></a>02318                                                   $data-&gt;adresa,
<a name="l02319"></a>02319                                                   ($data-&gt;razeni == <span class="stringliteral">"ASC"</span> ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02320"></a>02320                                                   ($data-&gt;razeni == <span class="stringliteral">"DESC"</span> ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02321"></a>02321                                                   $data-&gt;nove_rss,
<a name="l02322"></a>02322                                                   $data-&gt;nazev,
<a name="l02323"></a>02323                                                   $data-&gt;popisek,
<a name="l02324"></a>02324                                                   $data-&gt;href_id,
<a name="l02325"></a>02325                                                   $data-&gt;href_class,
<a name="l02326"></a>02326                                                   $data-&gt;href_akce,
<a name="l02327"></a>02327                                                   ($data-&gt;zobrazit ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>));
<a name="l02328"></a>02328 
<a name="l02329"></a>02329               $adresa = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"adresa"</span>], ENT_QUOTES));
<a name="l02330"></a>02330               $razeni = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"razeni"</span>], ENT_QUOTES));
<a name="l02331"></a>02331               $nove_rss = $_POST[<span class="stringliteral">"nove_rss"</span>];
<a name="l02332"></a>02332               settype($nove_rss, <span class="stringliteral">"integer"</span>);
<a name="l02333"></a>02333               $nazev = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"nazev"</span>], ENT_QUOTES));
<a name="l02334"></a>02334               $popisek = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"popisek"</span>], ENT_QUOTES));
<a name="l02335"></a>02335               $href_id = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"href_id"</span>], ENT_QUOTES));
<a name="l02336"></a>02336               $href_class = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"href_class"</span>], ENT_QUOTES));
<a name="l02337"></a>02337               $href_akce = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"href_akce"</span>], ENT_QUOTES));
<a name="l02338"></a>02338               $zobrazit = (!Empty($_POST[<span class="stringliteral">"zobrazit"</span>]) ? 1 : 0);
<a name="l02339"></a>02339 
<a name="l02340"></a>02340               <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l02341"></a>02341                   !Empty($adresa) &amp;&amp;
<a name="l02342"></a>02342                   !Empty($nazev) &amp;&amp;
<a name="l02343"></a>02343                   $id != 0)
<a name="l02344"></a>02344               {
<a name="l02345"></a>02345                 <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"UPDATE sablona_kniha SET adresa='{$adresa}',</span>
<a name="l02346"></a>02346 <span class="stringliteral">                                                                        razeni='{$razeni}',</span>
<a name="l02347"></a>02347 <span class="stringliteral">                                                                        nove_rss={$nove_rss},</span>
<a name="l02348"></a>02348 <span class="stringliteral">                                                                        nazev='{$nazev}',</span>
<a name="l02349"></a>02349 <span class="stringliteral">                                                                        popisek='{$popisek}',</span>
<a name="l02350"></a>02350 <span class="stringliteral">                                                                        href_id='{$href_id}',</span>
<a name="l02351"></a>02351 <span class="stringliteral">                                                                        href_class='{$href_class}',</span>
<a name="l02352"></a>02352 <span class="stringliteral">                                                                        href_akce='{$href_akce}',</span>
<a name="l02353"></a>02353 <span class="stringliteral">                                                                        zobrazit={$zobrazit}</span>
<a name="l02354"></a>02354 <span class="stringliteral">                                                                        WHERE id={$id};"</span>, $error))
<a name="l02355"></a>02355                 {
<a name="l02356"></a>02356                   <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_editsab_hlaska"</span>], $nazev);
<a name="l02357"></a>02357 
<a name="l02358"></a>02358                   $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02359"></a>02359                 }
<a name="l02360"></a>02360                   <span class="keywordflow">else</span>
<a name="l02361"></a>02361                 {
<a name="l02362"></a>02362                   $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02363"></a>02363                 }
<a name="l02364"></a>02364               }
<a name="l02365"></a>02365             }
<a name="l02366"></a>02366           }
<a name="l02367"></a>02367             <span class="keywordflow">else</span>
<a name="l02368"></a>02368           {
<a name="l02369"></a>02369             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02370"></a>02370           }
<a name="l02371"></a>02371         <span class="keywordflow">break</span>;
<a name="l02372"></a>02372 
<a name="l02373"></a>02373         <span class="keywordflow">case</span> <span class="stringliteral">"delsab"</span>: <span class="comment">//mazani podle id skupny</span>
<a name="l02374"></a>02374           $id = $_GET[<span class="stringliteral">"id"</span>];  <span class="comment">//cislo sekce</span>
<a name="l02375"></a>02375           settype($id, <span class="stringliteral">"integer"</span>);
<a name="l02376"></a>02376           $id = ($this-&gt;povolit_pridani ? $id : 0); <span class="comment">//zakaz odmazani</span>
<a name="l02377"></a>02377 
<a name="l02378"></a>02378           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT nazev FROM sablona_kniha WHERE id={$id};"</span>, NULL, $error))
<a name="l02379"></a>02379           {
<a name="l02380"></a>02380             <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l02381"></a>02381             {
<a name="l02382"></a>02382               $data = $res-&gt;fetchObject();
<a name="l02383"></a>02383 
<a name="l02384"></a>02384               <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"DELETE FROM sablona_kniha WHERE id={$id};</span>
<a name="l02385"></a>02385 <span class="stringliteral">                                            DELETE FROM element_kniha WHERE sablona={$id};</span>
<a name="l02386"></a>02386 <span class="stringliteral">                                            DELETE FROM obsah_sablony_kniha WHERE sablona={$id};"</span>, $error)) <span class="comment">//provedeni dotazu</span>
<a name="l02387"></a>02387               {
<a name="l02388"></a>02388                 <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_delsab_hlaska"</span>], $data-&gt;nazev);
<a name="l02389"></a>02389 
<a name="l02390"></a>02390                 $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02391"></a>02391               }
<a name="l02392"></a>02392                 <span class="keywordflow">else</span>
<a name="l02393"></a>02393               {
<a name="l02394"></a>02394                 $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02395"></a>02395               }
<a name="l02396"></a>02396             }
<a name="l02397"></a>02397           }
<a name="l02398"></a>02398             <span class="keywordflow">else</span>
<a name="l02399"></a>02399           {
<a name="l02400"></a>02400             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02401"></a>02401           }
<a name="l02402"></a>02402         <span class="keywordflow">break</span>;
<a name="l02403"></a>02403 
<a name="l02404"></a>02404         <span class="keywordflow">case</span> <span class="stringliteral">"addelem"</span>: <span class="comment">//pridavani elementu</span>
<a name="l02405"></a>02405           $sab = $_GET[<span class="stringliteral">"sab"</span>];
<a name="l02406"></a>02406           settype($sab, <span class="stringliteral">"integer"</span>);
<a name="l02407"></a>02407           $type = $_GET[<span class="stringliteral">"typ"</span>];
<a name="l02408"></a>02408           settype($type, <span class="stringliteral">"integer"</span>);
<a name="l02409"></a>02409           $vstup = $_GET[<span class="stringliteral">"vstup"</span>];
<a name="l02410"></a>02410           settype($vstup, <span class="stringliteral">"integer"</span>);
<a name="l02411"></a>02411 
<a name="l02412"></a>02412           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addelem"</span>],
<a name="l02413"></a>02413                                               $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#6e8f6df8063b666e27cd2b36499e06c8">VyberSablony</a>($sab),
<a name="l02414"></a>02414                                               $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#a6d900f45ed85511a07df96d3cb22456">VyberTypu</a>($type, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addelem&amp;amp;sab={$sab}&amp;amp;vstup={$vstup}"</span>),
<a name="l02415"></a>02415                                               ($type &lt; 3 || $type &gt;= 7 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_value"</span>], <span class="stringliteral">""</span>) :
<a name="l02416"></a>02416                                                                         ($type == 3 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_captcha"</span>], <span class="stringliteral">""</span>) : <span class="stringliteral">""</span>)), <span class="comment">//($type == 4 ? date("d.m.Y") : ($type == 5 ? date("H:i:s") : ($type == 6 ? date("d.m.Y H:i:s") : "")))</span>
<a name="l02417"></a>02417                                               ($type == 1 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_skryt_obsah"</span>], <span class="stringliteral">""</span>) : <span class="stringliteral">""</span>),
<a name="l02418"></a>02418                                               ($type &lt; 3 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_vstupni_typ"</span>], $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#041011da2ed8d6ed66ae88eb4fce4f8d">VyberVstupu</a>($vstup, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addelem&amp;amp;sab={$sab}&amp;amp;typ={$type}"</span>)) : <span class="stringliteral">""</span>),
<a name="l02419"></a>02419                                               ($type &lt; 3 &amp;&amp; $vstup == 2 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_reg_exp"</span>], <span class="stringliteral">""</span>) : <span class="stringliteral">""</span>),
<a name="l02420"></a>02420                                               ($type &gt;= 4 &amp;&amp; $type &lt;= 6 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_vystupni_format"</span>], ($type == 4 ? <span class="stringliteral">"d.m.Y"</span> : ($type == 5 ? <span class="stringliteral">"H:i:s"</span> : <span class="stringliteral">"d.m.Y H:i:s"</span>))) : <span class="stringliteral">""</span>),
<a name="l02421"></a>02421                                               ($type &lt; 3 &amp;&amp; $vstup &gt;= 0 &amp;&amp; $vstup &lt;= 1 ?$this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_min_max_poc"</span>], 0, 0) : <span class="stringliteral">""</span>),
<a name="l02422"></a>02422                                               $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#9ec112d03928d348f8ce9b3f1d3635e5">PocetRadku</a>($sab, 1));
<a name="l02423"></a>02423 
<a name="l02424"></a>02424           $sablona = $_POST[<span class="stringliteral">"sablona"</span>];
<a name="l02425"></a>02425           settype($sablona, <span class="stringliteral">"integer"</span>);
<a name="l02426"></a>02426           $typ = $_POST[<span class="stringliteral">"typ"</span>];
<a name="l02427"></a>02427           settype($typ, <span class="stringliteral">"integer"</span>);
<a name="l02428"></a>02428           $nazev = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"nazev"</span>], ENT_QUOTES));
<a name="l02429"></a>02429           $value = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"value"</span>], ENT_QUOTES));
<a name="l02430"></a>02430           $input_id = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"input_id"</span>], ENT_QUOTES));
<a name="l02431"></a>02431           $input_class = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"input_class"</span>], ENT_QUOTES));
<a name="l02432"></a>02432           $input_akce = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"input_akce"</span>], ENT_QUOTES));
<a name="l02433"></a>02433           $povinne = (!Empty($_POST[<span class="stringliteral">"povinne"</span>]) ? 1 : 0);
<a name="l02434"></a>02434           $skryt_obsah = (!Empty($_POST[<span class="stringliteral">"skryt_obsah"</span>]) ? 1 : 0);
<a name="l02435"></a>02435           <a class="code" href="classDynamicNavstevniKniha.html#63d1d8d27c371b6668923fb77b863082">$vstupni_typ</a> = $_POST[<span class="stringliteral">"vstupni_typ"</span>];
<a name="l02436"></a>02436           settype(<a class="code" href="classDynamicNavstevniKniha.html#63d1d8d27c371b6668923fb77b863082">$vstupni_typ</a>, <span class="stringliteral">"integer"</span>);
<a name="l02437"></a>02437           $reg_exp = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"reg_exp"</span>], ENT_QUOTES));
<a name="l02438"></a>02438           $vystupni_format = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"vystupni_format"</span>], ENT_QUOTES));
<a name="l02439"></a>02439           $min_val = $_POST[<span class="stringliteral">"min_val"</span>];
<a name="l02440"></a>02440           settype($min_val, <span class="stringliteral">"integer"</span>);
<a name="l02441"></a>02441           $max_val = $_POST[<span class="stringliteral">"max_val"</span>];
<a name="l02442"></a>02442           settype($max_val, <span class="stringliteral">"integer"</span>);
<a name="l02443"></a>02443           $poradi = $_POST[<span class="stringliteral">"poradi"</span>];
<a name="l02444"></a>02444           settype($poradi, <span class="stringliteral">"integer"</span>);
<a name="l02445"></a>02445 
<a name="l02446"></a>02446           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l02447"></a>02447               !Empty($nazev) &amp;&amp;
<a name="l02448"></a>02448               $poradi &gt; 0 &amp;&amp;
<a name="l02449"></a>02449               $this-&gt;povolit_pridani)
<a name="l02450"></a>02450           {
<a name="l02451"></a>02451             <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"INSERT INTO element_kniha (id, sablona, typ, nazev, value, input_id, input_class, input_akce, povinne, skryt_obsah, vstupni_typ, reg_exp, vystupni_format, min_val, max_val, poradi) VALUES</span>
<a name="l02452"></a>02452 <span class="stringliteral">                                          (NULL, {$sablona}, {$typ}, '{$nazev}', '{$value}', '{$input_id}', '{$input_class}', '{$input_akce}', {$povinne}, {$skryt_obsah}, {$vstupni_typ}, '{$reg_exp}', '{$vystupni_format}', {$min_val}, {$max_val}, {$poradi});"</span>, $error))
<a name="l02453"></a>02453             {
<a name="l02454"></a>02454               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addelem_hlaska"</span>], $nazev);
<a name="l02455"></a>02455 
<a name="l02456"></a>02456               $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02457"></a>02457             }
<a name="l02458"></a>02458               <span class="keywordflow">else</span>
<a name="l02459"></a>02459             {
<a name="l02460"></a>02460               $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02461"></a>02461             }
<a name="l02462"></a>02462           }
<a name="l02463"></a>02463         <span class="keywordflow">break</span>;
<a name="l02464"></a>02464 
<a name="l02465"></a>02465         <span class="keywordflow">case</span> <span class="stringliteral">"editelem"</span>:  <span class="comment">//uprava elementu</span>
<a name="l02466"></a>02466           $id = $_GET[<span class="stringliteral">"id"</span>];  <span class="comment">//cislo sekce</span>
<a name="l02467"></a>02467           settype($id, <span class="stringliteral">"integer"</span>);
<a name="l02468"></a>02468           $sab = $_GET[<span class="stringliteral">"sab"</span>];
<a name="l02469"></a>02469           settype($sab, <span class="stringliteral">"integer"</span>);
<a name="l02470"></a>02470           $type = $_GET[<span class="stringliteral">"typ"</span>];
<a name="l02471"></a>02471           settype($type, <span class="stringliteral">"integer"</span>);
<a name="l02472"></a>02472           $vstup = $_GET[<span class="stringliteral">"vstup"</span>];
<a name="l02473"></a>02473           settype($vstup, <span class="stringliteral">"integer"</span>);
<a name="l02474"></a>02474 
<a name="l02475"></a>02475           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT sablona, typ, nazev, value, input_id, input_class, input_akce, povinne, skryt_obsah, vstupni_typ, reg_exp, vystupni_format, min_val, max_val, poradi FROM element_kniha WHERE id={$id};"</span>, NULL, $error))
<a name="l02476"></a>02476           {
<a name="l02477"></a>02477             <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l02478"></a>02478             {
<a name="l02479"></a>02479               $data = $res-&gt;fetchObject();
<a name="l02480"></a>02480 
<a name="l02481"></a>02481               $sab_1 = (!Empty($sab) ? $sab : $data-&gt;sablona);
<a name="l02482"></a>02482               $type_1 = (isset($_GET[<span class="stringliteral">"typ"</span>]) ? $type : $data-&gt;typ);
<a name="l02483"></a>02483               $vstup_1 = (isset($_GET[<span class="stringliteral">"vstup"</span>]) ? $vstup : $data-&gt;vstupni_typ);
<a name="l02484"></a>02484 
<a name="l02485"></a>02485               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_editelem"</span>],
<a name="l02486"></a>02486                                                   $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#6e8f6df8063b666e27cd2b36499e06c8">VyberSablony</a>($sab_1),
<a name="l02487"></a>02487                                                   $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#a6d900f45ed85511a07df96d3cb22456">VyberTypu</a>($type_1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=editelem&amp;amp;id={$id}&amp;amp;sab={$sab_1}&amp;amp;vstup={$vstup_1}"</span>),
<a name="l02488"></a>02488                                                   $data-&gt;nazev,
<a name="l02489"></a>02489                                                   ($type_1 &lt; 3 || $type_1 == 7 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_value"</span>], $data-&gt;value) :
<a name="l02490"></a>02490                                                                                 ($type_1 == 3 ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_captcha"</span>], $data-&gt;value) : <span class="stringliteral">""</span>)),
<a name="l02491"></a>02491                                                   $data-&gt;input_id,
<a name="l02492"></a>02492                                                   $data-&gt;input_class,
<a name="l02493"></a>02493                                                   $data-&gt;input_akce,
<a name="l02494"></a>02494                                                   ($data-&gt;povinne ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02495"></a>02495                                                   ($type_1 == 1 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_skryt_obsah"</span>], ($data-&gt;skryt_obsah ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>)) : <span class="stringliteral">""</span>),
<a name="l02496"></a>02496                                                   ($type_1 &lt; 3 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_vstupni_typ"</span>], $this-&gt;<a class="code" href="classDynamicNavstevniKniha.html#041011da2ed8d6ed66ae88eb4fce4f8d">VyberVstupu</a>($vstup_1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=editelem&amp;amp;id={$id}&amp;amp;sab={$sab_1}&amp;amp;typ={$type_1}"</span>)) : <span class="stringliteral">""</span>),
<a name="l02497"></a>02497                                                   ($type_1 &lt; 3 &amp;&amp; $vstup_1 == 2 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_reg_exp"</span>], $data-&gt;reg_exp) : <span class="stringliteral">""</span>),
<a name="l02498"></a>02498                                                   ($type_1 &gt;= 4 &amp;&amp; $type_1 &lt;= 6 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_vystupni_format"</span>], (!isset($_GET[<span class="stringliteral">"typ"</span>]) ? $data-&gt;vystupni_format : ($type_1 == 4 ? <span class="stringliteral">"d.m.Y"</span> : ($type_1 == 5 ? <span class="stringliteral">"H:i:s"</span> : <span class="stringliteral">"d.m.Y H:i:s"</span>)))) : <span class="stringliteral">""</span>),
<a name="l02499"></a>02499                                                   ($type_1 &lt; 3 &amp;&amp; $vstup_1 &gt;= 0 &amp;&amp; $vstup_1 &lt;= 1 ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_addeditelem_min_max_poc"</span>], $data-&gt;min_val, $data-&gt;max_val) : <span class="stringliteral">""</span>),
<a name="l02500"></a>02500                                                   $data-&gt;poradi);
<a name="l02501"></a>02501 
<a name="l02502"></a>02502               $sablona = $_POST[<span class="stringliteral">"sablona"</span>];
<a name="l02503"></a>02503               settype($sablona, <span class="stringliteral">"integer"</span>);
<a name="l02504"></a>02504               $typ = $_POST[<span class="stringliteral">"typ"</span>];
<a name="l02505"></a>02505               settype($typ, <span class="stringliteral">"integer"</span>);
<a name="l02506"></a>02506               $nazev = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"nazev"</span>], ENT_QUOTES));
<a name="l02507"></a>02507               $value = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"value"</span>], ENT_QUOTES));
<a name="l02508"></a>02508               $input_id = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"input_id"</span>], ENT_QUOTES));
<a name="l02509"></a>02509               $input_class = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"input_class"</span>], ENT_QUOTES));
<a name="l02510"></a>02510               $input_akce = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"input_akce"</span>], ENT_QUOTES));
<a name="l02511"></a>02511               $povinne = (!Empty($_POST[<span class="stringliteral">"povinne"</span>]) ? 1 : 0);
<a name="l02512"></a>02512               $skryt_obsah = (!Empty($_POST[<span class="stringliteral">"skryt_obsah"</span>]) ? 1 : 0);
<a name="l02513"></a>02513               <a class="code" href="classDynamicNavstevniKniha.html#63d1d8d27c371b6668923fb77b863082">$vstupni_typ</a> = $_POST[<span class="stringliteral">"vstupni_typ"</span>];
<a name="l02514"></a>02514               settype(<a class="code" href="classDynamicNavstevniKniha.html#63d1d8d27c371b6668923fb77b863082">$vstupni_typ</a>, <span class="stringliteral">"integer"</span>);
<a name="l02515"></a>02515               $reg_exp = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"reg_exp"</span>], ENT_QUOTES));
<a name="l02516"></a>02516               $vystupni_format = stripslashes(htmlspecialchars($_POST[<span class="stringliteral">"vystupni_format"</span>], ENT_QUOTES));
<a name="l02517"></a>02517               $min_val = $_POST[<span class="stringliteral">"min_val"</span>];
<a name="l02518"></a>02518               settype($min_val, <span class="stringliteral">"integer"</span>);
<a name="l02519"></a>02519               $max_val = $_POST[<span class="stringliteral">"max_val"</span>];
<a name="l02520"></a>02520               settype($max_val, <span class="stringliteral">"integer"</span>);
<a name="l02521"></a>02521               $poradi = $_POST[<span class="stringliteral">"poradi"</span>];
<a name="l02522"></a>02522               settype($poradi, <span class="stringliteral">"integer"</span>);
<a name="l02523"></a>02523 
<a name="l02524"></a>02524               <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l02525"></a>02525                   !Empty($nazev) &amp;&amp;
<a name="l02526"></a>02526                   $poradi &gt; 0 &amp;&amp;
<a name="l02527"></a>02527                   $id != 0)
<a name="l02528"></a>02528               {
<a name="l02529"></a>02529                 <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"UPDATE element_kniha SET sablona={$sablona},</span>
<a name="l02530"></a>02530 <span class="stringliteral">                                                                        typ={$typ},</span>
<a name="l02531"></a>02531 <span class="stringliteral">                                                                        nazev='{$nazev}',</span>
<a name="l02532"></a>02532 <span class="stringliteral">                                                                        value='{$value}',</span>
<a name="l02533"></a>02533 <span class="stringliteral">                                                                        input_id='{$input_id}',</span>
<a name="l02534"></a>02534 <span class="stringliteral">                                                                        input_class='{$input_class}',</span>
<a name="l02535"></a>02535 <span class="stringliteral">                                                                        input_akce='{$input_akce}',</span>
<a name="l02536"></a>02536 <span class="stringliteral">                                                                        povinne={$povinne},</span>
<a name="l02537"></a>02537 <span class="stringliteral">                                                                        skryt_obsah={$skryt_obsah},</span>
<a name="l02538"></a>02538 <span class="stringliteral">                                                                        vstupni_typ={$vstupni_typ},</span>
<a name="l02539"></a>02539 <span class="stringliteral">                                                                        reg_exp='{$reg_exp}',</span>
<a name="l02540"></a>02540 <span class="stringliteral">                                                                        vystupni_format='{$vystupni_format}',</span>
<a name="l02541"></a>02541 <span class="stringliteral">                                                                        min_val={$min_val},</span>
<a name="l02542"></a>02542 <span class="stringliteral">                                                                        max_val={$max_val},</span>
<a name="l02543"></a>02543 <span class="stringliteral">                                                                        poradi={$poradi}</span>
<a name="l02544"></a>02544 <span class="stringliteral">                                                                        WHERE id={$id};"</span>, $error))
<a name="l02545"></a>02545                 {
<a name="l02546"></a>02546                   <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_editelem_hlaska"</span>], $nazev);
<a name="l02547"></a>02547 
<a name="l02548"></a>02548                   $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02549"></a>02549                 }
<a name="l02550"></a>02550                   <span class="keywordflow">else</span>
<a name="l02551"></a>02551                 {
<a name="l02552"></a>02552                   $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02553"></a>02553                 }
<a name="l02554"></a>02554               }
<a name="l02555"></a>02555             }
<a name="l02556"></a>02556           }
<a name="l02557"></a>02557             <span class="keywordflow">else</span>
<a name="l02558"></a>02558           {
<a name="l02559"></a>02559             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02560"></a>02560           }
<a name="l02561"></a>02561         <span class="keywordflow">break</span>;
<a name="l02562"></a>02562 
<a name="l02563"></a>02563         <span class="keywordflow">case</span> <span class="stringliteral">"delelem"</span>: <span class="comment">//mazani podle id skupny</span>
<a name="l02564"></a>02564           $id = $_GET[<span class="stringliteral">"id"</span>];  <span class="comment">//cislo sekce</span>
<a name="l02565"></a>02565           settype($id, <span class="stringliteral">"integer"</span>);
<a name="l02566"></a>02566           $id = ($this-&gt;povolit_pridani ? $id : 0); <span class="comment">//zakaz odmazani</span>
<a name="l02567"></a>02567 
<a name="l02568"></a>02568           <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT nazev FROM element_kniha WHERE id={$id};"</span>, NULL, $error))
<a name="l02569"></a>02569           {
<a name="l02570"></a>02570             <span class="keywordflow">if</span> ($res-&gt;numRows() == 1)
<a name="l02571"></a>02571             {
<a name="l02572"></a>02572               $data = $res-&gt;fetchObject();
<a name="l02573"></a>02573 
<a name="l02574"></a>02574               <span class="keywordflow">if</span> (@$this-&gt;sqlite-&gt;queryExec(<span class="stringliteral">"DELETE FROM element_kniha WHERE id={$id};"</span>, $error)) <span class="comment">//provedeni dotazu</span>
<a name="l02575"></a>02575               {
<a name="l02576"></a>02576                 <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_delelem_hlaska"</span>], $data-&gt;nazev);
<a name="l02577"></a>02577 
<a name="l02578"></a>02578                 $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l02579"></a>02579               }
<a name="l02580"></a>02580                 <span class="keywordflow">else</span>
<a name="l02581"></a>02581               {
<a name="l02582"></a>02582                 $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02583"></a>02583               }
<a name="l02584"></a>02584             }
<a name="l02585"></a>02585           }
<a name="l02586"></a>02586             <span class="keywordflow">else</span>
<a name="l02587"></a>02587           {
<a name="l02588"></a>02588             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02589"></a>02589           }
<a name="l02590"></a>02590         <span class="keywordflow">break</span>;
<a name="l02591"></a>02591       }
<a name="l02592"></a>02592     }
<a name="l02593"></a>02593 
<a name="l02594"></a>02594     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02595"></a>02595   }
<a name="l02596"></a>02596 
<a name="l02603"></a><a class="code" href="classDynamicNavstevniKniha.html#04a19d40c474d6b4ece8f068ed4d953b">02603</a>   <span class="keyword">private</span> function <a class="code" href="classDynamicNavstevniKniha.html#04a19d40c474d6b4ece8f068ed4d953b">AdminVypisObsahu</a>()
<a name="l02604"></a>02604   {
<a name="l02605"></a>02605     $typelementu = array_keys($this-&gt;element);
<a name="l02606"></a>02606 
<a name="l02607"></a>02607     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l02608"></a>02608     <span class="keywordflow">if</span> ($res = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, adresa, nazev, popisek FROM sablona_kniha ORDER BY nazev ASC;"</span>, NULL, $error))
<a name="l02609"></a>02609     {
<a name="l02610"></a>02610       <span class="keywordflow">if</span> ($res-&gt;numRows() != 0)
<a name="l02611"></a>02611       {
<a name="l02612"></a>02612         <span class="keywordflow">while</span> ($data = $res-&gt;fetchObject())
<a name="l02613"></a>02613         {
<a name="l02614"></a>02614           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_sablona"</span>],
<a name="l02615"></a>02615                                               $data-&gt;id,
<a name="l02616"></a>02616                                               $data-&gt;adresa,
<a name="l02617"></a>02617                                               $data-&gt;nazev,
<a name="l02618"></a>02618                                               $data-&gt;popisek,
<a name="l02619"></a>02619                                               <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=editsab&amp;amp;id={$data-&gt;id}"</span>,
<a name="l02620"></a>02620                                               ($this-&gt;povolit_pridani ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_sablona_adddel_link"</span>],
<a name="l02621"></a>02621                                                                                                   <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=delsab&amp;amp;id={$data-&gt;id}"</span>,
<a name="l02622"></a>02622                                                                                                   <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addelem&amp;amp;sab={$data-&gt;id}"</span>,
<a name="l02623"></a>02623                                                                                                   $data-&gt;nazev) : <span class="stringliteral">""</span>)
<a name="l02624"></a>02624                                               );
<a name="l02625"></a>02625 
<a name="l02626"></a>02626           <span class="keywordflow">if</span> ($res1 = @$this-&gt;sqlite-&gt;query(<span class="stringliteral">"SELECT id, typ, nazev, value, povinne, skryt_obsah, vstupni_typ, vystupni_format, poradi FROM element_kniha WHERE sablona={$data-&gt;id} ORDER BY poradi ASC;"</span>, NULL, $error))
<a name="l02627"></a>02627           {
<a name="l02628"></a>02628             <span class="keywordflow">if</span> ($res1-&gt;numRows() != 0)
<a name="l02629"></a>02629             {
<a name="l02630"></a>02630               <span class="keywordflow">while</span> ($data1 = $res1-&gt;fetchObject())
<a name="l02631"></a>02631               {
<a name="l02632"></a>02632                 <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_element"</span>],
<a name="l02633"></a>02633                                                     $data1-&gt;nazev,
<a name="l02634"></a>02634                                                     (!Empty($data1-&gt;value) ? $data1-&gt;value : <span class="stringliteral">"---"</span>),
<a name="l02635"></a>02635                                                     $typelementu[$data1-&gt;typ],
<a name="l02636"></a>02636                                                     ($data1-&gt;povinne ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02637"></a>02637                                                     ($data1-&gt;skryt_obsah ? <span class="stringliteral">" checked=\"checked\""</span> : <span class="stringliteral">""</span>),
<a name="l02638"></a>02638                                                     $this-&gt;vstupni_typ[$data1-&gt;vstupni_typ],
<a name="l02639"></a>02639                                                     (!Empty($data1-&gt;vystupni_format) ? $data1-&gt;vystupni_format : <span class="stringliteral">"---"</span>),
<a name="l02640"></a>02640                                                     $data1-&gt;poradi,
<a name="l02641"></a>02641                                                     <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=editelem&amp;amp;id={$data1-&gt;id}"</span>,
<a name="l02642"></a>02642                                                     ($this-&gt;povolit_pridani ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_del_link"</span>],
<a name="l02643"></a>02643                                                                                                         <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=delelem&amp;amp;id={$data1-&gt;id}"</span>,
<a name="l02644"></a>02644                                                                                                         $data1-&gt;nazev) : <span class="stringliteral">""</span>));
<a name="l02645"></a>02645               }
<a name="l02646"></a>02646             }
<a name="l02647"></a>02647           }
<a name="l02648"></a>02648             <span class="keywordflow">else</span>
<a name="l02649"></a>02649           {
<a name="l02650"></a>02650             $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02651"></a>02651           }
<a name="l02652"></a>02652 
<a name="l02653"></a>02653           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_skupina_end"</span>]);
<a name="l02654"></a>02654         }
<a name="l02655"></a>02655       }
<a name="l02656"></a>02656     }
<a name="l02657"></a>02657       <span class="keywordflow">else</span>
<a name="l02658"></a>02658     {
<a name="l02659"></a>02659       $this-&gt;var-&gt;main[0]-&gt;ErrorMsg($error);
<a name="l02660"></a>02660     }
<a name="l02661"></a>02661 
<a name="l02662"></a>02662     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l02663"></a>02663   }
<a name="l02664"></a>02664 }
<a name="l02665"></a>02665 ?&gt;
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generováno Tue Aug 4 13:38:11 2009 pro projekt Novy vychozi PHP layout programem&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>

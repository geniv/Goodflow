<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Novy vychozi PHP layout: Zdrojový soubor /var/www/phplayout/funkce.php</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generováno programem Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Hlavní&nbsp;stránka</span></a></li>
      <li><a href="annotated.html"><span>Třídy</span></a></li>
      <li class="current"><a href="files.html"><span>Soubory</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>Seznam&nbsp;souborů</span></a></li>
      <li><a href="globals.html"><span>Symboly&nbsp;v&nbsp;souborech</span></a></li>
    </ul>
  </div>
<h1>/var/www/phplayout/funkce.php</h1><a href="funkce_8php.html">Zobrazit dokumentaci tohoto souboru.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00006"></a><a class="code" href="classAutoStart.html">00006</a> <span class="keyword">class </span><a class="code" href="classAutoStart.html">AutoStart</a>
<a name="l00007"></a>00007 {
<a name="l00008"></a>00008 <span class="comment">/*</span>
<a name="l00009"></a>00009 <span class="comment"> * Konstruktor autostartu</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * @return nacteny default_modul</span>
<a name="l00012"></a>00012 <span class="comment"> */</span>
<a name="l00013"></a><a class="code" href="classAutoStart.html#efe8713a6fbd3df0a3b1659d2f66573c">00013</a>   <span class="keyword">public</span> function <a class="code" href="classAutoStart.html#efe8713a6fbd3df0a3b1659d2f66573c">__construct</a>()
<a name="l00014"></a>00014   {
<a name="l00015"></a>00015     $cesta = <span class="stringliteral">"default_modul.php"</span>;
<a name="l00016"></a>00016 
<a name="l00017"></a>00017     $poc = 0;
<a name="l00018"></a>00018     <span class="keywordflow">while</span> (!file_exists($cesta))
<a name="l00019"></a>00019     {
<a name="l00020"></a>00020       $cesta = <span class="stringliteral">"../{$cesta}"</span>;
<a name="l00021"></a>00021       $poc++;
<a name="l00022"></a>00022 
<a name="l00023"></a>00023       <span class="keywordflow">if</span> ($poc &gt; 10)  <span class="comment">//kontrola zacykleni</span>
<a name="l00024"></a>00024       {
<a name="l00025"></a>00025         <span class="keywordflow">break</span>;
<a name="l00026"></a>00026       }
<a name="l00027"></a>00027     }
<a name="l00028"></a>00028 
<a name="l00029"></a>00029     <span class="keywordflow">if</span> (file_exists($cesta))
<a name="l00030"></a>00030     {
<a name="l00031"></a>00031       include_once $cesta;
<a name="l00032"></a>00032     }
<a name="l00033"></a>00033       <span class="keywordflow">else</span>
<a name="l00034"></a>00034     {
<a name="l00035"></a>00035       echo <span class="stringliteral">"soubor: &lt;strong&gt;{$cesta}&lt;/strong&gt; nelze nalezt, zkontrolujte zda dany soubor existuje"</span>;
<a name="l00036"></a>00036       exit(1);
<a name="l00037"></a>00037     }
<a name="l00038"></a>00038   }
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="funkce_8php.html#50a00e7de77365e00b117e73aa82fb9b">00041</a> <a class="code" href="funkce_8php.html#50a00e7de77365e00b117e73aa82fb9b">$start</a> = <span class="keyword">new</span> <a class="code" href="classAutoStart.html">AutoStart</a>(); <span class="comment">//vkladani default_modul</span>
<a name="l00042"></a>00042 
<a name="l00088"></a><a class="code" href="classFunkce.html">00088</a> <span class="keyword">class </span><a class="code" href="classFunkce.html">Funkce</a> <span class="keyword">extends</span> <a class="code" href="classDefaultModule.html">DefaultModule</a>
<a name="l00089"></a>00089 {
<a name="l00090"></a><a class="code" href="classFunkce.html#779d6a431df9aae8f19b5740c9b499b4">00090</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#0e6e074acfb123ea7d26eba2f8483ecb">$start</a>, <a class="code" href="classFunkce.html#e5174587f8a13f14df423df187f5394b">$konec</a>, <a class="code" href="classFunkce.html#779d6a431df9aae8f19b5740c9b499b4">$var</a>, <a class="code" href="classFunkce.html#b0a88f7ba7f2060cab20e8d715edaf48">$logoff</a>, <a class="code" href="classFunkce.html#1ab227c0240c29281402ee550310dad1">$unikatni</a>;
<a name="l00091"></a><a class="code" href="classFunkce.html#f698f8f5233df3f35f90307f3b5f0179">00091</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#f698f8f5233df3f35f90307f3b5f0179">$idmodul</a> = <span class="stringliteral">"funkce"</span>;
<a name="l00092"></a><a class="code" href="classFunkce.html#806c8dbb2998a2138520479bb6c43569">00092</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#806c8dbb2998a2138520479bb6c43569">$idzaloha</a> = <span class="stringliteral">"zaloha"</span>;
<a name="l00093"></a><a class="code" href="classFunkce.html#c1df9b680b7abbe7a120b290b4a0ca28">00093</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#c1df9b680b7abbe7a120b290b4a0ca28">$iddelzal</a> = <span class="stringliteral">"delzal"</span>;
<a name="l00094"></a><a class="code" href="classFunkce.html#f671170b0e75f79c7e43b6a14ad4e2cc">00094</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#f671170b0e75f79c7e43b6a14ad4e2cc">$idupp</a> = <span class="stringliteral">"up"</span>;
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classFunkce.html#f7706a07d2d514e4405553e5e8762bcc">00096</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#f7706a07d2d514e4405553e5e8762bcc">$errorpage</a> = <span class="stringliteral">"error_page"</span>;
<a name="l00097"></a><a class="code" href="classFunkce.html#6dc71b4ef8b45fcb70eb02f1707d36bd">00097</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#6dc71b4ef8b45fcb70eb02f1707d36bd">$errorblok</a> = <span class="stringliteral">".vygenerovano"</span>;
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classFunkce.html#fdc1f07b24b9e9df4e09a0a0443c2890">00099</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#fdc1f07b24b9e9df4e09a0a0443c2890">$get_check</a> = <span class="stringliteral">"check"</span>;
<a name="l00100"></a><a class="code" href="classFunkce.html#175f3286bf95aa59082c89f5da61db9f">00100</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#175f3286bf95aa59082c89f5da61db9f">$get_download</a> = <span class="stringliteral">"down"</span>;
<a name="l00101"></a><a class="code" href="classFunkce.html#212b5379cbeb1bb74fd8aeeba7a50151">00101</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#212b5379cbeb1bb74fd8aeeba7a50151">$get_zdrojstazeni</a> = <span class="stringliteral">"source"</span>;
<a name="l00102"></a><a class="code" href="classFunkce.html#708a19c4988c90976d6e0df72339abbe">00102</a>   <span class="keyword">private</span> <a class="code" href="classFunkce.html#708a19c4988c90976d6e0df72339abbe">$get_showsource</a> = <span class="stringliteral">"soucefile"</span>;
<a name="l00103"></a>00103 
<a name="l00112"></a><a class="code" href="classFunkce.html#2211555f6119a442ebd7b1c855906969">00112</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#2211555f6119a442ebd7b1c855906969">__construct</a>(&amp;<a class="code" href="classFunkce.html#779d6a431df9aae8f19b5740c9b499b4">$var</a>, $index) <span class="comment">//konstruktor</span>
<a name="l00113"></a>00113   {
<a name="l00114"></a>00114     $this-&gt;var = <a class="code" href="classFunkce.html#779d6a431df9aae8f19b5740c9b499b4">$var</a>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="comment">//inicializace presunuty do funkce: InicializaceModulu()</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     <span class="comment">//includovani unikatniho obsahu</span>
<a name="l00119"></a>00119     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu ||
<a name="l00120"></a>00120           $_GET[$this-&gt;var-&gt;get_kam] == <span class="stringliteral">"logoff"</span>) <span class="comment">//includovani jen kdyz je v adminu</span>
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122       $this-&gt;unikatni = include <span class="stringliteral">".unikatni_fukce.php"</span>;
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124   }
<a name="l00125"></a>00125 
<a name="l00131"></a><a class="code" href="classFunkce.html#8937cba4b28a8b0df5df1c779a901fc1">00131</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#8937cba4b28a8b0df5df1c779a901fc1">StartSession</a>() <span class="comment">//aktvuje session promenne</span>
<a name="l00132"></a>00132   {
<a name="l00133"></a>00133     <span class="comment">//session_name("SSID"); //nastaveni jmena session</span>
<a name="l00134"></a>00134     <span class="comment">//session_register("ADMIN_USER");</span>
<a name="l00135"></a>00135     <span class="comment">//session_register("ADMIN_PASS");</span>
<a name="l00136"></a>00136     session_register(<span class="stringliteral">"ADMIN_TIME"</span>);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     session_start();
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140 
<a name="l00149"></a><a class="code" href="classFunkce.html#b11e85edc953ceb83955f3b43347d4f5">00149</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#b11e85edc953ceb83955f3b43347d4f5">AbsoluteUrl</a>()
<a name="l00150"></a>00150   {
<a name="l00151"></a>00151     $path = dirname($_SERVER[<span class="stringliteral">"SCRIPT_NAME"</span>]);
<a name="l00152"></a>00152     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">"http://{$_SERVER["</span>SERVER_NAME<span class="stringliteral">"]}"</span>.($path != <span class="stringliteral">"/"</span> ? <span class="stringliteral">"{$path}"</span> : <span class="stringliteral">""</span>).<span class="stringliteral">"/"</span>;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156 
<a name="l00163"></a><a class="code" href="classFunkce.html#33736de14d87634f70807da08e41b5fe">00163</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#33736de14d87634f70807da08e41b5fe">KontrolaVerze</a>()
<a name="l00164"></a>00164   {
<a name="l00165"></a>00165     $verze = explode(<span class="stringliteral">"."</span>, phpversion());
<a name="l00166"></a>00166     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $verze[0];
<a name="l00167"></a>00167     settype(<a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>, <span class="stringliteral">"integer"</span>);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00170"></a>00170   }
<a name="l00171"></a>00171 
<a name="l00182"></a><a class="code" href="classFunkce.html#43fa9aee80305cdab2f741ec01eb96ed">00182</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#43fa9aee80305cdab2f741ec01eb96ed">NactiFunkci</a>($index, $funkce)
<a name="l00183"></a>00183   {
<a name="l00184"></a>00184     $paramatr = func_get_args();
<a name="l00185"></a>00185     $pocet = func_num_args();
<a name="l00186"></a>00186     $argv = array();
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="keywordflow">if</span> ($pocet &gt; 2)
<a name="l00189"></a>00189     {
<a name="l00190"></a>00190       <span class="keywordflow">for</span> ($i = 2, $j = 0; $i &lt; $pocet; $i++, $j++)
<a name="l00191"></a>00191       {
<a name="l00192"></a>00192         $argv[$j] = $paramatr[$i];  <span class="comment">//prevedeni parametru</span>
<a name="l00193"></a>00193       }
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="comment">//echo ($this-&gt;var-&gt;debug_mod ? "načtené moduly: {$index}, {$funkce}&lt;br /&gt;" : "");</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <span class="keywordflow">if</span> (is_string($index))
<a name="l00199"></a>00199     {
<a name="l00200"></a>00200       $cis = $this-&gt;<a class="code" href="classFunkce.html#cff95312d5b967e3b322ff2f9302e7f6">NajdiIndexPodleTridy</a>($index); <span class="comment">//vrati index tridy - je-li nalezeno</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202       <span class="keywordflow">if</span> ($cis == -1)
<a name="l00203"></a>00203       {
<a name="l00204"></a>00204         $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_nacteni_tridy"</span>], $index), array(__LINE__, __METHOD__));
<a name="l00205"></a>00205       }
<a name="l00206"></a>00206         <span class="keywordflow">else</span>
<a name="l00207"></a>00207       {
<a name="l00208"></a>00208         $index = $cis;
<a name="l00209"></a>00209       }
<a name="l00210"></a>00210     }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00213"></a>00213     <span class="keywordflow">if</span> ($cis != -1)
<a name="l00214"></a>00214     {
<a name="l00215"></a>00215       <span class="keywordflow">if</span> (method_exists($this-&gt;var-&gt;moduly[$index][<span class="stringliteral">"class"</span>], $funkce))
<a name="l00216"></a>00216       {
<a name="l00217"></a>00217         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = call_user_func_array(array($this-&gt;var-&gt;main[$index], $funkce), $argv);  <span class="comment">//trida::funkce, parametry</span>
<a name="l00218"></a>00218       }
<a name="l00219"></a>00219         <span class="keywordflow">else</span>
<a name="l00220"></a>00220       {
<a name="l00221"></a>00221         <span class="keywordflow">if</span> (!Empty($this-&gt;var-&gt;moduly[$index][<span class="stringliteral">"class"</span>]))
<a name="l00222"></a>00222         {
<a name="l00223"></a>00223           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_nacteni_tridy_funkce"</span>], $this-&gt;var-&gt;moduly[$index][<span class="stringliteral">"class"</span>], $funkce), array(__LINE__, __METHOD__));
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225           <span class="keywordflow">else</span>
<a name="l00226"></a>00226         {
<a name="l00227"></a>00227           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_nacteni_tridy_class"</span>], $index), array(__LINE__, __METHOD__));
<a name="l00228"></a>00228         }
<a name="l00229"></a>00229       }
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00233"></a>00233   }
<a name="l00234"></a>00234 
<a name="l00242"></a><a class="code" href="classFunkce.html#cff95312d5b967e3b322ff2f9302e7f6">00242</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#cff95312d5b967e3b322ff2f9302e7f6">NajdiIndexPodleTridy</a>($trida)
<a name="l00243"></a>00243   {
<a name="l00244"></a>00244     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = -1;
<a name="l00245"></a>00245     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00246"></a>00246     {
<a name="l00247"></a>00247       <span class="keywordflow">if</span> ($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>] == $trida)
<a name="l00248"></a>00248       {
<a name="l00249"></a>00249         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $i;
<a name="l00250"></a>00250         <span class="keywordflow">break</span>;
<a name="l00251"></a>00251       }
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00255"></a>00255   }
<a name="l00256"></a>00256 
<a name="l00264"></a><a class="code" href="classFunkce.html#d37fffd7be10b2f8b1a9a7d9c5290503">00264</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#d37fffd7be10b2f8b1a9a7d9c5290503">NajdiIndexPodleCesty</a>($cesta)
<a name="l00265"></a>00265   {
<a name="l00266"></a>00266     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = -1;
<a name="l00267"></a>00267     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269       <span class="keywordflow">if</span> (dirname($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"include"</span>]) == $cesta)
<a name="l00270"></a>00270       {
<a name="l00271"></a>00271         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $i;
<a name="l00272"></a>00272         <span class="keywordflow">break</span>;
<a name="l00273"></a>00273       }
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00277"></a>00277   }
<a name="l00278"></a>00278 
<a name="l00284"></a><a class="code" href="classFunkce.html#321f134690e9b84a22eb375f3dafeafa">00284</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#321f134690e9b84a22eb375f3dafeafa">InicializaceModulu</a>()
<a name="l00285"></a>00285   {
<a name="l00286"></a>00286     <span class="keywordflow">for</span> ($i = 1; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00287"></a>00287     {
<a name="l00288"></a>00288       <span class="keywordflow">if</span> (file_exists($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"include"</span>]))
<a name="l00289"></a>00289       {
<a name="l00290"></a>00290         include_once <span class="stringliteral">"{$this-&gt;var-&gt;moduly[$i]["</span>include<span class="stringliteral">"]}"</span>;
<a name="l00291"></a>00291         <span class="keywordflow">if</span> (class_exists($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]))
<a name="l00292"></a>00292         {
<a name="l00293"></a>00293           <span class="keywordflow">if</span> (method_exists($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>], <span class="stringliteral">"__construct"</span>))
<a name="l00294"></a>00294           {
<a name="l00295"></a>00295             $this-&gt;var-&gt;main[$i] = <span class="keyword">new</span> $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]($this-&gt;var, $i);
<a name="l00296"></a>00296           }
<a name="l00297"></a>00297             <span class="keywordflow">else</span>
<a name="l00298"></a>00298           {
<a name="l00299"></a>00299             $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_main_init_construct_class"</span>], $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]), array(__LINE__, __METHOD__));
<a name="l00300"></a>00300           }
<a name="l00301"></a>00301         }
<a name="l00302"></a>00302           <span class="keywordflow">else</span>
<a name="l00303"></a>00303         {
<a name="l00304"></a>00304           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_main_init_exist_class"</span>], $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]), array(__LINE__, __METHOD__));
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306       }
<a name="l00307"></a>00307         <span class="keywordflow">else</span>
<a name="l00308"></a>00308       {
<a name="l00309"></a>00309         $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_main_init_not_exist"</span>], $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]), array(__LINE__, __METHOD__));
<a name="l00310"></a>00310       }
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <span class="comment">//includovani unikatniho obsahu</span>
<a name="l00314"></a>00314     <span class="comment">//$this-&gt;unikatni = $this-&gt;NactiObsahSouboru(".unikatni_fukce.php", false);</span>
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     $this-&gt;<a class="code" href="classFunkce.html#8937cba4b28a8b0df5df1c779a901fc1">StartSession</a>();
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     <span class="keywordflow">if</span> ($this-&gt;var-&gt;autoklenot)  <span class="comment">//kdyz bude IP v bloku tak jde o lokalhost tedy, o klenot se nejedna</span>
<a name="l00319"></a>00319     {
<a name="l00320"></a>00320       $this-&gt;var-&gt;klenot = (!in_array($_SERVER[<span class="stringliteral">"REMOTE_ADDR"</span>], $this-&gt;var-&gt;ipblok) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     $verze = $this-&gt;<a class="code" href="classFunkce.html#33736de14d87634f70807da08e41b5fe">KontrolaVerze</a>();
<a name="l00324"></a>00324     <span class="keywordflow">if</span> ($verze &lt; 5) <span class="comment">//kontrola verze, kvuli php5</span>
<a name="l00325"></a>00325     {
<a name="l00326"></a>00326       $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_old_php_version"</span>], $verze), array(__LINE__, __METHOD__), NULL, <span class="keyword">true</span>);
<a name="l00327"></a>00327       exit(1);
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="comment">//$this-&gt;Instalace();</span>
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     $this-&gt;<a class="code" href="classFunkce.html#69911132bb6199619c01dfd49855aa71">Prihlasovani</a>();
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     $this-&gt;<a class="code" href="classFunkce.html#a1aa6b1dca86c8925458c1ac99533ad3">AutoZalohovani</a>();
<a name="l00335"></a>00335     $this-&gt;<a class="code" href="classFunkce.html#b7e5f3ce7da51dbbd4dfad696f5878f1">GenerovaniErrorPage</a>();
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     $this-&gt;<a class="code" href="classDefaultModule.html#de138416b3a548d72b50432499895bb7">NastavitAdresuMenu</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu"</span>],
<a name="l00338"></a>00338                                                         $this-&gt;idmodul,
<a name="l00339"></a>00339                                                         <span class="stringliteral">"{$this-&gt;idmodul}{$this-&gt;idzaloha}"</span>,
<a name="l00340"></a>00340                                                         <span class="stringliteral">"{$this-&gt;idmodul}{$this-&gt;iddelzal}"</span>,
<a name="l00341"></a>00341                                                         <span class="stringliteral">"{$this-&gt;idmodul}{$this-&gt;idupp}"</span>));
<a name="l00342"></a>00342   }
<a name="l00343"></a>00343 
<a name="l00351"></a><a class="code" href="classFunkce.html#3b836eac67d3026f33c5edd181e145ed">00351</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#3b836eac67d3026f33c5edd181e145ed">CallAdminTitle</a>($admin_menu)
<a name="l00352"></a>00352   {
<a name="l00353"></a>00353     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu)
<a name="l00356"></a>00356     {
<a name="l00357"></a>00357       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($admin_menu); $i++)  <span class="comment">//prochazeni adres</span>
<a name="l00358"></a>00358       {
<a name="l00359"></a>00359         <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu &amp;&amp;
<a name="l00360"></a>00360             $_GET[$this-&gt;var-&gt;get_idmodul] == $admin_menu[$i][<span class="stringliteral">"main_href"</span>])
<a name="l00361"></a>00361         {
<a name="l00362"></a>00362           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $admin_menu[$i][<span class="stringliteral">"title"</span>]; <span class="comment">//navrat nalezeneho title</span>
<a name="l00363"></a>00363           <span class="keywordflow">break</span>;
<a name="l00364"></a>00364         }
<a name="l00365"></a>00365       }
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00369"></a>00369   }
<a name="l00370"></a>00370 
<a name="l00378"></a><a class="code" href="classFunkce.html#863b9019d6facd33a68f7e7ea7dadfaa">00378</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#863b9019d6facd33a68f7e7ea7dadfaa">CallAdminMenu</a>($admin_menu)
<a name="l00379"></a>00379   {
<a name="l00380"></a>00380     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu)
<a name="l00383"></a>00383     {
<a name="l00384"></a>00384       <span class="keyword">static</span> $pocit = 0;  <span class="comment">//pocitadlo volani funkce</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($admin_menu); $i++)  <span class="comment">//prochazeni adres</span>
<a name="l00387"></a>00387       {
<a name="l00388"></a>00388         $pocit++; <span class="comment">//pocita volani</span>
<a name="l00389"></a>00389         $podminka = ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu &amp;&amp; $_GET[$this-&gt;var-&gt;get_idmodul] == $admin_menu[$i][<span class="stringliteral">"main_href"</span>]);
<a name="l00390"></a>00390 
<a name="l00391"></a>00391         <span class="keywordflow">switch</span> ($this-&gt;var-&gt;admin_ozn_menu)
<a name="l00392"></a>00392         {
<a name="l00393"></a>00393           <span class="keywordflow">case</span> <span class="stringliteral">"odkaz"</span>:
<a name="l00394"></a>00394             $ozn = explode(<span class="stringliteral">"|--|"</span>, $this-&gt;var-&gt;select_admin_oznac[<span class="stringliteral">"odkaz"</span>]);  <span class="comment">//rozdeleni oznacovace textu</span>
<a name="l00395"></a>00395             $ozn_odkaz_l = ($podminka ? $ozn[0] : <span class="stringliteral">""</span>);
<a name="l00396"></a>00396             $ozn_odkaz_r = ($podminka ? $ozn[1] : <span class="stringliteral">""</span>);
<a name="l00397"></a>00397           <span class="keywordflow">break</span>;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399           <span class="keywordflow">case</span> <span class="stringliteral">"class"</span>:
<a name="l00400"></a>00400             $ozn = $this-&gt;var-&gt;select_admin_oznac[<span class="stringliteral">"class"</span>];
<a name="l00401"></a>00401             $ozn_class = ($podminka ? $ozn : <span class="stringliteral">""</span>);
<a name="l00402"></a>00402           <span class="keywordflow">break</span>;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404           <span class="keywordflow">case</span> <span class="stringliteral">"id"</span>:
<a name="l00405"></a>00405             $ozn = $this-&gt;var-&gt;select_admin_oznac[<span class="stringliteral">"id"</span>];
<a name="l00406"></a>00406             $ozn_id = ($podminka ? $ozn : <span class="stringliteral">""</span>);
<a name="l00407"></a>00407           <span class="keywordflow">break</span>;
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="comment">/*</span>
<a name="l00411"></a>00411 <span class="comment">        //eventualni podminky pro oznaceni zacatku, konce a kazdeno eN-teho</span>
<a name="l00412"></a>00412 <span class="comment">        $prvni = (($pocit - 1) == 0 ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni["admin_menu_prvni"]) : ""); //prvni</span>
<a name="l00413"></a>00413 <span class="comment">        $posledni = ($pocit == (count($this-&gt;var-&gt;moduly) + count($admin_menu)) ?</span>
<a name="l00414"></a>00414 <span class="comment">                    $this-&gt;NactiUnikatniObsah($this-&gt;unikatni["admin_menu_posledni"]) :</span>
<a name="l00415"></a>00415 <span class="comment">                    ""); //posledni</span>
<a name="l00416"></a>00416 <span class="comment"></span>
<a name="l00417"></a>00417 <span class="comment">        $ente = ($this-&gt;var-&gt;ente_definovane ?</span>
<a name="l00418"></a>00418 <span class="comment">                in_array(($pocit - 1), $this-&gt;var-&gt;ente_ozn_def) :</span>
<a name="l00419"></a>00419 <span class="comment">                (((($pocit - 1) + $this-&gt;var-&gt;ente_ozn_od) % $this-&gt;var-&gt;ente_ozn_po) == 0));  //kazde N od M nebo definovane</span>
<a name="l00420"></a>00420 <span class="comment">        $ente = ($ente ? $this-&gt;NactiUnikatniObsah($this-&gt;unikatni["admin_menu_ente"]) : "");</span>
<a name="l00421"></a>00421 <span class="comment">  */</span>
<a name="l00422"></a>00422 
<a name="l00423"></a>00423         $prvni = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_prvni"</span>]);
<a name="l00424"></a>00424         $posledni = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_posledni"</span>]);
<a name="l00425"></a>00425         $ente_def_array = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_ente_def_array"</span>]);
<a name="l00426"></a>00426         $ente_def = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_ente_def"</span>]);
<a name="l00427"></a>00427         $ente_od = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_ente_od"</span>]);
<a name="l00428"></a>00428         $ente_po = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_ente_po"</span>]);
<a name="l00429"></a>00429         $ente = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu_ente"</span>]);
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         $main_href = (!Empty($admin_menu[$i][<span class="stringliteral">"main_href"</span>]) ? <span class="stringliteral">"&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$admin_menu[$i]["</span>main_href<span class="stringliteral">"]}"</span> : <span class="stringliteral">""</span>);
<a name="l00432"></a>00432         $class = (!Empty($admin_menu[$i][<span class="stringliteral">"class"</span>]) || !Empty($ozn_class) ? <span class="stringliteral">" class=\"{$admin_menu[$i]["</span><span class="keyword">class</span><span class="stringliteral">"]}{$ozn_class}\""</span> : <span class="stringliteral">""</span>);
<a name="l00433"></a>00433         $id = (!Empty($admin_menu[$i][<span class="stringliteral">"id"</span>]) || !Empty($ozn_id) ? <span class="stringliteral">" id=\"{$admin_menu[$i]["</span><span class="keywordtype">id</span><span class="stringliteral">"]}{$ozn_id}\""</span> : <span class="stringliteral">""</span>);
<a name="l00434"></a>00434         $akce = (!Empty($admin_menu[$i][<span class="stringliteral">"akce"</span>]) ? <span class="stringliteral">" {$admin_menu[$i]["</span>akce<span class="stringliteral">"]}"</span> : <span class="stringliteral">""</span>);
<a name="l00435"></a>00435 
<a name="l00436"></a>00436         <span class="comment">//externi odvolani do souborum</span>
<a name="l00437"></a>00437         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= ($admin_menu[$i][<span class="stringliteral">"zobrazit"</span>] ? $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"tvar_admin_menu"</span>], <span class="comment">// + menu_tvar_logoff</span>
<a name="l00438"></a>00438                                                                             <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}{$main_href}"</span>,
<a name="l00439"></a>00439                                                                             $admin_menu[$i][<span class="stringliteral">"odkaz"</span>],
<a name="l00440"></a>00440                                                                             $id,
<a name="l00441"></a>00441                                                                             $class,
<a name="l00442"></a>00442                                                                             $akce,
<a name="l00443"></a>00443                                                                             $ozn_odkaz_l,
<a name="l00444"></a>00444                                                                             $ozn_odkaz_r,
<a name="l00445"></a>00445                                                                             (($pocit - 1) == 0 ? $prvni : <span class="stringliteral">""</span>),
<a name="l00446"></a>00446                                                                             ($pocit == (count($this-&gt;var-&gt;moduly) + count($admin_menu)) ? $posledni : <span class="stringliteral">""</span>),
<a name="l00447"></a>00447                                                                             (in_array(($pocit - 1), $ente_def_array) ? $ente_def : <span class="stringliteral">""</span>),
<a name="l00448"></a>00448                                                                             (((($pocit - 1) + $ente_od) % $ente_po) == 0 ? $ente : <span class="stringliteral">""</span>))
<a name="l00449"></a>00449                                                 : ($this-&gt;var-&gt;debug_mod ? <span class="stringliteral">"skryté: {$admin_menu[$i]["</span>odkaz<span class="stringliteral">"]}&lt;br /&gt;"</span> : <span class="stringliteral">""</span>));
<a name="l00450"></a>00450       }
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00454"></a>00454   }
<a name="l00455"></a>00455 
<a name="l00462"></a><a class="code" href="classFunkce.html#04bf6beb45c5d75e40bf957d76958245">00462</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#04bf6beb45c5d75e40bf957d76958245">AdminObsah</a>()
<a name="l00463"></a>00463   {
<a name="l00464"></a>00464     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu &amp;&amp;
<a name="l00465"></a>00465         $this-&gt;var-&gt;aktivniadmin)
<a name="l00466"></a>00466     {
<a name="l00467"></a>00467       <span class="keywordflow">switch</span> ($_GET[$this-&gt;var-&gt;get_idmodul])
<a name="l00468"></a>00468       {
<a name="l00469"></a>00469         <span class="keywordflow">case</span> <span class="stringliteral">""</span>:  <span class="comment">//uvod adminu</span>
<a name="l00470"></a>00470           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"uvod_admin_text"</span>],
<a name="l00471"></a>00471                                               $this-&gt;var-&gt;nazevwebu,
<a name="l00472"></a>00472                                               $this-&gt;SouhrnnenIformaceWebu(),
<a name="l00473"></a>00473                                               $this-&gt;<a class="code" href="classFunkce.html#119ba054ba2aa0e03c28b1319ddbc33e">VypisZalohyDB</a>());
<a name="l00474"></a>00474         <span class="keywordflow">break</span>;
<a name="l00475"></a>00475 
<a name="l00476"></a>00476         <span class="keywordflow">case</span> $this-&gt;idmodul:  <span class="comment">//id modul</span>
<a name="l00477"></a>00477           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classFunkce.html#a11a8a16b533edf4bc5bc404e88a51f0">KontrolaAktualizace</a>();
<a name="l00478"></a>00478         <span class="keywordflow">break</span>;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480         <span class="keywordflow">case</span> <span class="stringliteral">"{$this-&gt;idmodul}{$this-&gt;idzaloha}"</span>: <span class="comment">//zaloha</span>
<a name="l00481"></a>00481           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classFunkce.html#e2222af28360a6961e5983e38b91811c">ZalohovaniSQLiteDB</a>();
<a name="l00482"></a>00482         <span class="keywordflow">break</span>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484         <span class="keywordflow">case</span> <span class="stringliteral">"{$this-&gt;idmodul}{$this-&gt;iddelzal}"</span>: <span class="comment">//smazani souboru zalohy</span>
<a name="l00485"></a>00485           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classFunkce.html#03b7ee28259a688c366e6f06f9ac4a50">SmazatSouborZalohy</a>();
<a name="l00486"></a>00486         <span class="keywordflow">break</span>;
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         <span class="keywordflow">case</span> <span class="stringliteral">"{$this-&gt;idmodul}{$this-&gt;idupp}"</span>:  <span class="comment">//uploadovani verzi</span>
<a name="l00489"></a>00489           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classFunkce.html#7b79cdf110960b83299befbc56b79f93">UploadovatNovouVerzi</a>();
<a name="l00490"></a>00490         <span class="keywordflow">break</span>;
<a name="l00491"></a>00491       }
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00495"></a>00495   }
<a name="l00496"></a>00496 
<a name="l00503"></a><a class="code" href="classFunkce.html#7a8dc61935e9cfe365cec9cb83990061">00503</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#7a8dc61935e9cfe365cec9cb83990061">SouhrnnenIformaceWebu</a>()
<a name="l00504"></a>00504   {
<a name="l00505"></a>00505     $moduly = $this-&gt;var-&gt;moduly;
<a name="l00506"></a>00506     $sum = $dbpoc = 0;
<a name="l00507"></a>00507     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($moduly); $i++)
<a name="l00508"></a>00508     {
<a name="l00509"></a>00509       <span class="keywordflow">if</span> (!Empty($moduly[$i][<span class="stringliteral">"databaze"</span>]))
<a name="l00510"></a>00510       {
<a name="l00511"></a>00511         $path = dirname($moduly[$i][<span class="stringliteral">"include"</span>]);
<a name="l00512"></a>00512         $sum += filesize(<span class="stringliteral">"{$path}/{$moduly[$i]["</span>databaze<span class="stringliteral">"]}"</span>);
<a name="l00513"></a>00513         $dbpoc++;
<a name="l00514"></a>00514       }
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     $poc = count($moduly) + 2; <span class="comment">//+ promenne + default module</span>
<a name="l00518"></a>00518 
<a name="l00519"></a>00519     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"info_admin_uvod_text"</span>],
<a name="l00520"></a>00520                                         $poc,
<a name="l00521"></a>00521                                         $dbpoc,
<a name="l00522"></a>00522                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>(<span class="stringliteral">"modules"</span>, <span class="keyword">true</span>)),
<a name="l00523"></a>00523                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($sum),
<a name="l00524"></a>00524                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>($this-&gt;var-&gt;zalohadir)),
<a name="l00525"></a>00525                                         $this-&gt;Velikost($this-&gt;VelikostAdresare(<span class="stringliteral">"./"</span>, <span class="keyword">true</span>)),
<a name="l00526"></a>00526                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>(<span class="stringliteral">"styles"</span>, <span class="keyword">true</span>)),
<a name="l00527"></a>00527                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>(<span class="stringliteral">"script"</span>, <span class="keyword">true</span>)),
<a name="l00528"></a>00528                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>(<span class="stringliteral">"obr"</span>, <span class="keyword">true</span>)),
<a name="l00529"></a>00529                                         $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>($this-&gt;var-&gt;souborymenu, <span class="keyword">true</span>)));
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00532"></a>00532   }
<a name="l00533"></a>00533 
<a name="l00542"></a><a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">00542</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>($cesta, $rekurzivne = <span class="keyword">false</span>)
<a name="l00543"></a>00543   {
<a name="l00544"></a>00544     $handle = opendir($cesta);
<a name="l00545"></a>00545     $sum = 0;
<a name="l00546"></a>00546     <span class="keywordflow">while</span>($soub = readdir($handle))
<a name="l00547"></a>00547     {
<a name="l00548"></a>00548       <span class="keywordflow">if</span> ($soub != <span class="stringliteral">"."</span> &amp;&amp; $soub != <span class="stringliteral">".."</span>)
<a name="l00549"></a>00549       {
<a name="l00550"></a>00550         <span class="keywordflow">switch</span> (filetype(<span class="stringliteral">"{$cesta}/{$soub}"</span>))
<a name="l00551"></a>00551         {
<a name="l00552"></a>00552           <span class="keywordflow">case</span> <span class="stringliteral">"dir"</span>:
<a name="l00553"></a>00553             $sum += ($rekurzivne ? $this-&gt;<a class="code" href="classFunkce.html#36252494233908b4f52f545f44c27e6d">VelikostAdresare</a>(<span class="stringliteral">"{$cesta}/{$soub}"</span>, $rekurzivne) : 0);
<a name="l00554"></a>00554           <span class="keywordflow">break</span>;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556           <span class="keywordflow">case</span> <span class="stringliteral">"file"</span>:
<a name="l00557"></a>00557             $sum += filesize(<span class="stringliteral">"{$cesta}/{$soub}"</span>);
<a name="l00558"></a>00558           <span class="keywordflow">break</span>;
<a name="l00559"></a>00559         }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       }
<a name="l00562"></a>00562     }
<a name="l00563"></a>00563     closedir($handle);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="keywordflow">return</span> $sum;
<a name="l00566"></a>00566   }
<a name="l00567"></a>00567 
<a name="l00574"></a><a class="code" href="classFunkce.html#a11a8a16b533edf4bc5bc404e88a51f0">00574</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#a11a8a16b533edf4bc5bc404e88a51f0">KontrolaAktualizace</a>()
<a name="l00575"></a>00575   {
<a name="l00576"></a>00576     <span class="keywordflow">if</span> ($this-&gt;var-&gt;aktualizovat)
<a name="l00577"></a>00577     {
<a name="l00578"></a>00578       $moduly = $this-&gt;var-&gt;moduly;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580       $moduly[count($moduly)] = array(<span class="stringliteral">"include"</span> =&gt; <span class="stringliteral">"promenne.php"</span>,
<a name="l00581"></a>00581                                       <span class="stringliteral">"class"</span> =&gt; <span class="stringliteral">"Promenne"</span>,
<a name="l00582"></a>00582                                       <span class="stringliteral">"admin"</span> =&gt; <span class="keyword">false</span>,
<a name="l00583"></a>00583                                       <span class="stringliteral">"databaze"</span> =&gt; <span class="stringliteral">""</span>);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585       $moduly[count($moduly)] = array(<span class="stringliteral">"include"</span> =&gt; <span class="stringliteral">"default_modul.php"</span>,
<a name="l00586"></a>00586                                       <span class="stringliteral">"class"</span> =&gt; <span class="stringliteral">"DefaultModule"</span>,
<a name="l00587"></a>00587                                       <span class="stringliteral">"admin"</span> =&gt; <span class="keyword">false</span>,
<a name="l00588"></a>00588                                       <span class="stringliteral">"databaze"</span> =&gt; <span class="stringliteral">""</span>);
<a name="l00589"></a>00589 
<a name="l00590"></a>00590       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_datum"</span>], date($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_tvar_datum"</span>])));
<a name="l00591"></a>00591 
<a name="l00592"></a>00592       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($moduly); $i++)
<a name="l00593"></a>00593       {
<a name="l00594"></a>00594         $nazev = $moduly[$i][<span class="stringliteral">"class"</span>];
<a name="l00595"></a>00595         $cesta = $moduly[$i][<span class="stringliteral">"include"</span>];
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         $soubor = basename($cesta); <span class="comment">//soubor</span>
<a name="l00598"></a>00598         $adresar = dirname($cesta); <span class="comment">//adresar</span>
<a name="l00599"></a>00599         $adresar = explode(<span class="stringliteral">"/"</span>, $adresar);
<a name="l00600"></a>00600         $adresar = (count($adresar) &gt; 1 ? $adresar[1] : $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_root"</span>]));
<a name="l00601"></a>00601 
<a name="l00602"></a>00602         $info0 = <span class="stringliteral">""</span>;
<a name="l00603"></a>00603         <span class="keywordflow">if</span> (file_exists($cesta))
<a name="l00604"></a>00604         {
<a name="l00605"></a>00605           $velikost = filesize($cesta);  <span class="comment">//$this-&gt;Velikost()</span>
<a name="l00606"></a>00606           $datum = filemtime($cesta); <span class="comment">//datum na aktualnim webu, date("d.m.Y H:i:s", )</span>
<a name="l00607"></a>00607         }
<a name="l00608"></a>00608           <span class="keywordflow">else</span>
<a name="l00609"></a>00609         {
<a name="l00610"></a>00610           $info0 = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_notexists"</span>]);
<a name="l00611"></a>00611         }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613         $zprava = $this-&gt;<a class="code" href="classFunkce.html#3c9e77b4971fd8b6ad361518f1466a3b">NactiUrl</a>(<span class="stringliteral">"{$this-&gt;var-&gt;depozitar}?{$this-&gt;get_check}={$cesta}"</span>);  <span class="comment">//datum na depozitu s velikosti</span>
<a name="l00614"></a>00614         $zprava_velikost = explode(<span class="stringliteral">"-_-"</span>, $zprava); <span class="comment">//rozdeleni na datum a velikost</span>
<a name="l00615"></a>00615 
<a name="l00616"></a>00616         $zprava_datum = $zprava_velikost[0];  <span class="comment">//vraceni datumu zpravy</span>
<a name="l00617"></a>00617         $zprava_velikost = $zprava_velikost[1]; <span class="comment">//vraceni velikosti</span>
<a name="l00618"></a>00618 <span class="comment">//var_dump("tu: {$datum}, depozit: {$zprava_datum}, rovna se: ".($datum == $zprava_datum)."&lt;br /&gt;");</span>
<a name="l00619"></a>00619         <span class="keywordflow">if</span> (!Empty($zprava_velikost))
<a name="l00620"></a>00620         {
<a name="l00621"></a>00621           <span class="keywordflow">if</span> ($datum == $zprava_datum)  <span class="comment">//stejne datumy</span>
<a name="l00622"></a>00622           {
<a name="l00623"></a>00623             <span class="keywordflow">if</span> ($velikost == $zprava_velikost)
<a name="l00624"></a>00624             {
<a name="l00625"></a>00625               $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_aktualni_hlaska"</span>]);
<a name="l00626"></a>00626             }
<a name="l00627"></a>00627               <span class="keywordflow">else</span>
<a name="l00628"></a>00628             {
<a name="l00629"></a>00629               $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_aktualni_datum_hlaska"</span>],
<a name="l00630"></a>00630                                                 <span class="stringliteral">"{$this-&gt;var-&gt;depozitar}?{$this-&gt;get_download}={$cesta}&amp;amp;{$this-&gt;get_zdrojstazeni}={$_SERVER["</span>SERVER_NAME<span class="stringliteral">"]}"</span>,
<a name="l00631"></a>00631                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}{$this-&gt;idupp}&amp;amp;file={$cesta}"</span>);
<a name="l00632"></a>00632             }
<a name="l00633"></a>00633           }
<a name="l00634"></a>00634             <span class="keywordflow">else</span>
<a name="l00635"></a>00635           {
<a name="l00636"></a>00636             <span class="keywordflow">if</span> ($datum &gt; $zprava_datum) <span class="comment">//nove na tomto webu</span>
<a name="l00637"></a>00637             {
<a name="l00638"></a>00638               <span class="keywordflow">if</span> ($velikost == $zprava_velikost)
<a name="l00639"></a>00639               {
<a name="l00640"></a>00640                 $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_aktualni_novejsi_hlaska"</span>]);
<a name="l00641"></a>00641               }
<a name="l00642"></a>00642                 <span class="keywordflow">else</span>
<a name="l00643"></a>00643               {
<a name="l00644"></a>00644                 $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_novejsi_hlaska"</span>]);
<a name="l00645"></a>00645               }
<a name="l00646"></a>00646             }
<a name="l00647"></a>00647               <span class="keywordflow">else</span>
<a name="l00648"></a>00648             {
<a name="l00649"></a>00649               <span class="keywordflow">if</span> ($velikost == $zprava_velikost)
<a name="l00650"></a>00650               {
<a name="l00651"></a>00651                 $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_aktualni_depozit_hlaska"</span>]);
<a name="l00652"></a>00652               }
<a name="l00653"></a>00653                 <span class="keywordflow">else</span>
<a name="l00654"></a>00654               {
<a name="l00655"></a>00655                 $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_novejsi_depozit_hlaska"</span>],
<a name="l00656"></a>00656                                                   <span class="stringliteral">"{$this-&gt;var-&gt;depozitar}?{$this-&gt;get_download}={$cesta}&amp;amp;{$this-&gt;get_zdrojstazeni}={$_SERVER["</span>SERVER_NAME<span class="stringliteral">"]}"</span>,
<a name="l00657"></a>00657                                                   <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}{$this-&gt;idupp}&amp;amp;file={$cesta}"</span>);
<a name="l00658"></a>00658               }
<a name="l00659"></a>00659             }
<a name="l00660"></a>00660           }
<a name="l00661"></a>00661         }
<a name="l00662"></a>00662           <span class="keywordflow">else</span>
<a name="l00663"></a>00663         {
<a name="l00664"></a>00664           $info = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_null_soubor"</span>]);
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667         settype($datum, <span class="stringliteral">"integer"</span>); <span class="comment">//konvert na cislo</span>
<a name="l00668"></a>00668         <span class="keywordflow">if</span> (!Empty($datum))
<a name="l00669"></a>00669         {
<a name="l00670"></a>00670           $fun_dat = date($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_tvar_datum"</span>]), $datum);
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672 
<a name="l00673"></a>00673         settype($zprava_datum, <span class="stringliteral">"integer"</span>); <span class="comment">//konvert na cislo</span>
<a name="l00674"></a>00674         <span class="keywordflow">if</span> (!Empty($zprava_datum))
<a name="l00675"></a>00675         {
<a name="l00676"></a>00676 
<a name="l00677"></a>00677           $dep_dat = date($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_tvar_datum"</span>]), $zprava_datum);
<a name="l00678"></a>00678         }
<a name="l00679"></a>00679 
<a name="l00680"></a>00680         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"aktualizace_admin_vypis"</span>],
<a name="l00681"></a>00681                                             $nazev,
<a name="l00682"></a>00682                                             $adresar,
<a name="l00683"></a>00683                                             $soubor,
<a name="l00684"></a>00684                                             $fun_dat,
<a name="l00685"></a>00685                                             $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($velikost),
<a name="l00686"></a>00686                                             $dep_dat,
<a name="l00687"></a>00687                                             (!Empty($zprava_velikost) ? $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($zprava_velikost) : <span class="stringliteral">""</span>),
<a name="l00688"></a>00688                                             (!Empty($info0) ? $info0 : $info));
<a name="l00689"></a>00689       }
<a name="l00690"></a>00690     }
<a name="l00691"></a>00691       <span class="keywordflow">else</span>
<a name="l00692"></a>00692     {
<a name="l00693"></a>00693       $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update"</span>]), array(__LINE__, __METHOD__));
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00697"></a>00697   }
<a name="l00698"></a>00698 
<a name="l00705"></a><a class="code" href="classFunkce.html#7b79cdf110960b83299befbc56b79f93">00705</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#7b79cdf110960b83299befbc56b79f93">UploadovatNovouVerzi</a>()
<a name="l00706"></a>00706   {
<a name="l00707"></a>00707     $soubor = $_GET[<span class="stringliteral">"file"</span>];
<a name="l00708"></a>00708     <span class="keywordflow">if</span> (file_exists($soubor))
<a name="l00709"></a>00709     {
<a name="l00710"></a>00710       @chmod($soubor, 0777);
<a name="l00711"></a>00711       @chmod(dirname($soubor), 0777);
<a name="l00712"></a>00712 
<a name="l00713"></a>00713       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"upload_admin_form"</span>], $soubor);
<a name="l00714"></a>00714 
<a name="l00715"></a>00715       $koncovka = explode(<span class="stringliteral">"."</span>, $_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"name"</span>]);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717       <span class="keywordflow">if</span> (!Empty($_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"tmp_name"</span>]) &amp;&amp;
<a name="l00718"></a>00718           !Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l00719"></a>00719           !Empty($soubor) &amp;&amp;
<a name="l00720"></a>00720           $_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"name"</span>] == basename($soubor) &amp;&amp;
<a name="l00721"></a>00721           $koncovka[count($koncovka) - 1] == <span class="stringliteral">"php"</span> &amp;&amp;
<a name="l00722"></a>00722           file_exists($soubor) &amp;&amp;
<a name="l00723"></a>00723           $soubor != <span class="stringliteral">"promenne.php"</span> &amp;&amp;
<a name="l00724"></a>00724           $soubor != <span class="stringliteral">"index.php"</span> &amp;&amp;
<a name="l00725"></a>00725           $soubor != <span class="stringliteral">".htaccess"</span>)
<a name="l00726"></a>00726       {
<a name="l00727"></a>00727         <span class="keywordflow">if</span> (move_uploaded_file($_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"tmp_name"</span>], $soubor))
<a name="l00728"></a>00728         {
<a name="l00729"></a>00729           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"upload_admin_finish"</span>], $soubor);
<a name="l00730"></a>00730           chmod($soubor, 0777);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732           $this-&gt;var-&gt;main[0]-&gt;AutoClick(2, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734           <span class="keywordflow">else</span>
<a name="l00735"></a>00735         {
<a name="l00736"></a>00736           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update_upload_error"</span>], $_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"error"</span>]), array(__LINE__, __METHOD__));
<a name="l00737"></a>00737         }
<a name="l00738"></a>00738       }
<a name="l00739"></a>00739         <span class="keywordflow">else</span>
<a name="l00740"></a>00740       {
<a name="l00741"></a>00741         <span class="keywordflow">if</span> (!Empty($_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"tmp_name"</span>]))
<a name="l00742"></a>00742         {
<a name="l00743"></a>00743           <span class="keywordflow">if</span> ($koncovka[count($koncovka) - 1] == <span class="stringliteral">"php"</span>)
<a name="l00744"></a>00744           {
<a name="l00745"></a>00745             $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update_suffix"</span>]), array(__LINE__, __METHOD__));
<a name="l00746"></a>00746           }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748           <span class="keywordflow">if</span> (file_exists($soubor))
<a name="l00749"></a>00749           {
<a name="l00750"></a>00750             $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update_file_not_exist"</span>]), array(__LINE__, __METHOD__));
<a name="l00751"></a>00751           }
<a name="l00752"></a>00752 
<a name="l00753"></a>00753           <span class="keywordflow">if</span> ($soubor != <span class="stringliteral">"promenne.php"</span> &amp;&amp;
<a name="l00754"></a>00754               $soubor != <span class="stringliteral">".htaccess"</span>)
<a name="l00755"></a>00755           {
<a name="l00756"></a>00756             $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update_hack"</span>]), array(__LINE__, __METHOD__));
<a name="l00757"></a>00757           }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759           <span class="keywordflow">if</span> ($_FILES[<span class="stringliteral">"modul"</span>][<span class="stringliteral">"name"</span>] == basename($soubor))
<a name="l00760"></a>00760           {
<a name="l00761"></a>00761             $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update_another_file"</span>]), array(__LINE__, __METHOD__));
<a name="l00762"></a>00762           }
<a name="l00763"></a>00763         }
<a name="l00764"></a>00764       }
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766       <span class="keywordflow">else</span>
<a name="l00767"></a>00767     {
<a name="l00768"></a>00768       $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_update_empty_file"</span>]), array(__LINE__, __METHOD__));
<a name="l00769"></a>00769     }
<a name="l00770"></a>00770 
<a name="l00771"></a>00771     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00772"></a>00772   }
<a name="l00773"></a>00773 
<a name="l00780"></a><a class="code" href="classFunkce.html#4e54a5a3e08ef6cf1712e65c321ed52d">00780</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#4e54a5a3e08ef6cf1712e65c321ed52d">GenerovaniAdminTitle</a>()
<a name="l00781"></a>00781   {
<a name="l00782"></a>00782     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00783"></a>00783     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00784"></a>00784     {
<a name="l00785"></a>00785       <span class="keywordflow">if</span> ($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"admin"</span>])
<a name="l00786"></a>00786       {
<a name="l00787"></a>00787         <span class="keywordflow">if</span> (method_exists($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>], <span class="stringliteral">"AdminTitle"</span>))
<a name="l00788"></a>00788         {
<a name="l00789"></a>00789           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;var-&gt;main[$i]-&gt;AdminTitle();
<a name="l00790"></a>00790         }
<a name="l00791"></a>00791           <span class="keywordflow">else</span>
<a name="l00792"></a>00792         {
<a name="l00793"></a>00793           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_gen_title"</span>], $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]), array(__LINE__, __METHOD__));
<a name="l00794"></a>00794         }
<a name="l00795"></a>00795       }
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00799"></a>00799   }
<a name="l00800"></a>00800 
<a name="l00807"></a><a class="code" href="classFunkce.html#e4b630a2127cedcdf5e6365502267b94">00807</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#e4b630a2127cedcdf5e6365502267b94">GenerovaniAdminMenu</a>()
<a name="l00808"></a>00808   {
<a name="l00809"></a>00809     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00810"></a>00810     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00811"></a>00811     {
<a name="l00812"></a>00812       <span class="keywordflow">if</span> ($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"admin"</span>] &amp;&amp; $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"zobrazit"</span>])
<a name="l00813"></a>00813       {
<a name="l00814"></a>00814         <span class="keywordflow">if</span> (method_exists($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>], <span class="stringliteral">"AdminMenu"</span>))
<a name="l00815"></a>00815         {
<a name="l00816"></a>00816           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;var-&gt;main[$i]-&gt;AdminMenu();
<a name="l00817"></a>00817         }
<a name="l00818"></a>00818           <span class="keywordflow">else</span>
<a name="l00819"></a>00819         {
<a name="l00820"></a>00820           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_gen_menu"</span>], $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]), array(__LINE__, __METHOD__));
<a name="l00821"></a>00821         }
<a name="l00822"></a>00822       }
<a name="l00823"></a>00823     }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825     <span class="comment">//nacteni zbytku menu</span>
<a name="l00826"></a>00826     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"tvar_admin_logoff"</span>],
<a name="l00827"></a>00827                                         $this-&gt;var-&gt;get_kam);  <span class="comment">//nacteni odkazu log off + menu_tvar_admin</span>
<a name="l00828"></a>00828 
<a name="l00829"></a>00829     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00830"></a>00830   }
<a name="l00831"></a>00831 
<a name="l00838"></a><a class="code" href="classFunkce.html#5e6f0bfef1995a9753e12a1e848d5847">00838</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#5e6f0bfef1995a9753e12a1e848d5847">GenerovaniAdminObsah</a>()
<a name="l00839"></a>00839   {
<a name="l00840"></a>00840     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00841"></a>00841     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00842"></a>00842     {
<a name="l00843"></a>00843       <span class="keywordflow">if</span> ($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"admin"</span>])
<a name="l00844"></a>00844       {
<a name="l00845"></a>00845         <span class="keywordflow">if</span> (method_exists($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>], <span class="stringliteral">"AdminObsah"</span>))
<a name="l00846"></a>00846         {
<a name="l00847"></a>00847           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;var-&gt;main[$i]-&gt;AdminObsah();
<a name="l00848"></a>00848         }
<a name="l00849"></a>00849           <span class="keywordflow">else</span>
<a name="l00850"></a>00850         {
<a name="l00851"></a>00851           $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_gen_obsah"</span>], $this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"class"</span>]), array(__LINE__, __METHOD__));
<a name="l00852"></a>00852         }
<a name="l00853"></a>00853       }
<a name="l00854"></a>00854     }
<a name="l00855"></a>00855 
<a name="l00856"></a>00856     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00857"></a>00857   }
<a name="l00858"></a>00858 
<a name="l00865"></a><a class="code" href="classFunkce.html#e2222af28360a6961e5983e38b91811c">00865</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#e2222af28360a6961e5983e38b91811c">ZalohovaniSQLiteDB</a>($autodown = <span class="keyword">true</span>)
<a name="l00866"></a>00866   {
<a name="l00867"></a>00867     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00868"></a>00868     <span class="keywordflow">if</span> (!file_exists($this-&gt;var-&gt;zalohadir))
<a name="l00869"></a>00869     {
<a name="l00870"></a>00870       mkdir($this-&gt;var-&gt;zalohadir, 0777);
<a name="l00871"></a>00871     }
<a name="l00872"></a>00872 
<a name="l00873"></a>00873     $cil = <span class="stringliteral">"{$this-&gt;var-&gt;zalohadir}/zaloha_db_"</span>.date(<span class="stringliteral">"d-m-Y_H-i-s"</span>).<span class="stringliteral">".zip"</span>;
<a name="l00874"></a>00874 
<a name="l00875"></a>00875     $zip = <span class="keyword">new</span> ZipArchive();
<a name="l00876"></a>00876     <span class="keywordflow">if</span> ($zip-&gt;open($cil, ZipArchive::CREATE) === <span class="keyword">true</span>)
<a name="l00877"></a>00877     {
<a name="l00878"></a>00878       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($this-&gt;var-&gt;moduly); $i++)
<a name="l00879"></a>00879       {
<a name="l00880"></a>00880         <span class="keywordflow">if</span> ($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"admin"</span>])  <span class="comment">//pokud ma modul dazaba</span>
<a name="l00881"></a>00881         {
<a name="l00882"></a>00882           $databaze = dirname($this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"include"</span>]).<span class="stringliteral">"/"</span>.$this-&gt;var-&gt;moduly[$i][<span class="stringliteral">"databaze"</span>];
<a name="l00883"></a>00883           <span class="keywordflow">if</span> (file_exists($databaze))
<a name="l00884"></a>00884           {
<a name="l00885"></a>00885             $zip-&gt;addFile($databaze);  <span class="comment">//ulozi i se stejnou cestou!!</span>
<a name="l00886"></a>00886           }
<a name="l00887"></a>00887         }
<a name="l00888"></a>00888       }
<a name="l00889"></a>00889       $zip-&gt;close();
<a name="l00890"></a>00890     }
<a name="l00891"></a>00891 
<a name="l00892"></a>00892     <span class="keywordflow">if</span> ($autodown)
<a name="l00893"></a>00893     {
<a name="l00894"></a>00894       header(<span class="stringliteral">"Content-Description: File Transfer"</span>);
<a name="l00895"></a>00895       header(<span class="stringliteral">"Content-Type: application/force-download"</span>);
<a name="l00896"></a>00896       header(<span class="stringliteral">"Content-Disposition: attachment; filename=\"{$cil}\""</span>);
<a name="l00897"></a>00897       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = readfile($cil); <span class="comment">//vybydne ke stazeni</span>
<a name="l00898"></a>00898     }
<a name="l00899"></a>00899 
<a name="l00900"></a>00900     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00901"></a>00901   }
<a name="l00902"></a>00902 
<a name="l00908"></a><a class="code" href="classFunkce.html#a1aa6b1dca86c8925458c1ac99533ad3">00908</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#a1aa6b1dca86c8925458c1ac99533ad3">AutoZalohovani</a>()
<a name="l00909"></a>00909   {
<a name="l00910"></a>00910     <span class="keywordflow">if</span> ($this-&gt;var-&gt;autozaloha)
<a name="l00911"></a>00911     {
<a name="l00912"></a>00912       $cesta = $this-&gt;var-&gt;zalohadir;
<a name="l00913"></a>00913       <span class="keywordflow">if</span> (file_exists($cesta))
<a name="l00914"></a>00914       {
<a name="l00915"></a>00915         $handle = opendir($cesta);
<a name="l00916"></a>00916         $i = 0;
<a name="l00917"></a>00917         <span class="keywordflow">while</span>($soub = readdir($handle))
<a name="l00918"></a>00918         {
<a name="l00919"></a>00919           <span class="keywordflow">if</span> ($soub != <span class="stringliteral">"."</span> &amp;&amp; $soub != <span class="stringliteral">".."</span> &amp;&amp; filetype(<span class="stringliteral">"{$cesta}/{$soub}"</span>) == <span class="stringliteral">"file"</span>)
<a name="l00920"></a>00920           {
<a name="l00921"></a>00921             <span class="keywordflow">if</span> (date(<span class="stringliteral">"Y-m-d"</span>) == date(<span class="stringliteral">"Y-m-d"</span>, filemtime(<span class="stringliteral">"{$cesta}/{$soub}"</span>)))
<a name="l00922"></a>00922             {
<a name="l00923"></a>00923               $i++;
<a name="l00924"></a>00924             }
<a name="l00925"></a>00925           }
<a name="l00926"></a>00926         }
<a name="l00927"></a>00927         closedir($handle);
<a name="l00928"></a>00928 
<a name="l00929"></a>00929         <span class="keywordflow">if</span> ($i == 0)
<a name="l00930"></a>00930         {
<a name="l00931"></a>00931           $this-&gt;<a class="code" href="classFunkce.html#e2222af28360a6961e5983e38b91811c">ZalohovaniSQLiteDB</a>(<span class="keyword">false</span>); <span class="comment">//pri prazdne slozce</span>
<a name="l00932"></a>00932         }
<a name="l00933"></a>00933       }
<a name="l00934"></a>00934         <span class="keywordflow">else</span>
<a name="l00935"></a>00935       {
<a name="l00936"></a>00936         mkdir($this-&gt;var-&gt;zalohadir, 0777);  <span class="comment">//vytvoreni a prvotni zalohovani</span>
<a name="l00937"></a>00937         $this-&gt;<a class="code" href="classFunkce.html#e2222af28360a6961e5983e38b91811c">ZalohovaniSQLiteDB</a>(<span class="keyword">false</span>);
<a name="l00938"></a>00938       }
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940   }
<a name="l00941"></a>00941 
<a name="l00948"></a><a class="code" href="classFunkce.html#119ba054ba2aa0e03c28b1319ddbc33e">00948</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#119ba054ba2aa0e03c28b1319ddbc33e">VypisZalohyDB</a>()
<a name="l00949"></a>00949   {
<a name="l00950"></a>00950     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00951"></a>00951     $cesta = $this-&gt;var-&gt;zalohadir;
<a name="l00952"></a>00952     <span class="keywordflow">if</span> (file_exists($cesta))
<a name="l00953"></a>00953     {
<a name="l00954"></a>00954       $handle = opendir($cesta);
<a name="l00955"></a>00955       $i = 0;
<a name="l00956"></a>00956       <span class="keywordflow">while</span>($soub = readdir($handle))
<a name="l00957"></a>00957       {
<a name="l00958"></a>00958         <span class="keywordflow">if</span> ($soub != <span class="stringliteral">"."</span> &amp;&amp; $soub != <span class="stringliteral">".."</span> &amp;&amp; filetype(<span class="stringliteral">"{$cesta}/{$soub}"</span>) == <span class="stringliteral">"file"</span>)
<a name="l00959"></a>00959         {
<a name="l00960"></a>00960           $soubor[$i] = $soub;
<a name="l00961"></a>00961           $i++;
<a name="l00962"></a>00962         }
<a name="l00963"></a>00963       }
<a name="l00964"></a>00964       closedir($handle);
<a name="l00965"></a>00965 
<a name="l00966"></a>00966       <span class="keywordflow">if</span> ($i == 0)
<a name="l00967"></a>00967       {
<a name="l00968"></a>00968         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_null"</span>]);
<a name="l00969"></a>00969       }
<a name="l00970"></a>00970         <span class="keywordflow">else</span>
<a name="l00971"></a>00971       {
<a name="l00972"></a>00972         rsort($soubor);
<a name="l00973"></a>00973 
<a name="l00974"></a>00974         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_hlavicka"</span>]);
<a name="l00975"></a>00975 
<a name="l00976"></a>00976         $prvni = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_prvni"</span>]);
<a name="l00977"></a>00977         $posledni = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_posledni"</span>]);
<a name="l00978"></a>00978         $ente_def_array = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_ente_def_array"</span>]);
<a name="l00979"></a>00979         $ente_def = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_ente_def"</span>]);
<a name="l00980"></a>00980         $ente_od = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_ente_od"</span>]);
<a name="l00981"></a>00981         $ente_po = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_ente_po"</span>]);
<a name="l00982"></a>00982         $ente = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_ente"</span>]);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984         <span class="keywordflow">for</span> ($i = 0; $i &lt; count($soubor); $i++)
<a name="l00985"></a>00985         {
<a name="l00986"></a>00986           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_telicko"</span>],
<a name="l00987"></a>00987                                               $soubor[$i],
<a name="l00988"></a>00988                                               <span class="stringliteral">"{$cesta}/{$soubor[$i]}"</span>,
<a name="l00989"></a>00989                                               date($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_tvar_datum"</span>]), filemtime(<span class="stringliteral">"{$cesta}/{$soubor[$i]}"</span>)),
<a name="l00990"></a>00990                                               $this-&gt;<a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>(filesize(<span class="stringliteral">"{$cesta}/{$soubor[$i]}"</span>)),
<a name="l00991"></a>00991                                               <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}{$this-&gt;iddelzal}&amp;amp;file={$soubor[$i]}"</span>,
<a name="l00992"></a>00992                                               ($i == 0 ? $prvni : <span class="stringliteral">""</span>),
<a name="l00993"></a>00993                                               ($i == (count($soubor) - 1) ? $posledni : <span class="stringliteral">""</span>),
<a name="l00994"></a>00994                                               (in_array($i, $ente_def_array) ? $ente_def : <span class="stringliteral">""</span>),
<a name="l00995"></a>00995                                               ((($i + $ente_od) % $ente_po) == 0 ? $ente : <span class="stringliteral">""</span>));
<a name="l00996"></a>00996 
<a name="l00997"></a>00997           <span class="keywordflow">if</span> (filemtime(<span class="stringliteral">"{$cesta}/{$soubor[$i]}"</span>) &lt;= mktime(0, 0, 0, date(<span class="stringliteral">"n"</span>), date(<span class="stringliteral">"j"</span>) - $this-&gt;var-&gt;zalohovatdni, date(<span class="stringliteral">"Y"</span>)))
<a name="l00998"></a>00998           {
<a name="l00999"></a>00999             unlink(<span class="stringliteral">"{$cesta}/{$soubor[$i]}"</span>); <span class="comment">//smaze starsi N dni</span>
<a name="l01000"></a>01000             <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_del"</span>], $soubor[$i]);
<a name="l01001"></a>01001           }
<a name="l01002"></a>01002         }
<a name="l01003"></a>01003       }
<a name="l01004"></a>01004     }
<a name="l01005"></a>01005       <span class="keywordflow">else</span>
<a name="l01006"></a>01006     {
<a name="l01007"></a>01007       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"vypis_zaloha_notexists"</span>], $cesta);
<a name="l01008"></a>01008     }
<a name="l01009"></a>01009 
<a name="l01010"></a>01010     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01011"></a>01011   }
<a name="l01012"></a>01012 
<a name="l01019"></a><a class="code" href="classFunkce.html#03b7ee28259a688c366e6f06f9ac4a50">01019</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#03b7ee28259a688c366e6f06f9ac4a50">SmazatSouborZalohy</a>()
<a name="l01020"></a>01020   {
<a name="l01021"></a>01021     $cesta = $_GET[<span class="stringliteral">"file"</span>];
<a name="l01022"></a>01022 
<a name="l01023"></a>01023     <span class="keywordflow">if</span> (file_exists(<span class="stringliteral">"{$this-&gt;var-&gt;zalohadir}/{$cesta}"</span>))
<a name="l01024"></a>01024     {
<a name="l01025"></a>01025       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = (unlink(<span class="stringliteral">"{$this-&gt;var-&gt;zalohadir}/{$cesta}"</span>) ?
<a name="l01026"></a>01026                 $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"zaloha_smazano_true"</span>], $cesta) :
<a name="l01027"></a>01027                 $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"zaloha_smazano_false"</span>], $cesta));
<a name="l01028"></a>01028 
<a name="l01029"></a>01029       $this-&gt;var-&gt;main[0]-&gt;AutoClick(2, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l01030"></a>01030     }
<a name="l01031"></a>01031       <span class="keywordflow">else</span>
<a name="l01032"></a>01032     {
<a name="l01033"></a>01033       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"zaloha_dir_notexists"</span>], $cesta);
<a name="l01034"></a>01034 
<a name="l01035"></a>01035       $this-&gt;var-&gt;main[0]-&gt;AutoClick(2, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01039"></a>01039   }
<a name="l01040"></a>01040 
<a name="l01050"></a><a class="code" href="classFunkce.html#3c9e77b4971fd8b6ad361518f1466a3b">01050</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#3c9e77b4971fd8b6ad361518f1466a3b">NactiUrl</a>($url)
<a name="l01051"></a>01051   {
<a name="l01052"></a>01052     $url = str_replace(<span class="stringliteral">"http://"</span>, <span class="stringliteral">""</span>, $url);
<a name="l01053"></a>01053     <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">"#/#"</span>,<span class="stringliteral">"{$url}"</span>))
<a name="l01054"></a>01054     {
<a name="l01055"></a>01055       $page = $url;
<a name="l01056"></a>01056       $url = @explode(<span class="stringliteral">"/"</span>,$url);
<a name="l01057"></a>01057       $url = $url[0];
<a name="l01058"></a>01058       $page = str_replace($url,<span class="stringliteral">""</span>,$page);
<a name="l01059"></a>01059       <span class="keywordflow">if</span> (!$page || $page == <span class="stringliteral">""</span>)
<a name="l01060"></a>01060       {
<a name="l01061"></a>01061         $page = <span class="stringliteral">"/"</span>;
<a name="l01062"></a>01062       }
<a name="l01063"></a>01063       $ip = gethostbyname($url);
<a name="l01064"></a>01064     }
<a name="l01065"></a>01065       <span class="keywordflow">else</span>
<a name="l01066"></a>01066     {
<a name="l01067"></a>01067       $ip = gethostbyname($url);
<a name="l01068"></a>01068       $page = <span class="stringliteral">"/"</span>;
<a name="l01069"></a>01069     }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071     <span class="keywordflow">if</span> ($open = @fsockopen($ip, 80, $errno, $errstr, 60))
<a name="l01072"></a>01072     {
<a name="l01073"></a>01073       $send .= <span class="stringliteral">"GET {$page} HTTP/1.0\r\n"</span>;
<a name="l01074"></a>01074       $send .= <span class="stringliteral">"Host: {$url}\r\n"</span>;
<a name="l01075"></a>01075       $send .= <span class="stringliteral">"Accept-Language: en-us, en;q=0.50\r\n"</span>;
<a name="l01076"></a>01076       $send .= <span class="stringliteral">"User-Agent: {$_SERVER["</span>HTTP_USER_AGENT<span class="stringliteral">"]}\r\n"</span>;
<a name="l01077"></a>01077       $send .= <span class="stringliteral">"Connection: Close\r\n\r\n"</span>;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079       fputs($open, $send);
<a name="l01080"></a>01080       $return = <span class="stringliteral">""</span>;
<a name="l01081"></a>01081       <span class="keywordflow">while</span> (!feof($open))
<a name="l01082"></a>01082       {
<a name="l01083"></a>01083         $return .= fgets($open, 4096);
<a name="l01084"></a>01084       }
<a name="l01085"></a>01085       fclose($open);
<a name="l01086"></a>01086 
<a name="l01087"></a>01087       $ret = @explode(<span class="stringliteral">"\r\n\r\n"</span>, $return, 2);
<a name="l01088"></a>01088       <span class="comment">//$header = $ret[0]; //header</span>
<a name="l01089"></a>01089       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $ret[1]; <span class="comment">//body</span>
<a name="l01090"></a>01090     }
<a name="l01091"></a>01091       <span class="keywordflow">else</span>
<a name="l01092"></a>01092     {
<a name="l01093"></a>01093       $this-&gt;<a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"error_get_url"</span>], $errno, $errstr), array(__LINE__, __METHOD__));
<a name="l01094"></a>01094       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = NULL;
<a name="l01095"></a>01095     }
<a name="l01096"></a>01096     <span class="comment">//$result = file_get_contents($url);</span>
<a name="l01097"></a>01097 
<a name="l01098"></a>01098     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01099"></a>01099   }
<a name="l01100"></a>01100 
<a name="l01110"></a><a class="code" href="classFunkce.html#e6778847571b5a016acce7e7779e0285">01110</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#e6778847571b5a016acce7e7779e0285">KontrolaEmailu</a>($email)
<a name="l01111"></a>01111   {
<a name="l01112"></a>01112     $emaily = explode(<span class="stringliteral">","</span>, $email);
<a name="l01113"></a>01113     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l01114"></a>01114     <a class="code" href="classFunkce.html#e5174587f8a13f14df423df187f5394b">$konec</a> = <span class="keyword">false</span>;
<a name="l01115"></a>01115     $email = <span class="stringliteral">""</span>;
<a name="l01116"></a>01116     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($emaily); $i++)
<a name="l01117"></a>01117     {
<a name="l01118"></a>01118       $regular = <span class="stringliteral">"/^[_a-zA-Z0-9\.\-]+@[_a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,4}\$/"</span>;
<a name="l01119"></a>01119       preg_match($regular, trim($emaily[$i]), $ret);
<a name="l01120"></a>01120 
<a name="l01121"></a>01121       <span class="keywordflow">if</span> (!Empty($ret[0]))  <span class="comment">//pokud je neprazdny, nechybny</span>
<a name="l01122"></a>01122       {
<a name="l01123"></a>01123         $email[] = $ret[0];
<a name="l01124"></a>01124       }
<a name="l01125"></a>01125         <span class="keywordflow">else</span>
<a name="l01126"></a>01126       {
<a name="l01127"></a>01127         <a class="code" href="classFunkce.html#e5174587f8a13f14df423df187f5394b">$konec</a> = <span class="keyword">true</span>;
<a name="l01128"></a>01128       }
<a name="l01129"></a>01129     }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = (!<a class="code" href="classFunkce.html#e5174587f8a13f14df423df187f5394b">$konec</a> ? implode(<span class="stringliteral">", "</span>, $email) : <span class="stringliteral">""</span>);
<a name="l01132"></a>01132 
<a name="l01133"></a>01133     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01134"></a>01134   }
<a name="l01135"></a>01135 
<a name="l01145"></a><a class="code" href="classFunkce.html#89f5e0f46c85a864f457db9feb24388a">01145</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#89f5e0f46c85a864f457db9feb24388a">ExistenceUrl</a>($url)
<a name="l01146"></a>01146   {
<a name="l01147"></a>01147     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="keyword">false</span>;
<a name="l01148"></a>01148     <span class="keywordflow">if</span> (!in_array($_SERVER[<span class="stringliteral">"REMOTE_ADDR"</span>], $this-&gt;var-&gt;ipblok))
<a name="l01149"></a>01149     {
<a name="l01150"></a>01150       $a = get_headers($url);
<a name="l01151"></a>01151       $b = explode(<span class="stringliteral">" "</span>, $a[0]);
<a name="l01152"></a>01152 
<a name="l01153"></a>01153       <span class="keywordflow">if</span> ($b[1] == 200) <span class="comment">//kdyz existuje je 200</span>
<a name="l01154"></a>01154       {
<a name="l01155"></a>01155         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="keyword">true</span>;
<a name="l01156"></a>01156       }
<a name="l01157"></a>01157         <span class="keywordflow">else</span>
<a name="l01158"></a>01158       {
<a name="l01159"></a>01159         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="keyword">false</span>;
<a name="l01160"></a>01160       }
<a name="l01161"></a>01161     }
<a name="l01162"></a>01162       <span class="keywordflow">else</span>
<a name="l01163"></a>01163     {
<a name="l01164"></a>01164       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="keyword">true</span>; <span class="comment">//docasne!</span>
<a name="l01165"></a>01165     }
<a name="l01166"></a>01166 
<a name="l01167"></a>01167     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01168"></a>01168   }
<a name="l01169"></a>01169 
<a name="l01176"></a><a class="code" href="classFunkce.html#b282551a0352afed9a57f748b8d2da16">01176</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#b282551a0352afed9a57f748b8d2da16">CasAktualizace</a>()
<a name="l01177"></a>01177   {
<a name="l01178"></a>01178     $endtime = mktime(date(<span class="stringliteral">"H"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]) + $this-&gt;var-&gt;admin_expire[0],
<a name="l01179"></a>01179                       date(<span class="stringliteral">"i"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]) + $this-&gt;var-&gt;admin_expire[1],
<a name="l01180"></a>01180                       date(<span class="stringliteral">"s"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]) + $this-&gt;var-&gt;admin_expire[2],
<a name="l01181"></a>01181                       date(<span class="stringliteral">"n"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]), date(<span class="stringliteral">"j"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]), date(<span class="stringliteral">"Y"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]));
<a name="l01182"></a>01182 
<a name="l01183"></a>01183     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_cas_aktualizace"</span>],
<a name="l01184"></a>01184                                         date(<span class="stringliteral">"H:i:s"</span>, $_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>]),
<a name="l01185"></a>01185                                         $this-&gt;var-&gt;admin_expire[0],
<a name="l01186"></a>01186                                         $this-&gt;var-&gt;admin_expire[1],
<a name="l01187"></a>01187                                         $this-&gt;var-&gt;admin_expire[2],
<a name="l01188"></a>01188                                         date(<span class="stringliteral">"H:i:s"</span>, $endtime));
<a name="l01189"></a>01189 
<a name="l01190"></a>01190     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01191"></a>01191   }
<a name="l01192"></a>01192 
<a name="l01198"></a><a class="code" href="classFunkce.html#69911132bb6199619c01dfd49855aa71">01198</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#69911132bb6199619c01dfd49855aa71">Prihlasovani</a>()
<a name="l01199"></a>01199   {
<a name="l01200"></a>01200     $logon = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_autorizace_logon"</span>]);
<a name="l01201"></a>01201     <a class="code" href="classFunkce.html#b0a88f7ba7f2060cab20e8d715edaf48">$logoff</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_autorizace_logoff"</span>]);
<a name="l01202"></a>01202     $absolutni_url = $this-&gt;<a class="code" href="classFunkce.html#b11e85edc953ceb83955f3b43347d4f5">AbsoluteUrl</a>();
<a name="l01203"></a>01203 
<a name="l01204"></a>01204     $nextdate = mktime(date(<span class="stringliteral">"H"</span>) + $this-&gt;var-&gt;admin_expire[0],
<a name="l01205"></a>01205                       date(<span class="stringliteral">"i"</span>) + $this-&gt;var-&gt;admin_expire[1],
<a name="l01206"></a>01206                       date(<span class="stringliteral">"s"</span>) + $this-&gt;var-&gt;admin_expire[2],
<a name="l01207"></a>01207                       date(<span class="stringliteral">"n"</span>), date(<span class="stringliteral">"j"</span>), date(<span class="stringliteral">"Y"</span>));
<a name="l01208"></a>01208 
<a name="l01209"></a>01209     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == <span class="stringliteral">"logoff"</span>)
<a name="l01210"></a>01210     {
<a name="l01211"></a>01211       unset($_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>]);
<a name="l01212"></a>01212       $_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>] = <span class="stringliteral">""</span>;
<a name="l01213"></a>01213       $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>] = <span class="stringliteral">""</span>;
<a name="l01214"></a>01214 
<a name="l01215"></a>01215       header(<span class="stringliteral">"WWW-Authenticate: Basic realm=\"{$logoff}\""</span>);
<a name="l01216"></a>01216       header(<span class="stringliteral">"HTTP/1.0 401 Unauthorized"</span>);
<a name="l01217"></a>01217 
<a name="l01218"></a>01218       $this-&gt;<a class="code" href="classFunkce.html#1a42209cf0b25a41f692ad194a4d80f9">AutoClick</a>(0, $absolutni_url);
<a name="l01219"></a>01219     }
<a name="l01220"></a>01220 
<a name="l01221"></a>01221     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu)
<a name="l01222"></a>01222     {
<a name="l01223"></a>01223       <span class="keywordflow">if</span> ($this-&gt;var-&gt;klenot)  <span class="comment">//prepnuti pro ziskani dat z klenot</span>
<a name="l01224"></a>01224       {
<a name="l01225"></a>01225         list($_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>], $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>]) = explode(<span class="stringliteral">":"</span>, base64_decode(substr($_SERVER[<span class="stringliteral">"REDIRECT_REMOTE_USER"</span>], 6)));
<a name="l01226"></a>01226       }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228       <span class="keywordflow">if</span> (Empty($_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>]) &amp;&amp; Empty($_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>]))
<a name="l01229"></a>01229       {
<a name="l01230"></a>01230         header(<span class="stringliteral">"WWW-Authenticate: Basic realm=\"{$logon}\""</span>);
<a name="l01231"></a>01231         header(<span class="stringliteral">"HTTP/1.0 401 Unauthorized"</span>);
<a name="l01232"></a>01232 
<a name="l01233"></a>01233         echo $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_autorizace_meta"</span>], <span class="stringliteral">"{$absolutni_url}?{$this-&gt;var-&gt;get_kam}=logoff"</span>);
<a name="l01234"></a>01234         exit(0);
<a name="l01235"></a>01235       }
<a name="l01236"></a>01236         <span class="keywordflow">else</span>
<a name="l01237"></a>01237       {
<a name="l01238"></a>01238         <span class="keywordflow">if</span> (Empty($_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>])) <span class="comment">//zaznamena cas jen po prihlaseni</span>
<a name="l01239"></a>01239         {
<a name="l01240"></a>01240           $_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>] = $nextdate;
<a name="l01241"></a>01241         }
<a name="l01242"></a>01242           <span class="keywordflow">else</span>
<a name="l01243"></a>01243         {
<a name="l01244"></a>01244           <span class="keywordflow">if</span> ($_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>] &gt; $_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>])
<a name="l01245"></a>01245           {
<a name="l01246"></a>01246             unset($_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>]);
<a name="l01247"></a>01247             $_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>] = <span class="stringliteral">""</span>;
<a name="l01248"></a>01248             $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>] = <span class="stringliteral">""</span>;
<a name="l01249"></a>01249 
<a name="l01250"></a>01250             $this-&gt;<a class="code" href="classFunkce.html#1a42209cf0b25a41f692ad194a4d80f9">AutoClick</a>(0, <span class="stringliteral">"{$absolutni_url}?{$this-&gt;var-&gt;get_kam}=logoff"</span>);
<a name="l01251"></a>01251           }
<a name="l01252"></a>01252         }
<a name="l01253"></a>01253       }
<a name="l01254"></a>01254 
<a name="l01255"></a>01255       <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classFunkce.html#3e5b3e0ae457dbff92757893f42e4c59">Autorizace</a>($_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>], $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>])) <span class="comment">//je-li spatny login &amp; heslo</span>
<a name="l01256"></a>01256       {
<a name="l01257"></a>01257         $this-&gt;var-&gt;aktivniadmin = <span class="keyword">false</span>;
<a name="l01258"></a>01258 
<a name="l01259"></a>01259         unset($_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>]);
<a name="l01260"></a>01260         $_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>] = <span class="stringliteral">""</span>;
<a name="l01261"></a>01261         $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>] = <span class="stringliteral">""</span>;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263         $this-&gt;<a class="code" href="classFunkce.html#1a42209cf0b25a41f692ad194a4d80f9">AutoClick</a>(0, $absolutni_url);
<a name="l01264"></a>01264       }
<a name="l01265"></a>01265         <span class="keywordflow">else</span>
<a name="l01266"></a>01266       {
<a name="l01267"></a>01267         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classFunkce.html#3e5b3e0ae457dbff92757893f42e4c59">Autorizace</a>($_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>], $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>]))  <span class="comment">//kdyz je prihaseno</span>
<a name="l01268"></a>01268         {
<a name="l01269"></a>01269           $this-&gt;var-&gt;aktivniadmin = <span class="keyword">true</span>;
<a name="l01270"></a>01270 
<a name="l01271"></a>01271           <span class="keywordflow">if</span> ($_SERVER[<span class="stringliteral">"REQUEST_TIME"</span>] &gt; $_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>])
<a name="l01272"></a>01272           {
<a name="l01273"></a>01273             unset($_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>]);
<a name="l01274"></a>01274             $_SERVER[<span class="stringliteral">"PHP_AUTH_USER"</span>] = <span class="stringliteral">""</span>;
<a name="l01275"></a>01275             $_SERVER[<span class="stringliteral">"PHP_AUTH_PW"</span>] = <span class="stringliteral">""</span>;
<a name="l01276"></a>01276 
<a name="l01277"></a>01277             $this-&gt;<a class="code" href="classFunkce.html#1a42209cf0b25a41f692ad194a4d80f9">AutoClick</a>(0, <span class="stringliteral">"{$absolutni_url}?{$this-&gt;var-&gt;get_kam}=logoff"</span>);
<a name="l01278"></a>01278           }
<a name="l01279"></a>01279 
<a name="l01280"></a>01280           $_SESSION[<span class="stringliteral">"ADMIN_TIME"</span>] = $nextdate;
<a name="l01281"></a>01281         }
<a name="l01282"></a>01282       }
<a name="l01283"></a>01283     }
<a name="l01284"></a>01284   }
<a name="l01285"></a>01285 
<a name="l01294"></a><a class="code" href="classFunkce.html#3e5b3e0ae457dbff92757893f42e4c59">01294</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#3e5b3e0ae457dbff92757893f42e4c59">Autorizace</a>($login, $heslo)
<a name="l01295"></a>01295   { <span class="comment">//+ jeste udelat expiraci!!</span>
<a name="l01296"></a>01296     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = ($this-&gt;var-&gt;adminpristup[md5(md5($login))] == md5(md5($heslo)) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l01297"></a>01297 
<a name="l01298"></a>01298     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01299"></a>01299   }
<a name="l01300"></a>01300 
<a name="l01307"></a><a class="code" href="classFunkce.html#8daeb11d1c64737611de6bca11e6c6c7">01307</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#8daeb11d1c64737611de6bca11e6c6c7">MeritCas</a>() <span class="comment">//funkce pro vrácení času</span>
<a name="l01308"></a>01308   {
<a name="l01309"></a>01309     $cas = explode(<span class="stringliteral">" "</span>, microtime());
<a name="l01310"></a>01310     $soucet = $cas[1] + $cas[0];
<a name="l01311"></a>01311 
<a name="l01312"></a>01312     <span class="keywordflow">return</span> $soucet;
<a name="l01313"></a>01313   }
<a name="l01314"></a>01314 
<a name="l01320"></a><a class="code" href="classFunkce.html#147580ce949ee4701ff667188251a22b">01320</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#147580ce949ee4701ff667188251a22b">StartCas</a>() <span class="comment">//zapis začátku</span>
<a name="l01321"></a>01321   {
<a name="l01322"></a>01322     $this-&gt;start = $this-&gt;<a class="code" href="classFunkce.html#8daeb11d1c64737611de6bca11e6c6c7">MeritCas</a>();
<a name="l01323"></a>01323   }
<a name="l01324"></a>01324 
<a name="l01331"></a><a class="code" href="classFunkce.html#8789e5480291d6628bb0a89d620c7633">01331</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#8789e5480291d6628bb0a89d620c7633">KonecCas</a>()
<a name="l01332"></a>01332   {
<a name="l01333"></a>01333     $this-&gt;konec = $this-&gt;<a class="code" href="classFunkce.html#8daeb11d1c64737611de6bca11e6c6c7">MeritCas</a>();
<a name="l01334"></a>01334     $cas = Abs(Round(($this-&gt;konec - $this-&gt;start) * 10000) / 10000); <span class="comment">//Abs, výpočet</span>
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="keywordflow">return</span> $cas;
<a name="l01337"></a>01337   }
<a name="l01338"></a>01338 
<a name="l01348"></a><a class="code" href="classFunkce.html#2dcf87d57afecaaf55bcf6233fc6e773">01348</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#2dcf87d57afecaaf55bcf6233fc6e773">OdkazZpet</a>($text = <span class="stringliteral">"O úroveň nazpět"</span>, $zpet = 1) <span class="comment">//vracec historie</span>
<a name="l01349"></a>01349   {
<a name="l01350"></a>01350     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_odkaz_zpet"</span>], $zpet, $text);
<a name="l01351"></a>01351 
<a name="l01352"></a>01352     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01353"></a>01353   }
<a name="l01354"></a>01354 
<a name="l01367"></a><a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">01367</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#b97d078108dee085899d2898da347347">ErrorMsg</a>($chyba, $poloha = array(0, NULL), $zpet_odkaz = <span class="stringliteral">"O úroveň nazpět"</span>, $primo = <span class="keyword">false</span>)  <span class="comment">//proecdura chybove hlasky</span>
<a name="l01368"></a>01368   {
<a name="l01369"></a>01369     <span class="keyword">static</span> $volani = 0;
<a name="l01370"></a>01370 
<a name="l01371"></a>01371     $this-&gt;var-&gt;chyba[$volani][<span class="stringliteral">"chyba"</span>] = $chyba;
<a name="l01372"></a>01372     $this-&gt;var-&gt;chyba[$volani][<span class="stringliteral">"poloha"</span>] = $poloha;
<a name="l01373"></a>01373     $this-&gt;var-&gt;chyba[$volani][<span class="stringliteral">"zpet_odkaz"</span>] = $zpet_odkaz;
<a name="l01374"></a>01374     $this-&gt;var-&gt;chyba[$volani][<span class="stringliteral">"primo"</span>] = $primo;
<a name="l01375"></a>01375 
<a name="l01376"></a>01376     $volani++;
<a name="l01377"></a>01377   }
<a name="l01378"></a>01378 
<a name="l01384"></a><a class="code" href="classFunkce.html#401e223ac91785e92e3b2eda20e7884d">01384</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#401e223ac91785e92e3b2eda20e7884d">VypisVsechnyChyby</a>()
<a name="l01385"></a>01385   {
<a name="l01386"></a>01386     $chyby = $this-&gt;var-&gt;chyba;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388     <span class="keywordflow">if</span> (count($chyby) &gt; 0)  <span class="comment">//je-li nejaka chyba</span>
<a name="l01389"></a>01389     {
<a name="l01390"></a>01390       $kriticka = 0;
<a name="l01391"></a>01391       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_chyba_begin"</span>]);
<a name="l01392"></a>01392       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($chyby); $i++)
<a name="l01393"></a>01393       {
<a name="l01394"></a>01394         <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_chyba"</span>],
<a name="l01395"></a>01395                                             $chyby[$i][<span class="stringliteral">"chyba"</span>],
<a name="l01396"></a>01396                                             $chyby[$i][<span class="stringliteral">"poloha"</span>][0],
<a name="l01397"></a>01397                                             $chyby[$i][<span class="stringliteral">"poloha"</span>][1]);
<a name="l01398"></a>01398 
<a name="l01399"></a>01399         <span class="keywordflow">if</span> ($chyby[$i][<span class="stringliteral">"primo"</span>])  <span class="comment">//detekce kryticke chyby</span>
<a name="l01400"></a>01400         {
<a name="l01401"></a>01401           $kriticka++;
<a name="l01402"></a>01402         }
<a name="l01403"></a>01403       }
<a name="l01404"></a>01404       <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_chyba_end"</span>],
<a name="l01405"></a>01405                                           $this-&gt;<a class="code" href="classFunkce.html#2dcf87d57afecaaf55bcf6233fc6e773">OdkazZpet</a>($chyby[0][<span class="stringliteral">"zpet_odkaz"</span>]));
<a name="l01406"></a>01406 
<a name="l01407"></a>01407       <span class="keywordflow">if</span> ($kriticka != 0) <span class="comment">//je-li detekovana kriticka chyba</span>
<a name="l01408"></a>01408       {
<a name="l01409"></a>01409         echo <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01410"></a>01410         exit(1);
<a name="l01411"></a>01411       }
<a name="l01412"></a>01412         <span class="keywordflow">else</span>
<a name="l01413"></a>01413       {
<a name="l01414"></a>01414         $this-&gt;var-&gt;chyba = <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01415"></a>01415       }
<a name="l01416"></a>01416     }
<a name="l01417"></a>01417   }
<a name="l01418"></a>01418 
<a name="l01429"></a><a class="code" href="classFunkce.html#1a42209cf0b25a41f692ad194a4d80f9">01429</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#1a42209cf0b25a41f692ad194a4d80f9">AutoClick</a>($cas, $cesta)  <span class="comment">//auto kliknuti, procedura</span>
<a name="l01430"></a>01430   {
<a name="l01431"></a>01431     $this-&gt;var-&gt;meta = <span class="stringliteral">"&lt;meta http-equiv=\"refresh\" content=\"{$cas};URL={$cesta}\" /&gt;"</span>;
<a name="l01432"></a>01432   }
<a name="l01433"></a>01433 
<a name="l01443"></a><a class="code" href="classFunkce.html#155ab59e21321e7d22a39bc54867d48b">01443</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#155ab59e21321e7d22a39bc54867d48b">TypOS</a>($agent)
<a name="l01444"></a>01444   {
<a name="l01445"></a>01445     $OSList = array(<span class="stringliteral">"Windows 3.11"</span> =&gt; <span class="stringliteral">"/Win16/i"</span>,
<a name="l01446"></a>01446                     <span class="stringliteral">"Windows 95"</span> =&gt; <span class="stringliteral">"/(Windows.95)|(Win95)/i"</span>,
<a name="l01447"></a>01447                     <span class="stringliteral">"Windows 98"</span> =&gt; <span class="stringliteral">"/(Windows.98)|(Win98)/i"</span>,
<a name="l01448"></a>01448                     <span class="stringliteral">"Windows 2000"</span> =&gt; <span class="stringliteral">"/(Windows NT 5\.0)|(Windows 2000)/i"</span>,
<a name="l01449"></a>01449                     <span class="stringliteral">"Windows XP"</span> =&gt; <span class="stringliteral">"/(Windows NT 5\.1)|(Windows XP)/i"</span>,
<a name="l01450"></a>01450                     <span class="stringliteral">"Windows XP x64"</span> =&gt; <span class="stringliteral">"/((Windows NT 5\.2).*(Win64))|((Win64).*(Windows NT 5\.2))/i"</span>,
<a name="l01451"></a>01451                     <span class="stringliteral">"Windows Server 2003"</span> =&gt; <span class="stringliteral">"/Windows NT 5\.2/i"</span>,
<a name="l01452"></a>01452                     <span class="stringliteral">"Windows Vista"</span> =&gt; <span class="stringliteral">"/Windows NT 6\.0/i"</span>,
<a name="l01453"></a>01453                     <span class="stringliteral">"Windows 7"</span> =&gt; <span class="stringliteral">"/Windows NT 7\.0/i"</span>,
<a name="l01454"></a>01454                     <span class="stringliteral">"Windows NT 4.0"</span> =&gt; <span class="stringliteral">"/(Windows NT 4\.0)|(WinNT4\.0)|(WinNT)|(Windows NT)/i"</span>,
<a name="l01455"></a>01455                     <span class="stringliteral">"Windows ME"</span> =&gt; <span class="stringliteral">"/(Windows ME)|(Win 9x 4\.90)/i"</span>,
<a name="l01456"></a>01456                     <span class="stringliteral">"Microsoft PocketPC"</span> =&gt; <span class="stringliteral">"/((Windows CE).*(PPC))|((PPC).*(Windows CE))/i"</span>,
<a name="l01457"></a>01457                     <span class="stringliteral">"Microsoft Smartphone"</span> =&gt; <span class="stringliteral">"/((Windows CE).*(smartphone))|((smartphone).*(Windows CE))/i"</span>,
<a name="l01458"></a>01458                     <span class="stringliteral">"Windows CE"</span> =&gt; <span class="stringliteral">"/Windows CE/i"</span>,
<a name="l01459"></a>01459                     <span class="stringliteral">"Mandrake Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Mandrake))|((Mandrake).*(Linux))/i"</span>,
<a name="l01460"></a>01460                     <span class="stringliteral">"Mandriva Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Mandriva))|((Mandriva).*(Linux))/i"</span>,
<a name="l01461"></a>01461                     <span class="stringliteral">"SuSE Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(SuSE))|((SuSE).*(Linux))/i"</span>,
<a name="l01462"></a>01462                     <span class="stringliteral">"Novell Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Novell))|((Novell).*(Linux))/i"</span>,
<a name="l01463"></a>01463                     <span class="stringliteral">"Kubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Kubuntu))|((Kubuntu).*(Linux))/i"</span>,
<a name="l01464"></a>01464                     <span class="stringliteral">"Xubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Xubuntu))|((Xubuntu).*(Linux))/i"</span>,
<a name="l01465"></a>01465                     <span class="stringliteral">"Edubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Edubuntu))|((Edubuntu).*(Linux))/i"</span>,
<a name="l01466"></a>01466                     <span class="stringliteral">"Ubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Ubuntu))|((Ubuntu).*(Linux))/i"</span>,
<a name="l01467"></a>01467                     <span class="stringliteral">"Debian GNU/Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Debian))|((Debian).*(Linux))/i"</span>,
<a name="l01468"></a>01468                     <span class="stringliteral">"RedHat Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Red ?Hat))|((Red ?Hat).*(Linux))/i"</span>,
<a name="l01469"></a>01469                     <span class="stringliteral">"Gentoo Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Gentoo))|((Gentoo).*(Linux))/i"</span>,
<a name="l01470"></a>01470                     <span class="stringliteral">"Fedora Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Fedora))|((Fedora).*(Linux))/i"</span>,
<a name="l01471"></a>01471                     <span class="stringliteral">"MEPIS Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(MEPIS))|((MEPIS).*(Linux))/i"</span>,
<a name="l01472"></a>01472                     <span class="stringliteral">"Knoppix Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Knoppix))|((Knoppix).*(Linux))/i"</span>,
<a name="l01473"></a>01473                     <span class="stringliteral">"Slackware Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Slackware))|((Slackware).*(Linux))/i"</span>,
<a name="l01474"></a>01474                     <span class="stringliteral">"Xandros Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Xandros))|((Xandros).*(Linux))/i"</span>,
<a name="l01475"></a>01475                     <span class="stringliteral">"Kanotix Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Kanotix))|((Kanotix).*(Linux))/i"</span>,
<a name="l01476"></a>01476                     <span class="stringliteral">"Linux"</span> =&gt; <span class="stringliteral">"/(Linux)|(X11)/i"</span>,
<a name="l01477"></a>01477                     <span class="stringliteral">"FreeBSD"</span> =&gt; <span class="stringliteral">"/Free/i"</span>,
<a name="l01478"></a>01478                     <span class="stringliteral">"OpenBSD"</span> =&gt; <span class="stringliteral">"/OpenBSD/i"</span>,
<a name="l01479"></a>01479                     <span class="stringliteral">"NetBSD"</span> =&gt; <span class="stringliteral">"/NetBSD/i"</span>,
<a name="l01480"></a>01480                     <span class="stringliteral">"SGI IRIX"</span> =&gt; <span class="stringliteral">"/IRIX/i"</span>,
<a name="l01481"></a>01481                     <span class="stringliteral">"Sun OS"</span> =&gt; <span class="stringliteral">"/SunOS/i"</span>,
<a name="l01482"></a>01482                     <span class="stringliteral">"QNX"</span> =&gt; <span class="stringliteral">"/QNX/i"</span>,
<a name="l01483"></a>01483                     <span class="stringliteral">"BeOS"</span> =&gt; <span class="stringliteral">"/BeOS/i"</span>,
<a name="l01484"></a>01484                     <span class="stringliteral">"Mac OS X Leopard"</span> =&gt; <span class="stringliteral">"/(Mac OS).*(Leopard)/i"</span>,
<a name="l01485"></a>01485                     <span class="stringliteral">"Mac OS X"</span> =&gt; <span class="stringliteral">"/(Mac OS X)/i"</span>,
<a name="l01486"></a>01486                     <span class="stringliteral">"Mac OS"</span> =&gt; <span class="stringliteral">"/(Mac_PowerPC)|(Macintosh)/i"</span>,
<a name="l01487"></a>01487                     <span class="stringliteral">"OS/2"</span> =&gt; <span class="stringliteral">"#OS/2#i"</span>,
<a name="l01488"></a>01488                     <span class="stringliteral">"Qtopia"</span> =&gt; <span class="stringliteral">"/QtEmbedded/i"</span>,
<a name="l01489"></a>01489                     <span class="stringliteral">"Sharp Zaurus \\1"</span> =&gt; <span class="stringliteral">"/Zaurus ([a-zA-Z0-9\.]+)/i"</span>,
<a name="l01490"></a>01490                     <span class="stringliteral">"Zaurus"</span> =&gt; <span class="stringliteral">"/Zaurus/i"</span>,
<a name="l01491"></a>01491                     <span class="stringliteral">"Symbian OS"</span> =&gt; <span class="stringliteral">"/Symbian/i"</span>,
<a name="l01492"></a>01492                     <span class="stringliteral">"Sony Clie"</span> =&gt; <span class="stringliteral">"#PalmOS/sony/model#i"</span>,
<a name="l01493"></a>01493                     <span class="stringliteral">"Series \\1"</span> =&gt; <span class="stringliteral">"/Series ([0-9]+)/i"</span>,
<a name="l01494"></a>01494                     <span class="stringliteral">"Nokia \\1"</span> =&gt; <span class="stringliteral">"/Nokia ([0-9]+)/i"</span>,
<a name="l01495"></a>01495                     <span class="stringliteral">"Siemens \\1"</span> =&gt; <span class="stringliteral">"/SIE-([a-zA-Z0-9]+)/i"</span>,
<a name="l01496"></a>01496                     <span class="stringliteral">"Dopod \\1"</span> =&gt; <span class="stringliteral">"/dopod([a-zA-Z0-9]+)/i"</span>,
<a name="l01497"></a>01497                     <span class="stringliteral">"O2 XDA \\1"</span> =&gt; <span class="stringliteral">"/o2 xda ([a-zA-Z0-9 ]+);/i"</span>,
<a name="l01498"></a>01498                     <span class="stringliteral">"Samsung \\1"</span> =&gt; <span class="stringliteral">"/SEC-([a-zA-Z0-9]+)/i"</span>,
<a name="l01499"></a>01499                     <span class="stringliteral">"SonyEricsson \\1"</span> =&gt; <span class="stringliteral">"/SonyEricsson ?([a-zA-Z0-9]+)/i"</span>,
<a name="l01500"></a>01500                     <span class="stringliteral">"Nintendo Wii"</span> =&gt; <span class="stringliteral">"/Wii/i"</span>,
<a name="l01501"></a>01501                     <span class="stringliteral">"Bot"</span> =&gt; <span class="stringliteral">"/(crawler)|(Mediapartners-Google)|(Jyxobot)|(morfeo.centrum.cz)|(Gigabot)|(ASAP-LynxViewer)|(ASAP-Web-Sniffer)|(EARTHCOM.info)|(Mozdex)|(SeznamBot)|(Speedy Spider)|(Yahoo! Slurp)|(ZACATEK_CZ_BOT)|(www.yacy.net)|(Googlebot)|(Openbot)|(MSNBot)|(del.icio.us-thumbnails)|(Exabot)|(findlinks)|(Bot,Robot,Spider)/i"</span>,
<a name="l01502"></a>01502                     <span class="stringliteral">"Neznámý"</span> =&gt; <span class="stringliteral">"/(.*)/"</span>);
<a name="l01503"></a>01503 
<a name="l01504"></a>01504     <span class="keywordflow">foreach</span>($OSList as $os =&gt; $regexp)
<a name="l01505"></a>01505     {
<a name="l01506"></a>01506       preg_match($regexp, $agent, $matches);
<a name="l01507"></a>01507       <span class="keywordflow">if</span> (!Empty($matches))
<a name="l01508"></a>01508       {
<a name="l01509"></a>01509         <span class="keywordflow">for</span> ($i = 0; $i &lt;= count($matches); $i++)
<a name="l01510"></a>01510         {
<a name="l01511"></a>01511           $os = str_replace(<span class="stringliteral">"\\{$i}"</span>, $matches[$i], $os);
<a name="l01512"></a>01512         }
<a name="l01513"></a>01513         <span class="keywordflow">break</span>;
<a name="l01514"></a>01514       }
<a name="l01515"></a>01515     }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517     <span class="keywordflow">return</span> trim($os);
<a name="l01518"></a>01518   }
<a name="l01519"></a>01519 
<a name="l01529"></a><a class="code" href="classFunkce.html#98109aedad71de96bc201380dff36d71">01529</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#98109aedad71de96bc201380dff36d71">TypBrowseru</a>($agent)
<a name="l01530"></a>01530   {
<a name="l01531"></a>01531     $BrowserList = array (<span class="stringliteral">"Internet Explorer \\1"</span> =&gt; <span class="stringliteral">"#MSIE ([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01532"></a>01532                           <span class="stringliteral">"Mozilla Firefox \\2"</span> =&gt; <span class="stringliteral">"#(Firefox|Phoenix|Firebird)/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01533"></a>01533                           <span class="stringliteral">"Opera \\1"</span> =&gt; <span class="stringliteral">"#Opera[ /]([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01534"></a>01534                           <span class="stringliteral">"Netscape \\1"</span> =&gt; <span class="stringliteral">"#Netscape[0-9]?/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01535"></a>01535                           <span class="stringliteral">"Safari \\1"</span> =&gt; <span class="stringliteral">"#Safari/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01536"></a>01536                           <span class="stringliteral">"Flock \\1"</span> =&gt; <span class="stringliteral">"#Flock/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01537"></a>01537                           <span class="stringliteral">"Epiphany \\1"</span> =&gt; <span class="stringliteral">"#Epiphany/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01538"></a>01538                           <span class="stringliteral">"Konqueror \\1"</span> =&gt; <span class="stringliteral">"#Konqueror/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01539"></a>01539                           <span class="stringliteral">"Maxthon \\1"</span> =&gt; <span class="stringliteral">"#Maxthon ?([a-zA-Z0-9\.]+)?#i"</span>,
<a name="l01540"></a>01540                           <span class="stringliteral">"K-Meleon \\1"</span> =&gt; <span class="stringliteral">"#K-Meleon/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01541"></a>01541                           <span class="stringliteral">"Lynx \\1"</span> =&gt; <span class="stringliteral">"#Lynx/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01542"></a>01542                           <span class="stringliteral">"Links \\1"</span> =&gt; <span class="stringliteral">"#Links .{2}([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01543"></a>01543                           <span class="stringliteral">"ELinks \\3"</span> =&gt; <span class="stringliteral">"#ELinks([/ ]|(.{2}))([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01544"></a>01544                           <span class="stringliteral">"Debian IceWeasel \\1"</span> =&gt; <span class="stringliteral">"#(iceweasel)/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01545"></a>01545                           <span class="stringliteral">"Mozilla SeaMonkey \\1"</span> =&gt; <span class="stringliteral">"#(SeaMonkey)/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01546"></a>01546                           <span class="stringliteral">"OmniWeb"</span> =&gt; <span class="stringliteral">"#OmniWeb#i"</span>,
<a name="l01547"></a>01547                           <span class="stringliteral">"Mozilla \\1"</span> =&gt; <span class="stringliteral">"#^Mozilla/5\.0.*rv:([a-zA-Z0-9\.]+).*#i"</span>,
<a name="l01548"></a>01548                           <span class="stringliteral">"Netscape Navigator \\1"</span> =&gt; <span class="stringliteral">"#^Mozilla/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01549"></a>01549                           <span class="stringliteral">"PHP"</span> =&gt; <span class="stringliteral">"/PHP/i"</span>,
<a name="l01550"></a>01550                           <span class="stringliteral">"SymbianOS \\1"</span> =&gt; <span class="stringliteral">"#symbianos/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01551"></a>01551                           <span class="stringliteral">"Avant Browser"</span> =&gt; <span class="stringliteral">"/avantbrowser\.com/i"</span>,
<a name="l01552"></a>01552                           <span class="stringliteral">"Camino \\1"</span> =&gt; <span class="stringliteral">"#(Camino|Chimera)[ /]([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01553"></a>01553                           <span class="stringliteral">"Anonymouse"</span> =&gt; <span class="stringliteral">"/anonymouse/i"</span>,
<a name="l01554"></a>01554                           <span class="stringliteral">"Danger HipTop"</span> =&gt; <span class="stringliteral">"/danger hiptop/i"</span>,
<a name="l01555"></a>01555                           <span class="stringliteral">"W3M \\1"</span> =&gt; <span class="stringliteral">"#w3m/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01556"></a>01556                           <span class="stringliteral">"Shiira \\1"</span> =&gt; <span class="stringliteral">"#Shiira[ /]([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01557"></a>01557                           <span class="stringliteral">"Dillo \\1"</span> =&gt; <span class="stringliteral">"#Dillo[ /]([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01558"></a>01558                           <span class="stringliteral">"Openwave UP.Browser \\1"</span> =&gt; <span class="stringliteral">"#UP.Browser/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01559"></a>01559                           <span class="stringliteral">"DoCoMo \\1"</span> =&gt; <span class="stringliteral">"#DoCoMo/(([a-zA-Z0-9\.]+)[/ ]([a-zA-Z0-9\.]+))#i"</span>,
<a name="l01560"></a>01560                           <span class="stringliteral">"Unbranded Firefox \\1"</span> =&gt; <span class="stringliteral">"#(bonecho)/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01561"></a>01561                           <span class="stringliteral">"Kazehakase \\1"</span> =&gt; <span class="stringliteral">"#Kazehakase/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01562"></a>01562                           <span class="stringliteral">"Minimo \\1"</span> =&gt; <span class="stringliteral">"#Minimo/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01563"></a>01563                           <span class="stringliteral">"MultiZilla \\1"</span> =&gt; <span class="stringliteral">"#MultiZilla/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01564"></a>01564                           <span class="stringliteral">"Sony PSP \\2"</span> =&gt; <span class="stringliteral">"/PSP \(PlayStation Portable\)\; ([a-zA-Z0-9\.]+)/i"</span>,
<a name="l01565"></a>01565                           <span class="stringliteral">"Galeon \\1"</span> =&gt; <span class="stringliteral">"#Galeon/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01566"></a>01566                           <span class="stringliteral">"iCab \\1"</span> =&gt; <span class="stringliteral">"#iCab/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01567"></a>01567                           <span class="stringliteral">"NetPositive \\1"</span> =&gt; <span class="stringliteral">"#NetPositive/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01568"></a>01568                           <span class="stringliteral">"NetNewsWire \\1"</span> =&gt; <span class="stringliteral">"#NetNewsWire/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01569"></a>01569                           <span class="stringliteral">"Opera Mini \\1"</span> =&gt; <span class="stringliteral">"#opera mini/([a-zA-Z0-9]+)#i"</span>,
<a name="l01570"></a>01570                           <span class="stringliteral">"WebPro \\2"</span> =&gt; <span class="stringliteral">"#WebPro(/([a-zA-Z0-9\.]+))?#i"</span>,
<a name="l01571"></a>01571                           <span class="stringliteral">"Netfront \\1"</span> =&gt; <span class="stringliteral">"#Netfront/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01572"></a>01572                           <span class="stringliteral">"Xiino \\1"</span> =&gt; <span class="stringliteral">"#Xiino/([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01573"></a>01573                           <span class="stringliteral">"Blackberry \\1"</span> =&gt; <span class="stringliteral">"#Blackberry([0-9]+)?#i"</span>,
<a name="l01574"></a>01574                           <span class="stringliteral">"Orange SPV \\1"</span> =&gt; <span class="stringliteral">"#SPV ([0-9a-zA-Z\.]+)#i"</span>,
<a name="l01575"></a>01575                           <span class="stringliteral">"LG \\1"</span> =&gt; <span class="stringliteral">"#LGE-([a-zA-Z0-9]+)#i"</span>,
<a name="l01576"></a>01576                           <span class="stringliteral">"Motorola \\1"</span> =&gt; <span class="stringliteral">"#MOT-([a-zA-Z0-9]+)#i"</span>,
<a name="l01577"></a>01577                           <span class="stringliteral">"Nokia \\1"</span> =&gt; <span class="stringliteral">"#Nokia ?([0-9]+)#i"</span>,
<a name="l01578"></a>01578                           <span class="stringliteral">"Nokia N-Gage"</span> =&gt; <span class="stringliteral">"#NokiaN-Gage#i"</span>,
<a name="l01579"></a>01579                           <span class="stringliteral">"Blazer \\1"</span> =&gt; <span class="stringliteral">"#Blazer[ /]?([a-zA-Z0-9\.]*)#i"</span>,
<a name="l01580"></a>01580                           <span class="stringliteral">"Siemens \\1"</span> =&gt; <span class="stringliteral">"#SIE-([a-zA-Z0-9]+)#i"</span>,
<a name="l01581"></a>01581                           <span class="stringliteral">"Samsung \\4"</span> =&gt; <span class="stringliteral">"#((SEC-)|(SAMSUNG-))((S.H-[a-zA-Z0-9]+)|([a-zA-Z0-9]+))#i"</span>,
<a name="l01582"></a>01582                           <span class="stringliteral">"SonyEricsson \\1"</span> =&gt; <span class="stringliteral">"#SonyEricsson ?([a-zA-Z0-9]+)#i"</span>,
<a name="l01583"></a>01583                           <span class="stringliteral">"J2ME/MIDP Browser"</span> =&gt; <span class="stringliteral">"#(j2me|midp)#i"</span>,
<a name="l01584"></a>01584                           <span class="stringliteral">"Neznámý"</span> =&gt; <span class="stringliteral">"/(.*)/"</span>);
<a name="l01585"></a>01585 
<a name="l01586"></a>01586     <span class="keywordflow">foreach</span>($BrowserList as $browser =&gt; $regexp)
<a name="l01587"></a>01587     {
<a name="l01588"></a>01588       <span class="keywordflow">if</span> (preg_match($regexp, $agent, $matches))
<a name="l01589"></a>01589       {
<a name="l01590"></a>01590         <span class="keywordflow">if</span> (!Empty($matches))
<a name="l01591"></a>01591         {
<a name="l01592"></a>01592           <span class="keywordflow">for</span> ($i = 0; $i &lt;= count($matches); $i++)
<a name="l01593"></a>01593           {
<a name="l01594"></a>01594             $browser = str_replace(<span class="stringliteral">"\\{$i}"</span>, $matches[$i], $browser);
<a name="l01595"></a>01595           }
<a name="l01596"></a>01596         }
<a name="l01597"></a>01597         <span class="keywordflow">break</span>;
<a name="l01598"></a>01598       }
<a name="l01599"></a>01599     }
<a name="l01600"></a>01600 
<a name="l01601"></a>01601     <span class="keywordflow">return</span> trim($browser);
<a name="l01602"></a>01602   }
<a name="l01603"></a>01603 
<a name="l01612"></a><a class="code" href="classFunkce.html#b252b11b424ac779dc83aa5576118d1d">01612</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#b252b11b424ac779dc83aa5576118d1d">DetekceLinuxu</a>()
<a name="l01613"></a>01613   {
<a name="l01614"></a>01614     $OSList = array(<span class="stringliteral">"Mandrake Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Mandrake))|((Mandrake).*(Linux))/i"</span>,
<a name="l01615"></a>01615                     <span class="stringliteral">"Mandriva Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Mandriva))|((Mandriva).*(Linux))/i"</span>,
<a name="l01616"></a>01616                     <span class="stringliteral">"SuSE Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(SuSE))|((SuSE).*(Linux))/i"</span>,
<a name="l01617"></a>01617                     <span class="stringliteral">"Novell Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Novell))|((Novell).*(Linux))/i"</span>,
<a name="l01618"></a>01618                     <span class="stringliteral">"Kubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Kubuntu))|((Kubuntu).*(Linux))/i"</span>,
<a name="l01619"></a>01619                     <span class="stringliteral">"Xubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Xubuntu))|((Xubuntu).*(Linux))/i"</span>,
<a name="l01620"></a>01620                     <span class="stringliteral">"Edubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Edubuntu))|((Edubuntu).*(Linux))/i"</span>,
<a name="l01621"></a>01621                     <span class="stringliteral">"Ubuntu Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Ubuntu))|((Ubuntu).*(Linux))/i"</span>,
<a name="l01622"></a>01622                     <span class="stringliteral">"Debian GNU/Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Debian))|((Debian).*(Linux))/i"</span>,
<a name="l01623"></a>01623                     <span class="stringliteral">"RedHat Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Red ?Hat))|((Red ?Hat).*(Linux))/i"</span>,
<a name="l01624"></a>01624                     <span class="stringliteral">"Gentoo Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Gentoo))|((Gentoo).*(Linux))/i"</span>,
<a name="l01625"></a>01625                     <span class="stringliteral">"Fedora Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Fedora))|((Fedora).*(Linux))/i"</span>,
<a name="l01626"></a>01626                     <span class="stringliteral">"MEPIS Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(MEPIS))|((MEPIS).*(Linux))/i"</span>,
<a name="l01627"></a>01627                     <span class="stringliteral">"Knoppix Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Knoppix))|((Knoppix).*(Linux))/i"</span>,
<a name="l01628"></a>01628                     <span class="stringliteral">"Slackware Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Slackware))|((Slackware).*(Linux))/i"</span>,
<a name="l01629"></a>01629                     <span class="stringliteral">"Xandros Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Xandros))|((Xandros).*(Linux))/i"</span>,
<a name="l01630"></a>01630                     <span class="stringliteral">"Kanotix Linux"</span> =&gt; <span class="stringliteral">"/((Linux).*(Kanotix))|((Kanotix).*(Linux))/i"</span>,
<a name="l01631"></a>01631                     <span class="stringliteral">"Linux"</span> =&gt; <span class="stringliteral">"/(Linux)|(X11)/i"</span>,
<a name="l01632"></a>01632                     <span class="stringliteral">"FreeBSD"</span> =&gt; <span class="stringliteral">"/Free/i"</span>,
<a name="l01633"></a>01633                     <span class="stringliteral">"OpenBSD"</span> =&gt; <span class="stringliteral">"/OpenBSD/i"</span>,
<a name="l01634"></a>01634                     <span class="stringliteral">"NetBSD"</span> =&gt; <span class="stringliteral">"/NetBSD/i"</span>,
<a name="l01635"></a>01635                     <span class="stringliteral">"SGI IRIX"</span> =&gt; <span class="stringliteral">"/IRIX/i"</span>,
<a name="l01636"></a>01636                     <span class="stringliteral">"Sun OS"</span> =&gt; <span class="stringliteral">"/SunOS/i"</span>,
<a name="l01637"></a>01637                     <span class="stringliteral">"QNX"</span> =&gt; <span class="stringliteral">"/QNX/i"</span>,
<a name="l01638"></a>01638                     <span class="stringliteral">"BeOS"</span> =&gt; <span class="stringliteral">"/BeOS/i"</span>,
<a name="l01639"></a>01639                     <span class="stringliteral">"Mac OS X Leopard"</span> =&gt; <span class="stringliteral">"/(Mac OS).*(Leopard)/i"</span>,
<a name="l01640"></a>01640                     <span class="stringliteral">"Mac OS X"</span> =&gt; <span class="stringliteral">"/(Mac OS X)/i"</span>,
<a name="l01641"></a>01641                     <span class="stringliteral">"Mac OS"</span> =&gt; <span class="stringliteral">"/(Mac_PowerPC)|(Macintosh)/i"</span>,
<a name="l01642"></a>01642                     <span class="stringliteral">"OS/2"</span> =&gt; <span class="stringliteral">"#OS/2#i"</span>,
<a name="l01643"></a>01643                     <span class="stringliteral">"Qtopia"</span> =&gt; <span class="stringliteral">"/QtEmbedded/i"</span>,
<a name="l01644"></a>01644                     <span class="stringliteral">""</span> =&gt; <span class="stringliteral">"/(.*)/"</span>);
<a name="l01645"></a>01645 
<a name="l01646"></a>01646     $agent = $_SERVER[<span class="stringliteral">"HTTP_USER_AGENT"</span>];
<a name="l01647"></a>01647     <span class="keywordflow">foreach</span>($OSList as $os =&gt; $regexp)
<a name="l01648"></a>01648     {
<a name="l01649"></a>01649       preg_match($regexp, $agent, $matches);
<a name="l01650"></a>01650       <span class="keywordflow">if</span> (!Empty($matches))
<a name="l01651"></a>01651       {
<a name="l01652"></a>01652         <span class="keywordflow">for</span> ($i = 0; $i &lt;= count($matches); $i++)
<a name="l01653"></a>01653         {
<a name="l01654"></a>01654           $os = str_replace(<span class="stringliteral">"\\{$i}"</span>, $matches[$i], $os);
<a name="l01655"></a>01655         }
<a name="l01656"></a>01656         <span class="keywordflow">break</span>;
<a name="l01657"></a>01657       }
<a name="l01658"></a>01658     }
<a name="l01659"></a>01659 
<a name="l01660"></a>01660     <span class="keywordflow">return</span> (!Empty($os) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l01661"></a>01661   }
<a name="l01662"></a>01662 
<a name="l01671"></a><a class="code" href="classFunkce.html#f90d91f9d66a9c5115645c8b74cda579">01671</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#f90d91f9d66a9c5115645c8b74cda579">DetekceOpery</a>()
<a name="l01672"></a>01672   {
<a name="l01673"></a>01673     $OSList = array(<span class="stringliteral">"Opera \\1"</span> =&gt; <span class="stringliteral">"#Opera[ /]([a-zA-Z0-9\.]+)#i"</span>,
<a name="l01674"></a>01674                     <span class="stringliteral">""</span> =&gt; <span class="stringliteral">"/(.*)/"</span>);
<a name="l01675"></a>01675 
<a name="l01676"></a>01676     $agent = $_SERVER[<span class="stringliteral">"HTTP_USER_AGENT"</span>];
<a name="l01677"></a>01677     <span class="keywordflow">foreach</span>($OSList as $os =&gt; $regexp)
<a name="l01678"></a>01678     {
<a name="l01679"></a>01679       preg_match($regexp, $agent, $matches);
<a name="l01680"></a>01680       <span class="keywordflow">if</span> (!Empty($matches))
<a name="l01681"></a>01681       {
<a name="l01682"></a>01682         <span class="keywordflow">for</span> ($i = 0; $i &lt;= count($matches); $i++)
<a name="l01683"></a>01683         {
<a name="l01684"></a>01684           $os = str_replace(<span class="stringliteral">"\\{$i}"</span>, $matches[$i], $os);
<a name="l01685"></a>01685         }
<a name="l01686"></a>01686         <span class="keywordflow">break</span>;
<a name="l01687"></a>01687       }
<a name="l01688"></a>01688     }
<a name="l01689"></a>01689 
<a name="l01690"></a>01690     <span class="keywordflow">return</span> (!Empty($os) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l01691"></a>01691   }
<a name="l01692"></a>01692 
<a name="l01698"></a><a class="code" href="classFunkce.html#2d3e5927abec4a3d3c067089e4898ac2">01698</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#2d3e5927abec4a3d3c067089e4898ac2">Instalace</a>()  <span class="comment">//instalace databaze</span>
<a name="l01699"></a>01699   {
<a name="l01700"></a>01700     <span class="comment">//</span>
<a name="l01701"></a>01701   }
<a name="l01702"></a>01702 
<a name="l01712"></a><a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">01712</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#9ef4e94a7f9346ad4614d6023da845d1">Velikost</a>($size)  <span class="comment">//vypocet velikosti souboru</span>
<a name="l01713"></a>01713   {
<a name="l01714"></a>01714     $symbol = array(<span class="stringliteral">"B"</span>, <span class="stringliteral">"KB"</span>, <span class="stringliteral">"MB"</span>, <span class="stringliteral">"GB"</span>, <span class="stringliteral">"TB"</span>, <span class="stringliteral">"PB"</span>, <span class="stringliteral">"EB"</span>, <span class="stringliteral">"ZB"</span>, <span class="stringliteral">"YB"</span>);
<a name="l01715"></a>01715 
<a name="l01716"></a>01716     $exp = 0;
<a name="l01717"></a>01717     $converted_value = 0;
<a name="l01718"></a>01718     <span class="keywordflow">if</span> ($size &gt; 0)
<a name="l01719"></a>01719     {
<a name="l01720"></a>01720       $exp = floor(log($size) / log(1024));
<a name="l01721"></a>01721       $converted_value = ($size / pow(1024, floor($exp)));
<a name="l01722"></a>01722     }
<a name="l01723"></a>01723 
<a name="l01724"></a>01724     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = sprintf(<span class="stringliteral">"%.2f {$symbol[$exp]}"</span>, $converted_value);
<a name="l01725"></a>01725 
<a name="l01726"></a>01726     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01727"></a>01727   }
<a name="l01728"></a>01728 
<a name="l01736"></a><a class="code" href="classFunkce.html#82deeeea471ae6e09ed4ada016d301ea">01736</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#82deeeea471ae6e09ed4ada016d301ea">PrepisAdresy</a>($adresa)
<a name="l01737"></a>01737   {
<a name="l01738"></a>01738     $search = array_keys($this-&gt;var-&gt;prepis_pravidla);
<a name="l01739"></a>01739     $replace = array_values($this-&gt;var-&gt;prepis_pravidla);
<a name="l01740"></a>01740 
<a name="l01741"></a>01741     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = str_replace($search, $replace, $adresa);
<a name="l01742"></a>01742 
<a name="l01743"></a>01743     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01744"></a>01744   }
<a name="l01745"></a>01745 
<a name="l01753"></a><a class="code" href="classFunkce.html#eb349cbd5a92ac0dc57f6e6f7503b8b1">01753</a>   <span class="keyword">public</span> function <a class="code" href="classFunkce.html#eb349cbd5a92ac0dc57f6e6f7503b8b1">ZpetnyPrepisAdresy</a>($adresa)
<a name="l01754"></a>01754   {
<a name="l01755"></a>01755     $search = array_values($this-&gt;var-&gt;prepis_pravidla);
<a name="l01756"></a>01756     $replace = array_keys($this-&gt;var-&gt;prepis_pravidla);
<a name="l01757"></a>01757 
<a name="l01758"></a>01758     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = str_replace($search, $replace, $adresa);
<a name="l01759"></a>01759 
<a name="l01760"></a>01760     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l01761"></a>01761   }
<a name="l01762"></a>01762 
<a name="l01768"></a><a class="code" href="classFunkce.html#b7e5f3ce7da51dbbd4dfad696f5878f1">01768</a>   <span class="keyword">private</span> function <a class="code" href="classFunkce.html#b7e5f3ce7da51dbbd4dfad696f5878f1">GenerovaniErrorPage</a>()
<a name="l01769"></a>01769   {
<a name="l01770"></a>01770     <span class="keywordflow">if</span> (file_exists($this-&gt;errorpage) &amp;&amp;  <span class="comment">//kdyz exstuje slozka</span>
<a name="l01771"></a>01771         !file_exists(<span class="stringliteral">"{$this-&gt;errorpage}/{$this-&gt;errorblok}"</span>) &amp;&amp;  <span class="comment">//pokud neexistuje blokovac</span>
<a name="l01772"></a>01772         $_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu) <span class="comment">//pokud je v adminu</span>
<a name="l01773"></a>01773     {
<a name="l01774"></a>01774       $error = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"text_error_page"</span>]);
<a name="l01775"></a>01775 
<a name="l01776"></a>01776       $absolutni_url = $this-&gt;<a class="code" href="classFunkce.html#b11e85edc953ceb83955f3b43347d4f5">AbsoluteUrl</a>();
<a name="l01777"></a>01777       $u = fopen(<span class="stringliteral">"{$this-&gt;errorpage}/error_sablona.html"</span>, <span class="stringliteral">"r"</span>);
<a name="l01778"></a>01778       $vystup = fread($u, filesize(<span class="stringliteral">"{$this-&gt;errorpage}/error_sablona.html"</span>));
<a name="l01779"></a>01779       fclose($u);
<a name="l01780"></a>01780 
<a name="l01781"></a>01781       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($error); $i++)
<a name="l01782"></a>01782       {
<a name="l01783"></a>01783         $pole = $error[$i];
<a name="l01784"></a>01784         $pole[<span class="stringliteral">"absolutni_url"</span>] = $absolutni_url;  <span class="comment">//prida absolutni cestu</span>
<a name="l01785"></a>01785         $pole[<span class="stringliteral">"nazevwebu"</span>] = $this-&gt;var-&gt;nazevwebu; <span class="comment">//prida nazev webu</span>
<a name="l01786"></a>01786         $klice = array_keys($pole); <span class="comment">//nezme klice</span>
<a name="l01787"></a>01787         $page = $vystup;  <span class="comment">//zkopiruje obsah sablony</span>
<a name="l01788"></a>01788 
<a name="l01789"></a>01789         <span class="keywordflow">for</span> ($j = 0; $j &lt; count($pole); $j++) <span class="comment">//vepsani do sablony</span>
<a name="l01790"></a>01790         {
<a name="l01791"></a>01791           $page = str_replace(<span class="stringliteral">"%%{$klice[$j]}%%"</span>, $pole[$klice[$j]], $page);
<a name="l01792"></a>01792         }
<a name="l01793"></a>01793 
<a name="l01794"></a>01794         $u = fopen(<span class="stringliteral">"{$this-&gt;errorpage}/{$pole["</span>kod<span class="stringliteral">"]}.html"</span>, <span class="stringliteral">"w"</span>);  <span class="comment">//zapsani do souboru</span>
<a name="l01795"></a>01795         fwrite($u, $page);
<a name="l01796"></a>01796         fclose($u);
<a name="l01797"></a>01797       }
<a name="l01798"></a>01798 
<a name="l01799"></a>01799       $u = fopen(<span class="stringliteral">"{$this-&gt;errorpage}/{$this-&gt;errorblok}"</span>, <span class="stringliteral">"w"</span>);  <span class="comment">//vytvoreni souboru pro blokaci</span>
<a name="l01800"></a>01800       fwrite($u, date(<span class="stringliteral">"Y-m-d H:i:s"</span>)); <span class="comment">//vlozi datum vyvoreni</span>
<a name="l01801"></a>01801       fclose($u);
<a name="l01802"></a>01802     }
<a name="l01803"></a>01803   }
<a name="l01804"></a>01804 
<a name="l01805"></a>01805 }
<a name="l01806"></a>01806 ?&gt;
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generováno Tue Aug 4 13:38:10 2009 pro projekt Novy vychozi PHP layout programem&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>

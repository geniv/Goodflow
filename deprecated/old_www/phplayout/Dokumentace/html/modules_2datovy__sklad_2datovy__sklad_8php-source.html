<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Novy vychozi PHP layout: Zdrojový soubor /var/www/phplayout/modules/datovy_sklad/datovy_sklad.php</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generováno programem Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Hlavní&nbsp;stránka</span></a></li>
      <li><a href="annotated.html"><span>Třídy</span></a></li>
      <li class="current"><a href="files.html"><span>Soubory</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>Seznam&nbsp;souborů</span></a></li>
      <li><a href="globals.html"><span>Symboly&nbsp;v&nbsp;souborech</span></a></li>
    </ul>
  </div>
<h1>/var/www/phplayout/modules/datovy_sklad/datovy_sklad.php</h1><a href="modules_2datovy__sklad_2datovy__sklad_8php.html">Zobrazit dokumentaci tohoto souboru.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00013"></a><a class="code" href="classDataStorage.html">00013</a> <span class="keyword">class </span><a class="code" href="classDataStorage.html">DataStorage</a> <span class="keyword">extends</span> <a class="code" href="classDefaultModule.html">DefaultModule</a>
<a name="l00014"></a>00014 {
<a name="l00015"></a><a class="code" href="classDataStorage.html#a6c34eb31f89b074e44568639651892d">00015</a>   <span class="keyword">private</span> <a class="code" href="classDataStorage.html#a6c34eb31f89b074e44568639651892d">$var</a>, <a class="code" href="classDataStorage.html#2afa514b25a335be9a5e874cfc5a454d">$unikatni</a>, <a class="code" href="classDataStorage.html#856b1e9380e6495ea6f74a1bb1f0284a">$dirpath</a>;
<a name="l00016"></a><a class="code" href="classDataStorage.html#d875c55f87919f674e9652e032665b59">00016</a>   <span class="keyword">private</span> <a class="code" href="classDataStorage.html#d875c55f87919f674e9652e032665b59">$idmodul</a> = <span class="stringliteral">"datstor"</span>;
<a name="l00017"></a><a class="code" href="classDataStorage.html#4fb2dbf40c0f0b69b4ffefaee6b53f49">00017</a>   <span class="keyword">private</span> <a class="code" href="classDataStorage.html#4fb2dbf40c0f0b69b4ffefaee6b53f49">$pomer</a> = 10; <span class="comment">//% pomer fotek typu, jpg, gif, png</span>
<a name="l00018"></a>00018 
<a name="l00019"></a><a class="code" href="classDataStorage.html#cc5cc8bbf9b5b5b751ae97bb6fd09db2">00019</a>   <span class="keyword">private</span> <a class="code" href="classDataStorage.html#cc5cc8bbf9b5b5b751ae97bb6fd09db2">$pathdata</a> = <span class="stringliteral">"soubory"</span>;
<a name="l00020"></a>00020 
<a name="l00028"></a><a class="code" href="classDataStorage.html#6ec88232841492c7093efd1796eb6548">00028</a>   <span class="keyword">public</span> function <a class="code" href="classDataStorage.html#6ec88232841492c7093efd1796eb6548">__construct</a>(&amp;<a class="code" href="classDataStorage.html#a6c34eb31f89b074e44568639651892d">$var</a>, $index) <span class="comment">//konstruktor</span>
<a name="l00029"></a>00029   {
<a name="l00030"></a>00030     $this-&gt;var = <a class="code" href="classDataStorage.html#a6c34eb31f89b074e44568639651892d">$var</a>;
<a name="l00031"></a>00031     $this-&gt;dirpath = dirname($this-&gt;var-&gt;moduly[$index][<span class="stringliteral">"include"</span>]);
<a name="l00032"></a>00032 
<a name="l00033"></a>00033     <span class="comment">//includovani unikatniho obsahu</span>
<a name="l00034"></a>00034     $this-&gt;unikatni = $this-&gt;<a class="code" href="classDefaultModule.html#f9bc13977b7099f00c4a74192ce85dce">NactiObsahSouboru</a>(<span class="stringliteral">"{$this-&gt;dirpath}/.unikatni_obsah.php"</span>);
<a name="l00035"></a>00035 
<a name="l00036"></a>00036     <span class="comment">//unikatni nastaveni promenych</span>
<a name="l00037"></a>00037     $this-&gt;pomer = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_pomer"</span>]);
<a name="l00038"></a>00038     $this-&gt;pathdata = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"set_pathdata"</span>]);
<a name="l00039"></a>00039 
<a name="l00040"></a>00040     $this-&gt;pathdata = <span class="stringliteral">"{$this-&gt;dirpath}/{$this-&gt;pathdata}"</span>;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042     $this-&gt;<a class="code" href="classDefaultModule.html#de138416b3a548d72b50432499895bb7">NastavitAdresuMenu</a>($this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_menu"</span>], $this-&gt;idmodul));
<a name="l00043"></a>00043   }
<a name="l00044"></a>00044 
<a name="l00051"></a><a class="code" href="classDataStorage.html#0f5a30a26bd755d2c0eeadadce486bba">00051</a>   <span class="keyword">public</span> function <a class="code" href="classDataStorage.html#0f5a30a26bd755d2c0eeadadce486bba">AdminObsah</a>()
<a name="l00052"></a>00052   {
<a name="l00053"></a>00053     <span class="keywordflow">if</span> ($_GET[$this-&gt;var-&gt;get_kam] == $this-&gt;var-&gt;adresaadminu &amp;&amp;
<a name="l00054"></a>00054         $this-&gt;var-&gt;aktivniadmin)
<a name="l00055"></a>00055     {
<a name="l00056"></a>00056       $modul = explode(<span class="stringliteral">"_"</span>, $_GET[$this-&gt;var-&gt;get_idmodul]);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058       <span class="keywordflow">switch</span> ($modul[0])
<a name="l00059"></a>00059       {
<a name="l00060"></a>00060         <span class="keywordflow">case</span> $this-&gt;idmodul:  <span class="comment">//id modul</span>
<a name="l00061"></a>00061           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDataStorage.html#75f57ee4cd261234833befa80fd1d6e2">AdministraceSkladu</a>();
<a name="l00062"></a>00062         <span class="keywordflow">break</span>;
<a name="l00063"></a>00063       }
<a name="l00064"></a>00064     }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00067"></a>00067   }
<a name="l00068"></a>00068 
<a name="l00075"></a><a class="code" href="classDataStorage.html#4769db98682b2fd5320710edc5f47637">00075</a>   <span class="keyword">private</span> function <a class="code" href="classDataStorage.html#4769db98682b2fd5320710edc5f47637">VytvorJmenoObrazku</a>()
<a name="l00076"></a>00076   {
<a name="l00077"></a>00077     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = date(<span class="stringliteral">"d-m-Y-H-i-s"</span>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00080"></a>00080   }
<a name="l00081"></a>00081 
<a name="l00088"></a><a class="code" href="classDataStorage.html#75f57ee4cd261234833befa80fd1d6e2">00088</a>   <span class="keyword">private</span> function <a class="code" href="classDataStorage.html#75f57ee4cd261234833befa80fd1d6e2">AdministraceSkladu</a>()
<a name="l00089"></a>00089   {
<a name="l00090"></a>00090     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_obsah"</span>],
<a name="l00091"></a>00091                                         <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=adddir&amp;amp;file={$this-&gt;pathdata}"</span>,
<a name="l00092"></a>00092                                         <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addfile&amp;amp;file={$this-&gt;pathdata}"</span>,
<a name="l00093"></a>00093                                         $this-&gt;<a class="code" href="classDataStorage.html#a8600ce91ec164a2bbd02fc51663b7b2">RekurzivniVypis</a>($this-&gt;pathdata));
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     <span class="keywordflow">if</span> (!file_exists($this-&gt;pathdata))  <span class="comment">//vytvori si vlastni soubor</span>
<a name="l00096"></a>00096     {
<a name="l00097"></a>00097       mkdir($this-&gt;pathdata, 0777);
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     $co = $_GET[<span class="stringliteral">"co"</span>];
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     <span class="keywordflow">if</span> (!Empty($co))
<a name="l00103"></a>00103     {
<a name="l00104"></a>00104       <span class="keywordflow">switch</span> ($co)
<a name="l00105"></a>00105       {
<a name="l00106"></a>00106         <span class="keywordflow">case</span> <span class="stringliteral">"adddir"</span>: <span class="comment">//pridavani slozky</span>
<a name="l00107"></a>00107           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_add_dir"</span>]);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109           $slozka = stripslashes(htmlspecialchars($this-&gt;<a class="code" href="classDataStorage.html#560d645cf5528fe2d8dd54ece6d6d649">OsetreniNazvu</a>($_POST[<span class="stringliteral">"slozka"</span>]), ENT_QUOTES));
<a name="l00110"></a>00110 
<a name="l00111"></a>00111           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l00112"></a>00112               !Empty($_GET[<span class="stringliteral">"file"</span>]) &amp;&amp;
<a name="l00113"></a>00113               !Empty($slozka))
<a name="l00114"></a>00114           {
<a name="l00115"></a>00115             <span class="keywordflow">if</span> (mkdir(<span class="stringliteral">"{$_GET["</span>file<span class="stringliteral">"]}/{$slozka}"</span>, 0777))
<a name="l00116"></a>00116             {
<a name="l00117"></a>00117               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_add_dir_hlaska"</span>], $slozka);
<a name="l00118"></a>00118             }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120             $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00121"></a>00121           }
<a name="l00122"></a>00122         <span class="keywordflow">break</span>;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         <span class="keywordflow">case</span> <span class="stringliteral">"editdir"</span>: <span class="comment">//uprava slozky</span>
<a name="l00125"></a>00125           $base = basename($_GET[<span class="stringliteral">"file"</span>]);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_edit_dir"</span>], $base);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129           $nazev = stripslashes(htmlspecialchars($this-&gt;<a class="code" href="classDataStorage.html#560d645cf5528fe2d8dd54ece6d6d649">OsetreniNazvu</a>($_POST[<span class="stringliteral">"nazev"</span>]), ENT_QUOTES));
<a name="l00130"></a>00130 
<a name="l00131"></a>00131           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l00132"></a>00132               !Empty($_GET[<span class="stringliteral">"file"</span>]) &amp;&amp;
<a name="l00133"></a>00133               !Empty($nazev))
<a name="l00134"></a>00134           {
<a name="l00135"></a>00135             $dir = dirname($_GET[<span class="stringliteral">"file"</span>]);
<a name="l00136"></a>00136             <span class="keywordflow">if</span> (rename($_GET[<span class="stringliteral">"file"</span>], <span class="stringliteral">"{$dir}/{$nazev}"</span>))
<a name="l00137"></a>00137             {
<a name="l00138"></a>00138               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_edit_dir_hlaska"</span>], $nazev);
<a name="l00139"></a>00139             }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141             $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00142"></a>00142           }
<a name="l00143"></a>00143         <span class="keywordflow">break</span>;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         <span class="keywordflow">case</span> <span class="stringliteral">"deldir"</span>: <span class="comment">//smazat slozku</span>
<a name="l00146"></a>00146           <span class="keywordflow">if</span> (!Empty($_GET[<span class="stringliteral">"file"</span>]))
<a name="l00147"></a>00147           {
<a name="l00148"></a>00148             $this-&gt;<a class="code" href="classDataStorage.html#ea5fda5a6fd17c02666dc09fdc109ca9">DelDirFile</a>($_GET[<span class="stringliteral">"file"</span>]);
<a name="l00149"></a>00149             <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_del_dir_hlaska"</span>], $_GET[<span class="stringliteral">"file"</span>]);
<a name="l00150"></a>00150           }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152           $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00153"></a>00153         <span class="keywordflow">break</span>;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         <span class="keywordflow">case</span> <span class="stringliteral">"addfile"</span>: <span class="comment">//pridavani soubor</span>
<a name="l00156"></a>00156           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_add_file"</span>]);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l00159"></a>00159               !Empty($_GET[<span class="stringliteral">"file"</span>]) &amp;&amp;
<a name="l00160"></a>00160               !Empty($_FILES[<span class="stringliteral">"soubor"</span>][<span class="stringliteral">"tmp_name"</span>]))
<a name="l00161"></a>00161           {
<a name="l00162"></a>00162             $koncovka = explode(<span class="stringliteral">"."</span>, $_FILES[<span class="stringliteral">"soubor"</span>][<span class="stringliteral">"name"</span>]);
<a name="l00163"></a>00163             $nazev = <span class="stringliteral">"{$this-&gt;VytvorJmenoObrazku()}.{$koncovka[count($koncovka) - 1]}"</span>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165             $cil = <span class="stringliteral">"{$_GET["</span>file<span class="stringliteral">"]}/{$nazev}"</span>;
<a name="l00166"></a>00166             <span class="keywordflow">if</span> (move_uploaded_file($_FILES[<span class="stringliteral">"soubor"</span>][<span class="stringliteral">"tmp_name"</span>], $cil))
<a name="l00167"></a>00167             {
<a name="l00168"></a>00168               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_add_file_hlaska"</span>], $nazev);
<a name="l00169"></a>00169             }
<a name="l00170"></a>00170               <span class="keywordflow">else</span>
<a name="l00171"></a>00171             {
<a name="l00172"></a>00172               $this-&gt;var-&gt;main[0]-&gt;ErrorMsg(<span class="stringliteral">"vyskytla se chyba při uploadu"</span>);
<a name="l00173"></a>00173             }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175             $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00176"></a>00176           }
<a name="l00177"></a>00177         <span class="keywordflow">break</span>;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="keywordflow">case</span> <span class="stringliteral">"editfile"</span>: <span class="comment">//uprava slozky</span>
<a name="l00180"></a>00180           $base = basename($_GET[<span class="stringliteral">"file"</span>]);
<a name="l00181"></a>00181 
<a name="l00182"></a>00182           <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_edit_file"</span>], $base);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184           <span class="keywordflow">if</span> (!Empty($_POST[<span class="stringliteral">"tlacitko"</span>]) &amp;&amp;
<a name="l00185"></a>00185               !Empty($_GET[<span class="stringliteral">"file"</span>]) &amp;&amp;
<a name="l00186"></a>00186               !Empty($_FILES[<span class="stringliteral">"soubor"</span>][<span class="stringliteral">"tmp_name"</span>]))
<a name="l00187"></a>00187           {
<a name="l00188"></a>00188             $cil = <span class="stringliteral">"{$_GET["</span>file<span class="stringliteral">"]}"</span>;
<a name="l00189"></a>00189             <span class="keywordflow">if</span> (move_uploaded_file($_FILES[<span class="stringliteral">"soubor"</span>][<span class="stringliteral">"tmp_name"</span>], $cil))
<a name="l00190"></a>00190             {
<a name="l00191"></a>00191               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_edit_file_hlaska"</span>], $base);
<a name="l00192"></a>00192             }
<a name="l00193"></a>00193               <span class="keywordflow">else</span>
<a name="l00194"></a>00194             {
<a name="l00195"></a>00195               $this-&gt;var-&gt;main[0]-&gt;ErrorMsg(<span class="stringliteral">"vyskytla se chyba při uploadu"</span>);
<a name="l00196"></a>00196             }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198             $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00199"></a>00199           }
<a name="l00200"></a>00200         <span class="keywordflow">break</span>;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202         <span class="keywordflow">case</span> <span class="stringliteral">"delfile"</span>: <span class="comment">//smazat soubor</span>
<a name="l00203"></a>00203           <span class="keywordflow">if</span> (!Empty($_GET[<span class="stringliteral">"file"</span>]))
<a name="l00204"></a>00204           {
<a name="l00205"></a>00205             <span class="keywordflow">if</span> (unlink($_GET[<span class="stringliteral">"file"</span>]))
<a name="l00206"></a>00206             {
<a name="l00207"></a>00207               <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_del_file_hlaska"</span>], $_GET[<span class="stringliteral">"file"</span>]);
<a name="l00208"></a>00208             }
<a name="l00209"></a>00209           }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211           $this-&gt;var-&gt;main[0]-&gt;AutoClick(1, <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}"</span>);  <span class="comment">//auto kliknuti</span>
<a name="l00212"></a>00212         <span class="keywordflow">break</span>;
<a name="l00213"></a>00213       }
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00217"></a>00217   }
<a name="l00218"></a>00218 
<a name="l00225"></a><a class="code" href="classDataStorage.html#ea5fda5a6fd17c02666dc09fdc109ca9">00225</a>   <span class="keyword">private</span> function <a class="code" href="classDataStorage.html#ea5fda5a6fd17c02666dc09fdc109ca9">DelDirFile</a>($jmeno)
<a name="l00226"></a>00226   {
<a name="l00227"></a>00227     $handle = opendir($jmeno);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="keywordflow">while</span>($soub = readdir($handle))
<a name="l00230"></a>00230     {
<a name="l00231"></a>00231       <span class="keywordflow">if</span> ($soub != <span class="stringliteral">"."</span> &amp;&amp; $soub != <span class="stringliteral">".."</span>)
<a name="l00232"></a>00232       {
<a name="l00233"></a>00233         <span class="keywordflow">if</span> (!(filetype(<span class="stringliteral">"{$jmeno}/{$soub}"</span>) == <span class="stringliteral">"file"</span> ? @unlink(<span class="stringliteral">"{$jmeno}/{$soub}"</span>) : @rmdir(<span class="stringliteral">"{$jmeno}/{$soub}"</span>)))
<a name="l00234"></a>00234         {
<a name="l00235"></a>00235           $this-&gt;<a class="code" href="classDataStorage.html#ea5fda5a6fd17c02666dc09fdc109ca9">DelDirFile</a>(<span class="stringliteral">"{$jmeno}/{$soub}"</span>);  <span class="comment">//rekurze</span>
<a name="l00236"></a>00236         }
<a name="l00237"></a>00237       }
<a name="l00238"></a>00238     }
<a name="l00239"></a>00239     closedir($handle);
<a name="l00240"></a>00240   }
<a name="l00241"></a>00241 
<a name="l00249"></a><a class="code" href="classDataStorage.html#560d645cf5528fe2d8dd54ece6d6d649">00249</a>   <span class="keyword">private</span> function <a class="code" href="classDataStorage.html#560d645cf5528fe2d8dd54ece6d6d649">OsetreniNazvu</a>($text)  <span class="comment">//prevede nebezpecne znaky na bezpecne</span>
<a name="l00250"></a>00250   {
<a name="l00251"></a>00251     $prevod = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_prepis"</span>]);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     <span class="keywordflow">return</span> strtr($text, $prevod);  <span class="comment">//prevede text dle prevadecoho pole</span>
<a name="l00254"></a>00254   }
<a name="l00255"></a>00255 
<a name="l00263"></a><a class="code" href="classDataStorage.html#a8600ce91ec164a2bbd02fc51663b7b2">00263</a>   <span class="keyword">private</span> function <a class="code" href="classDataStorage.html#a8600ce91ec164a2bbd02fc51663b7b2">RekurzivniVypis</a>($cesta)
<a name="l00264"></a>00264   {
<a name="l00265"></a>00265     $handle = opendir($cesta);
<a name="l00266"></a>00266     $i = $j = 0;
<a name="l00267"></a>00267     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> = <span class="stringliteral">""</span>;
<a name="l00268"></a>00268     <span class="keywordflow">while</span>($soub = readdir($handle))
<a name="l00269"></a>00269     {
<a name="l00270"></a>00270       <span class="keywordflow">if</span> ($soub != <span class="stringliteral">"."</span> &amp;&amp; $soub != <span class="stringliteral">".."</span>)
<a name="l00271"></a>00271       {
<a name="l00272"></a>00272         $pocet = count(explode(<span class="stringliteral">"/"</span>, <span class="stringliteral">"{$cesta}/{$soub}"</span>)) - 4;
<a name="l00273"></a>00273         $odsazeni = str_repeat(<span class="stringliteral">"----"</span>, $pocet);
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <span class="keywordflow">switch</span> (filetype(<span class="stringliteral">"{$cesta}/{$soub}"</span>))
<a name="l00276"></a>00276         {
<a name="l00277"></a>00277           <span class="keywordflow">case</span> <span class="stringliteral">"dir"</span>:
<a name="l00278"></a>00278             $rek = $this-&gt;<a class="code" href="classDataStorage.html#a8600ce91ec164a2bbd02fc51663b7b2">RekurzivniVypis</a>(<span class="stringliteral">"{$cesta}/{$soub}"</span>);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280             <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_obsah_dir"</span>],
<a name="l00281"></a>00281                                                 $odsazeni,
<a name="l00282"></a>00282                                                 $soub,
<a name="l00283"></a>00283                                                 $pocet,
<a name="l00284"></a>00284                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=addfile&amp;amp;file={$cesta}/{$soub}"</span>,
<a name="l00285"></a>00285                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=adddir&amp;amp;file={$cesta}/{$soub}"</span>,
<a name="l00286"></a>00286                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=editdir&amp;amp;file={$cesta}/{$soub}"</span>,
<a name="l00287"></a>00287                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=deldir&amp;amp;file={$cesta}"</span>,
<a name="l00288"></a>00288                                                 $rek);
<a name="l00289"></a>00289             $i++;
<a name="l00290"></a>00290           <span class="keywordflow">break</span>;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292           <span class="keywordflow">case</span> <span class="stringliteral">"file"</span>:
<a name="l00293"></a>00293             $a = explode(<span class="stringliteral">"."</span>, basename(<span class="stringliteral">"{$cesta}/{$soub}"</span>));
<a name="l00294"></a>00294             $suffix = strtolower($a[1]);
<a name="l00295"></a>00295 
<a name="l00296"></a>00296             <span class="keywordflow">if</span> ($suffix == <span class="stringliteral">"jpg"</span> ||
<a name="l00297"></a>00297                 $suffix == <span class="stringliteral">"png"</span> ||
<a name="l00298"></a>00298                 $suffix == <span class="stringliteral">"gif"</span>)
<a name="l00299"></a>00299             {
<a name="l00300"></a>00300               list($w, $h) = getimagesize(<span class="stringliteral">"{$cesta}/{$soub}"</span>);
<a name="l00301"></a>00301               $new_w = ($w / 100) * $this-&gt;pomer;
<a name="l00302"></a>00302               $new_h = ($h / 100) * $this-&gt;pomer;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304               $obr = $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_obsah_obr"</span>],
<a name="l00305"></a>00305                                               <span class="stringliteral">"{$cesta}/{$soub}"</span>,
<a name="l00306"></a>00306                                               $new_w,
<a name="l00307"></a>00307                                               $new_h);
<a name="l00308"></a>00308             }
<a name="l00309"></a>00309               <span class="keywordflow">else</span>
<a name="l00310"></a>00310             {
<a name="l00311"></a>00311               $obr = <span class="stringliteral">""</span>;
<a name="l00312"></a>00312             }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314             $velikost = $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"Funkce"</span>, <span class="stringliteral">"Velikost"</span>, filesize(<span class="stringliteral">"{$cesta}/{$soub}"</span>));
<a name="l00315"></a>00315             $datum = date(<span class="stringliteral">"d.m.Y / H:i:s"</span>, filemtime(<span class="stringliteral">"{$cesta}/{$soub}"</span>));
<a name="l00316"></a>00316 
<a name="l00317"></a>00317             <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_obsah_file"</span>],
<a name="l00318"></a>00318                                                 $odsazeni,
<a name="l00319"></a>00319                                                 $soub,
<a name="l00320"></a>00320                                                 $velikost,
<a name="l00321"></a>00321                                                 $datum,
<a name="l00322"></a>00322                                                 $this-&gt;var-&gt;main[0]-&gt;NactiFunkci(<span class="stringliteral">"Funkce"</span>, <span class="stringliteral">"AbsoluteUrl"</span>),
<a name="l00323"></a>00323                                                 <span class="stringliteral">"{$cesta}/{$soub}"</span>,
<a name="l00324"></a>00324                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=editfile&amp;amp;file={$cesta}/{$soub}"</span>,
<a name="l00325"></a>00325                                                 <span class="stringliteral">"?{$this-&gt;var-&gt;get_kam}={$this-&gt;var-&gt;adresaadminu}&amp;amp;{$this-&gt;var-&gt;get_idmodul}={$this-&gt;idmodul}&amp;amp;co=delfile&amp;amp;file={$cesta}/{$soub}"</span>,
<a name="l00326"></a>00326                                                 $obr);
<a name="l00327"></a>00327             $j++;
<a name="l00328"></a>00328           <span class="keywordflow">break</span>;
<a name="l00329"></a>00329         }
<a name="l00330"></a>00330       }
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332     closedir($handle);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a> .= $this-&gt;<a class="code" href="classDefaultModule.html#f43261ee577b5bedbdaff44d21c64d38">NactiUnikatniObsah</a>($this-&gt;unikatni[<span class="stringliteral">"admin_vypis_obsah_sum"</span>],
<a name="l00335"></a>00335                                         $odsazeni,
<a name="l00336"></a>00336                                         $i,
<a name="l00337"></a>00337                                         $j);
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     <span class="keywordflow">return</span> <a class="code" href="_8unikatni__fukce_8php.html#e241cf0159803673d118f68d99e6342f">$result</a>;
<a name="l00340"></a>00340   }
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 ?&gt;
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generováno Tue Aug 4 13:38:10 2009 pro projekt Novy vychozi PHP layout programem&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
